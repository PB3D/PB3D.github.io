<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.16.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PB3D: grid_ops Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PB3D<span id="projectnumber">&#160;[2.47]</span>
   </div>
   <div id="projectbrief">Ideal linear high-n MHD stability in 3-D</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.16.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">grid_ops Module Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Operations that have to do with the grids and different coordinate systems.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a7dd21871a4e65190fe6235eb2af4b6c2" id="r_a7dd21871a4e65190fe6235eb2af4b6c2"><td class="memItemLeft">integer function, public&#160;</td><td class="memItemRight"><a class="el" href="#a7dd21871a4e65190fe6235eb2af4b6c2">calc_norm_range</a> (style, in_limits, eq_limits, x_limits, sol_limits, r_f_eq, r_f_x, r_f_sol, jq)</td></tr>
<tr class="memdesc:a7dd21871a4e65190fe6235eb2af4b6c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates normal range for the input grid, the equilibrium grid and/or the solution grid.  <br /></td></tr>
<tr class="memitem:af63366847d1caa64a7d329672292fd34" id="r_af63366847d1caa64a7d329672292fd34"><td class="memItemLeft">integer function, public&#160;</td><td class="memItemRight"><a class="el" href="#af63366847d1caa64a7d329672292fd34">setup_grid_eq</a> (grid_eq, eq_limits)</td></tr>
<tr class="memdesc:af63366847d1caa64a7d329672292fd34"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets up the equilibrium grid.  <br /></td></tr>
<tr class="memitem:addd35a4585f818ae0a7d94ee2156f1bd" id="r_addd35a4585f818ae0a7d94ee2156f1bd"><td class="memItemLeft">integer function, public&#160;</td><td class="memItemRight"><a class="el" href="#addd35a4585f818ae0a7d94ee2156f1bd">setup_grid_eq_b</a> (grid_eq, grid_eq_b, eq, only_half_grid)</td></tr>
<tr class="memdesc:addd35a4585f818ae0a7d94ee2156f1bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets up the field-aligned equilibrium grid.  <br /></td></tr>
<tr class="memitem:affff458bc90352a94138e63b4a0feebe" id="r_affff458bc90352a94138e63b4a0feebe"><td class="memItemLeft">integer function, public&#160;</td><td class="memItemRight"><a class="el" href="#affff458bc90352a94138e63b4a0feebe">setup_grid_x</a> (grid_eq, grid_x, r_f_x, x_limits)</td></tr>
<tr class="memdesc:affff458bc90352a94138e63b4a0feebe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets up the general perturbation grid, in which the perturbation variables are calculated.  <br /></td></tr>
<tr class="memitem:acb93d3ad89ab0efeff8c1b31ff77cec1" id="r_acb93d3ad89ab0efeff8c1b31ff77cec1"><td class="memItemLeft">integer function, public&#160;</td><td class="memItemRight"><a class="el" href="#acb93d3ad89ab0efeff8c1b31ff77cec1">setup_grid_sol</a> (grid_eq, grid_x, grid_sol, r_f_sol, sol_limits)</td></tr>
<tr class="memdesc:acb93d3ad89ab0efeff8c1b31ff77cec1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets up the general solution grid, in which the solution variables are calculated.  <br /></td></tr>
<tr class="memitem:a06107dbdfd1dd62e372cc29ab0255bad" id="r_a06107dbdfd1dd62e372cc29ab0255bad"><td class="memItemLeft">integer function, public&#160;</td><td class="memItemRight"><a class="el" href="#a06107dbdfd1dd62e372cc29ab0255bad">calc_ang_grid_eq_b</a> (grid_eq, eq, only_half_grid)</td></tr>
<tr class="memdesc:a06107dbdfd1dd62e372cc29ab0255bad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate equilibrium grid that follows magnetic field lines.  <br /></td></tr>
<tr class="memitem:ab10ef5b486ee3861df2da4e53bc22630" id="r_ab10ef5b486ee3861df2da4e53bc22630"><td class="memItemLeft">integer function, public&#160;</td><td class="memItemRight"><a class="el" href="#ab10ef5b486ee3861df2da4e53bc22630">redistribute_output_grid</a> (grid, grid_out, no_outer_trim)</td></tr>
<tr class="memdesc:ab10ef5b486ee3861df2da4e53bc22630"><td class="mdescLeft">&#160;</td><td class="mdescRight">Redistribute a grid to match the normal distribution of solution grid.  <br /></td></tr>
<tr class="memitem:addd76b7b3be0b51e0863ae0cdfef41e6" id="r_addd76b7b3be0b51e0863ae0cdfef41e6"><td class="memItemLeft">integer function, public&#160;</td><td class="memItemRight"><a class="el" href="#addd76b7b3be0b51e0863ae0cdfef41e6">magn_grid_plot</a> (grid)</td></tr>
<tr class="memdesc:addd76b7b3be0b51e0863ae0cdfef41e6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Plots the grid in real 3-D space.  <br /></td></tr>
<tr class="memitem:a4827e794d37334c0cad9bb2016e64d46" id="r_a4827e794d37334c0cad9bb2016e64d46"><td class="memItemLeft">integer function, public&#160;</td><td class="memItemRight"><a class="el" href="#a4827e794d37334c0cad9bb2016e64d46">print_output_grid</a> (grid, grid_name, data_name, rich_lvl, par_div, remove_previous_arrs)</td></tr>
<tr class="memdesc:a4827e794d37334c0cad9bb2016e64d46"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print grid variables to an output file.  <br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-var-members" class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ad043ab1b07b2d251bb7596b8c8d2f960" id="r_ad043ab1b07b2d251bb7596b8c8d2f960"><td class="memItemLeft">logical, public&#160;</td><td class="memItemRight"><a class="el" href="#ad043ab1b07b2d251bb7596b8c8d2f960">debug_calc_ang_grid_eq_b</a> = .false.</td></tr>
<tr class="memdesc:ad043ab1b07b2d251bb7596b8c8d2f960"><td class="mdescLeft">&#160;</td><td class="mdescRight">plot debug information for <a class="el" href="#a06107dbdfd1dd62e372cc29ab0255bad" title="Calculate equilibrium grid that follows magnetic field lines.">calc_ang_grid_eq_b()</a>  <br /></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Operations that have to do with the grids and different coordinate systems. </p>
</div><a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function/Subroutine Documentation</h2>
<a id="a06107dbdfd1dd62e372cc29ab0255bad" name="a06107dbdfd1dd62e372cc29ab0255bad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06107dbdfd1dd62e372cc29ab0255bad">&#9670;&#160;</a></span>calc_ang_grid_eq_b()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public grid_ops::calc_ang_grid_eq_b </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structgrid__vars_1_1grid__type.html">grid_type</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>grid_eq</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structeq__vars_1_1eq__1__type.html">eq_1_type</a>), intent(in), target</td>          <td class="paramname"><span class="paramname"><em>eq</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional</td>          <td class="paramname"><span class="paramname"><em>only_half_grid</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate equilibrium grid that follows magnetic field lines. </p>
<p>This grid is different from the equilibrium grid from setup_grid_eq for HELENA, as the latter is the output grid from HELENA, which is situated in a single poloidal cross-section, as opposed to a really field-aligne grid.</p>
<p>For VMEC, this is not used as the grid is field-aligned from the start.</p>
<dl class="section note"><dt>Note</dt><dd><ol type="1">
<li>The end-points are included for the grids in the parallel direction. This is to facilitate working with the trapezoidal rule or Simpson's 3/8 rule for integration. This is <b>NOT</b> valid in general!</li>
<li>by setting the flag <code>only_half_grid</code>, only the even points of the parallel grid are calculated, which is useful for higher Richardson levels with VMEC so that only new angular points are calculated and the old ones reused.</li>
</ol>
</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>ierr </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">grid_eq</td><td>equilibrium grid of which to calculate angular part </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eq</td><td>flux equilibrium variables </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">only_half_grid</td><td>calculate only half grid with even points </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="grid__ops_8f90_source.html#l00797">797</a> of file <a class="el" href="grid__ops_8f90_source.html">grid_ops.f90</a>.</p>
<div id="dynsection-0" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;"><span class="dynarrow"><span class="arrowhead closed"></span></span>Here is the call graph for this function:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" loading="lazy" frameborder="0" src="namespacegrid__ops_a06107dbdfd1dd62e372cc29ab0255bad_cgraph.svg" width="1134" height="379"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-1" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;"><span class="dynarrow"><span class="arrowhead closed"></span></span>Here is the caller graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" loading="lazy" frameborder="0" src="namespacegrid__ops_a06107dbdfd1dd62e372cc29ab0255bad_icgraph.svg" width="872" height="72"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a7dd21871a4e65190fe6235eb2af4b6c2" name="a7dd21871a4e65190fe6235eb2af4b6c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7dd21871a4e65190fe6235eb2af4b6c2">&#9670;&#160;</a></span>calc_norm_range()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public grid_ops::calc_norm_range </td>
          <td>(</td>
          <td class="paramtype">character(len=*), intent(in)</td>          <td class="paramname"><span class="paramname"><em>style</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(2), intent(inout), optional</td>          <td class="paramname"><span class="paramname"><em>in_limits</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(2), intent(inout), optional</td>          <td class="paramname"><span class="paramname"><em>eq_limits</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(2), intent(inout), optional</td>          <td class="paramname"><span class="paramname"><em>x_limits</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(2), intent(inout), optional</td>          <td class="paramname"><span class="paramname"><em>sol_limits</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(inout), optional</td>          <td class="paramname"><span class="paramname"><em>r_f_eq</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(inout), optional, allocatable</td>          <td class="paramname"><span class="paramname"><em>r_f_x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(inout), optional</td>          <td class="paramname"><span class="paramname"><em>r_f_sol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in), optional</td>          <td class="paramname"><span class="paramname"><em>jq</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates normal range for the input grid, the equilibrium grid and/or the solution grid. </p>
<p>General workings, depending on <code>X_grid_style:</code> </p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">1 (equilibrium)  </th><th class="markdownTableHeadNone">2 (solution )  </th><th class="markdownTableHeadNone">3 (enriched)  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">calc_eq()  </td><td class="markdownTableBodyNone">calc_eq()  </td><td class="markdownTableBodyNone">calc_eq()  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">redistribute to sol  </td><td class="markdownTableBodyNone">add points to optimize  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">interpolate to sol  </td><td class="markdownTableBodyNone">interpolate to X  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">calc_x()  </td><td class="markdownTableBodyNone">calc_x()  </td><td class="markdownTableBodyNone">calc_x()  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">redistribute to sol  </td><td class="markdownTableBodyNone">copy to sol  </td><td class="markdownTableBodyNone">redistribute to sol  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">interpolate to sol  </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">interpolate to sol  </td></tr>
</table>
<dl class="section return"><dt>Returns</dt><dd>ierr </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">style</td><td>style of calculation (PB3D: in, eq, X or sol; POST) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">in_limits</td><td>min. and max. index of in grid </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">eq_limits</td><td>min. and max. index of eq grid for this process </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">x_limits</td><td>min. and max. index of X grid for this process </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">sol_limits</td><td>min. and max. index of sol grid for this process </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">r_f_eq</td><td>equilibrium r_F </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">r_f_x</td><td>perturbation r_F </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">r_f_sol</td><td>solution r_F </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jq</td><td>q_saf (pol. flux) or rot_t (tor. flux) in total Flux variables </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="grid__ops_8f90_source.html#l00044">44</a> of file <a class="el" href="grid__ops_8f90_source.html">grid_ops.f90</a>.</p>
<div id="dynsection-2" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;"><span class="dynarrow"><span class="arrowhead closed"></span></span>Here is the call graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" loading="lazy" frameborder="0" src="namespacegrid__ops_a7dd21871a4e65190fe6235eb2af4b6c2_cgraph.svg" width="1411" height="511"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-3" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;"><span class="dynarrow"><span class="arrowhead closed"></span></span>Here is the caller graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" loading="lazy" frameborder="0" src="namespacegrid__ops_a7dd21871a4e65190fe6235eb2af4b6c2_icgraph.svg" width="872" height="311"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="addd76b7b3be0b51e0863ae0cdfef41e6" name="addd76b7b3be0b51e0863ae0cdfef41e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addd76b7b3be0b51e0863ae0cdfef41e6">&#9670;&#160;</a></span>magn_grid_plot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public grid_ops::magn_grid_plot </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structgrid__vars_1_1grid__type.html">grid_type</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>grid</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Plots the grid in real 3-D space. </p>
<p>This creates an animation that can be used by ParaView or VisIt.</p>
<p>The equilibrium grid should contain the fieldline-oriented angles with <code>ang_1</code> the parallel angle and <code>ang_2</code> the field line label.</p>
<dl class="section see"><dt>See also</dt><dd>See <a class="el" href="structgrid__vars_1_1grid__type.html" title="Type for grids.">grid_vars.grid_type</a> for a discussion on <code>ang_1</code> and <code>ang_2</code>.</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ol type="1">
<li>This procedure does not use <code>n_theta_plot</code> and <code>n_zeta_plot</code> from <a class="el" href="namespacenum__vars.html" title="Numerical variables used by most other modules.">num_vars</a>, but instead temporarily overwrites them with its own, since it is suposed to be 3-D also in the axisymmetric case.</li>
<li>The implementation is currently very slow.</li>
</ol>
</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>ierr </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">grid</td><td>fieldline-oriented equilibrium grid </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="grid__ops_8f90_source.html#l01114">1114</a> of file <a class="el" href="grid__ops_8f90_source.html">grid_ops.f90</a>.</p>
<div id="dynsection-4" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;"><span class="dynarrow"><span class="arrowhead closed"></span></span>Here is the call graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" loading="lazy" frameborder="0" src="namespacegrid__ops_addd76b7b3be0b51e0863ae0cdfef41e6_cgraph.svg" width="1278" height="826"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-5" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;"><span class="dynarrow"><span class="arrowhead closed"></span></span>Here is the caller graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" loading="lazy" frameborder="0" src="namespacegrid__ops_addd76b7b3be0b51e0863ae0cdfef41e6_icgraph.svg" width="651" height="91"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a4827e794d37334c0cad9bb2016e64d46" name="a4827e794d37334c0cad9bb2016e64d46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4827e794d37334c0cad9bb2016e64d46">&#9670;&#160;</a></span>print_output_grid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public grid_ops::print_output_grid </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structgrid__vars_1_1grid__type.html">grid_type</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>grid</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)</td>          <td class="paramname"><span class="paramname"><em>grid_name</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)</td>          <td class="paramname"><span class="paramname"><em>data_name</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional</td>          <td class="paramname"><span class="paramname"><em>rich_lvl</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional</td>          <td class="paramname"><span class="paramname"><em>par_div</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional</td>          <td class="paramname"><span class="paramname"><em>remove_previous_arrs</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print grid variables to an output file. </p>
<p>If <code>rich_lvl</code> is provided, <span class="tt"><em>R</em>[rich_lvl]</span> is appended to the data name if it is &gt; 0.</p>
<p>Optionally, it can be specified that this is a divided parallel grid, corresponding to the variable <code>eq_jobs_lims</code> with index <code>eq_job_nr</code>. In this case, the total grid size is adjusted to the one specified by <code>eq_jobs_lims</code> and the grid is written as a subset.</p>
<dl class="section note"><dt>Note</dt><dd><span class="tt">grid_</span> is added in front the data_name.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>ierr </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">grid</td><td>grid variables </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid_name</td><td>name to display </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data_name</td><td>name under which to store </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rich_lvl</td><td>Richardson level to reconstruct </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">par_div</td><td>is a parallely divided grid </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">remove_previous_arrs</td><td>remove previous variables if present </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="grid__ops_8f90_source.html#l01487">1487</a> of file <a class="el" href="grid__ops_8f90_source.html">grid_ops.f90</a>.</p>
<div id="dynsection-6" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;"><span class="dynarrow"><span class="arrowhead closed"></span></span>Here is the call graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" loading="lazy" frameborder="0" src="namespacegrid__ops_a4827e794d37334c0cad9bb2016e64d46_cgraph.svg" width="1451" height="388"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-7" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;"><span class="dynarrow"><span class="arrowhead closed"></span></span>Here is the caller graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" loading="lazy" frameborder="0" src="namespacegrid__ops_a4827e794d37334c0cad9bb2016e64d46_icgraph.svg" width="691" height="143"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ab10ef5b486ee3861df2da4e53bc22630" name="ab10ef5b486ee3861df2da4e53bc22630"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab10ef5b486ee3861df2da4e53bc22630">&#9670;&#160;</a></span>redistribute_output_grid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public grid_ops::redistribute_output_grid </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structgrid__vars_1_1grid__type.html">grid_type</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>grid</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structgrid__vars_1_1grid__type.html">grid_type</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>grid_out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional</td>          <td class="paramname"><span class="paramname"><em>no_outer_trim</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Redistribute a grid to match the normal distribution of solution grid. </p>
<p>The routine first calculates the smallest eq range that comprises the sol range. Then, it gets the lowest equilibrium limits able to setup an output grid that starts at index 1. After determining the output grid, it then sends the variables to their new processes using MPI.</p>
<dl class="section note"><dt>Note</dt><dd><ol type="1">
<li>Only the Flux variables are saved.</li>
<li>the redistributed grid has trimmed outer limits, i.e. it starts at 1 and ends at the upper limit of the last process. This can be turned off optionally using <code>no_outer_trim</code>.</li>
</ol>
</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>ierr </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">grid</td><td>equilibrium grid variables </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">grid_out</td><td>redistributed equilibrium grid variables </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">no_outer_trim</td><td>do not trim the outer limits </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="grid__ops_8f90_source.html#l00993">993</a> of file <a class="el" href="grid__ops_8f90_source.html">grid_ops.f90</a>.</p>
<div id="dynsection-8" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;"><span class="dynarrow"><span class="arrowhead closed"></span></span>Here is the call graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" loading="lazy" frameborder="0" src="namespacegrid__ops_ab10ef5b486ee3861df2da4e53bc22630_cgraph.svg" width="1752" height="651"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-9" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;"><span class="dynarrow"><span class="arrowhead closed"></span></span>Here is the caller graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" loading="lazy" frameborder="0" src="namespacegrid__ops_ab10ef5b486ee3861df2da4e53bc22630_icgraph.svg" width="651" height="91"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="af63366847d1caa64a7d329672292fd34" name="af63366847d1caa64a7d329672292fd34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af63366847d1caa64a7d329672292fd34">&#9670;&#160;</a></span>setup_grid_eq()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public grid_ops::setup_grid_eq </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structgrid__vars_1_1grid__type.html">grid_type</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>grid_eq</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(2), intent(in)</td>          <td class="paramname"><span class="paramname"><em>eq_limits</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets up the equilibrium grid. </p>
<p>The following variables are calculated:</p><ul>
<li>equilibrium variables (eq)</li>
<li>perturbation variables (X)</li>
</ul>
<p>For the implementation of the equilibrium grid the normal part of the grid is always given by the output of the equilibrium code, but the angular part depends on the style:</p><ul>
<li>VMEC: The output is analytic in the angular coordinates, so field-aligned coordinates are used. Later, in <a class="el" href="#a06107dbdfd1dd62e372cc29ab0255bad" title="Calculate equilibrium grid that follows magnetic field lines.">calc_ang_grid_eq_b()</a>, the angular variables are calculated.</li>
<li>HELENA: The output is given on a poloidal grid (no toroidal dependency due to axisymmetry), which is used.</li>
</ul>
<dl class="section return"><dt>Returns</dt><dd>ierr </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">grid_eq</td><td>equilibrium grid </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eq_limits</td><td>min. and max. index of eq grid of this process </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="grid__ops_8f90_source.html#l00528">528</a> of file <a class="el" href="grid__ops_8f90_source.html">grid_ops.f90</a>.</p>
<div id="dynsection-10" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;"><span class="dynarrow"><span class="arrowhead closed"></span></span>Here is the call graph for this function:</div>
<div id="dynsection-10-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-10-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" loading="lazy" frameborder="0" src="namespacegrid__ops_af63366847d1caa64a7d329672292fd34_cgraph.svg" width="707" height="152"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-11" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;"><span class="dynarrow"><span class="arrowhead closed"></span></span>Here is the caller graph for this function:</div>
<div id="dynsection-11-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-11-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" loading="lazy" frameborder="0" src="namespacegrid__ops_af63366847d1caa64a7d329672292fd34_icgraph.svg" width="643" height="39"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="addd35a4585f818ae0a7d94ee2156f1bd" name="addd35a4585f818ae0a7d94ee2156f1bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addd35a4585f818ae0a7d94ee2156f1bd">&#9670;&#160;</a></span>setup_grid_eq_b()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public grid_ops::setup_grid_eq_b </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structgrid__vars_1_1grid__type.html">grid_type</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>grid_eq</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structgrid__vars_1_1grid__type.html">grid_type</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>grid_eq_b</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structeq__vars_1_1eq__1__type.html">eq_1_type</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>eq</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional</td>          <td class="paramname"><span class="paramname"><em>only_half_grid</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets up the field-aligned equilibrium grid. </p>
<p>This serves as a bridge to the solution grid, as it contains the same normal coordinate as the general grid, but the angular coordinates are defined by the solution grid.</p>
<p>Optionally, only half the grid can be calculated (i.e. only the even points), which is used for Richardson levels greater than 1.</p>
<dl class="section note"><dt>Note</dt><dd>In contrast to <code>setup_grid_eq</code>, the angular coordinates are also calculated here.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>ierr </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">grid_eq</td><td>general equilibrium grid </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">grid_eq_b</td><td>field-aligned equilibrium grid </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eq</td><td>flux equilibrium variables </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">only_half_grid</td><td>calculate only half grid with even points </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="grid__ops_8f90_source.html#l00599">599</a> of file <a class="el" href="grid__ops_8f90_source.html">grid_ops.f90</a>.</p>
<div id="dynsection-12" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;"><span class="dynarrow"><span class="arrowhead closed"></span></span>Here is the call graph for this function:</div>
<div id="dynsection-12-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-12-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" loading="lazy" frameborder="0" src="namespacegrid__ops_addd35a4585f818ae0a7d94ee2156f1bd_cgraph.svg" width="1403" height="379"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-13" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;"><span class="dynarrow"><span class="arrowhead closed"></span></span>Here is the caller graph for this function:</div>
<div id="dynsection-13-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-13-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" loading="lazy" frameborder="0" src="namespacegrid__ops_addd35a4585f818ae0a7d94ee2156f1bd_icgraph.svg" width="659" height="39"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="acb93d3ad89ab0efeff8c1b31ff77cec1" name="acb93d3ad89ab0efeff8c1b31ff77cec1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb93d3ad89ab0efeff8c1b31ff77cec1">&#9670;&#160;</a></span>setup_grid_sol()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public grid_ops::setup_grid_sol </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structgrid__vars_1_1grid__type.html">grid_type</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>grid_eq</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structgrid__vars_1_1grid__type.html">grid_type</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>grid_x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structgrid__vars_1_1grid__type.html">grid_type</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>grid_sol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)</td>          <td class="paramname"><span class="paramname"><em>r_f_sol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(2), intent(in)</td>          <td class="paramname"><span class="paramname"><em>sol_limits</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets up the general solution grid, in which the solution variables are calculated. </p>
<p>For the solution grid, only one parallel point is used, but possibly multiple geodesic points, equal to the number of field lines, <code>n_alpha</code>.</p>
<dl class="section return"><dt>Returns</dt><dd>ierr </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">grid_eq</td><td>equilibrium grid </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid_x</td><td>perturbation grid </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">grid_sol</td><td>solution grid </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r_f_sol</td><td>points of solution grid </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sol_limits</td><td>min. and max. index of sol grid of this process </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="grid__ops_8f90_source.html#l00726">726</a> of file <a class="el" href="grid__ops_8f90_source.html">grid_ops.f90</a>.</p>
<div id="dynsection-14" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;"><span class="dynarrow"><span class="arrowhead closed"></span></span>Here is the call graph for this function:</div>
<div id="dynsection-14-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-14-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" loading="lazy" frameborder="0" src="namespacegrid__ops_acb93d3ad89ab0efeff8c1b31ff77cec1_cgraph.svg" width="667" height="115"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-15" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;"><span class="dynarrow"><span class="arrowhead closed"></span></span>Here is the caller graph for this function:</div>
<div id="dynsection-15-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-15-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" loading="lazy" frameborder="0" src="namespacegrid__ops_acb93d3ad89ab0efeff8c1b31ff77cec1_icgraph.svg" width="667" height="39"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="affff458bc90352a94138e63b4a0feebe" name="affff458bc90352a94138e63b4a0feebe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#affff458bc90352a94138e63b4a0feebe">&#9670;&#160;</a></span>setup_grid_x()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public grid_ops::setup_grid_x </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structgrid__vars_1_1grid__type.html">grid_type</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>grid_eq</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structgrid__vars_1_1grid__type.html">grid_type</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>grid_x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in), allocatable</td>          <td class="paramname"><span class="paramname"><em>r_f_x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(2), intent(in)</td>          <td class="paramname"><span class="paramname"><em>x_limits</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets up the general perturbation grid, in which the perturbation variables are calculated. </p>
<p>For <code>X_grid_style</code> 1, this grid is identical to the equilibrium grid, and for <code>X_grid_style</code> 2,it has the same angular extent but with different normal points, indicated by the variable <code>r_F_X</code>.</p>
<dl class="section return"><dt>Returns</dt><dd>ierr </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">grid_eq</td><td>equilibrium grid </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">grid_x</td><td>perturbation grid </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r_f_x</td><td>points of perturbation grid </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x_limits</td><td>min. and max. index of perturbation grid of this process </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="grid__ops_8f90_source.html#l00654">654</a> of file <a class="el" href="grid__ops_8f90_source.html">grid_ops.f90</a>.</p>
<div id="dynsection-16" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;"><span class="dynarrow"><span class="arrowhead closed"></span></span>Here is the caller graph for this function:</div>
<div id="dynsection-16-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-16-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" loading="lazy" frameborder="0" src="namespacegrid__ops_affff458bc90352a94138e63b4a0feebe_icgraph.svg" width="619" height="39"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a name="doc-var-members" id="doc-var-members"></a><h2 id="header-doc-var-members" class="groupheader">Variable Documentation</h2>
<a id="ad043ab1b07b2d251bb7596b8c8d2f960" name="ad043ab1b07b2d251bb7596b8c8d2f960"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad043ab1b07b2d251bb7596b8c8d2f960">&#9670;&#160;</a></span>debug_calc_ang_grid_eq_b</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical, public grid_ops::debug_calc_ang_grid_eq_b = .false.</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>plot debug information for <a class="el" href="#a06107dbdfd1dd62e372cc29ab0255bad" title="Calculate equilibrium grid that follows magnetic field lines.">calc_ang_grid_eq_b()</a> </p>
<dl class="section note"><dt>Note</dt><dd>Debug version only </dd></dl>

<p class="definition">Definition at line <a class="el" href="grid__ops_8f90_source.html#l00025">25</a> of file <a class="el" href="grid__ops_8f90_source.html">grid_ops.f90</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<address class="footer"><small>
<center>this documentation was created with <a href="http://www.doxygen.org/index.html">Doxygen 1.16.1</a> by <a href="mailto:weyenst@gmail.com">Toon Weyens</a></center>
</small></address>
</body>
</html>
