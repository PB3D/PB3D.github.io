<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PB3D: helena_ops Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PB3D
   &#160;<span id="projectnumber">[2.24]</span>
   </div>
   <div id="projectbrief">Ideal linear high-n MHD stability in 3-D</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">helena_ops Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Operations on HELENA variables.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:ae05ba1182eb002d93c27ca4ff7ab8cf2"><td class="memItemLeft" align="right" valign="top">integer function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehelena__ops.html#ae05ba1182eb002d93c27ca4ff7ab8cf2">read_hel</a> (n_r_in, use_pol_flux_H)</td></tr>
<tr class="memdesc:ae05ba1182eb002d93c27ca4ff7ab8cf2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads the HELENA equilibrium data.  <a href="#ae05ba1182eb002d93c27ca4ff7ab8cf2">More...</a><br /></td></tr>
<tr class="separator:ae05ba1182eb002d93c27ca4ff7ab8cf2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1329afe5af2ff92d96f4be15a096b38"><td class="memItemLeft" align="right" valign="top">integer function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehelena__ops.html#ab1329afe5af2ff92d96f4be15a096b38">get_ang_interp_data_hel</a> (grid_in, grid_out, theta_i, fund_theta_int_displ, tb_sym, use_E)</td></tr>
<tr class="memdesc:ab1329afe5af2ff92d96f4be15a096b38"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate interpolation factors for angular interpolation in <code>grid_out</code> of quantities defined on <code>grid_in</code>.  <a href="#ab1329afe5af2ff92d96f4be15a096b38">More...</a><br /></td></tr>
<tr class="separator:ab1329afe5af2ff92d96f4be15a096b38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7796861de18ae7ac9c3aa07a8628be38"><td class="memItemLeft" align="right" valign="top">integer function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehelena__ops.html#a7796861de18ae7ac9c3aa07a8628be38">interp_hel_on_grid</a> (grid_in, grid_out, eq_2, X_1, X_2, eq_2_out, X_1_out, X_2_out, eq_1, grid_name)</td></tr>
<tr class="memdesc:a7796861de18ae7ac9c3aa07a8628be38"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interpolate variables resulting from HELENA equilibria to another grid (angularly).  <a href="#a7796861de18ae7ac9c3aa07a8628be38">More...</a><br /></td></tr>
<tr class="separator:a7796861de18ae7ac9c3aa07a8628be38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f156b3653264fb016d6d311eb59114c"><td class="memItemLeft" align="right" valign="top">integer function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehelena__ops.html#a0f156b3653264fb016d6d311eb59114c">test_metrics_h</a> ()</td></tr>
<tr class="memdesc:a0f156b3653264fb016d6d311eb59114c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks whether the metric elements provided by HELENA are consistent with a direct calculation using the coordinate transformations <a class="el" href="citelist.html#CITEREF_Weyens3D">[16]</a>.  <a href="#a0f156b3653264fb016d6d311eb59114c">More...</a><br /></td></tr>
<tr class="separator:a0f156b3653264fb016d6d311eb59114c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83f2ad5dc967c7bae287b60fddb8eb0a"><td class="memItemLeft" align="right" valign="top">integer function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehelena__ops.html#a83f2ad5dc967c7bae287b60fddb8eb0a">test_harm_cont_h</a> ()</td></tr>
<tr class="memdesc:a83f2ad5dc967c7bae287b60fddb8eb0a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Investaige harmonic content of the HELENA variables.  <a href="#a83f2ad5dc967c7bae287b60fddb8eb0a">More...</a><br /></td></tr>
<tr class="separator:a83f2ad5dc967c7bae287b60fddb8eb0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Operations on HELENA variables. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="ab1329afe5af2ff92d96f4be15a096b38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1329afe5af2ff92d96f4be15a096b38">&#9670;&nbsp;</a></span>get_ang_interp_data_hel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function helena_ops::get_ang_interp_data_hel </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structgrid__vars_1_1grid__type.html">grid_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>grid_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structgrid__vars_1_1grid__type.html">grid_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>grid_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:,:,:), intent(inout), allocatable&#160;</td>
          <td class="paramname"><em>theta_i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:,:,:), intent(inout), allocatable&#160;</td>
          <td class="paramname"><em>fund_theta_int_displ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>tb_sym</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>use_E</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate interpolation factors for angular interpolation in <code>grid_out</code> of quantities defined on <code>grid_in</code>. </p>
<p>This version is specific for an input grid corresponding to axisymmetric variables with optional top-down symmetry, as is the case for variables resulting from HELENA equilibria.</p>
<p>The output of a 3-D array of real values for the poloidal angle \(\theta\) where the floored integer of each value indicates the base index of the interpolated value in the output grid and the modulus is the the fraction towards the next integer.</p>
<p>The flag <code>tb_sym</code> indicates optionally that there is top-bottom symmetry as well as axisymmetry. When there is top-down symmetry, the variables in the lower half (i.e. \(-\pi &lt; \theta &lt; 0\)) are calculated from the variables in the upper half using the symmetry properties of the variables. To indicate this, the sign of the interpolation factor is inverted to a negative value.</p>
<p>The displacement of the theta interval towards the fundamental theta interval is also outputted. For asymmetric variables this is for example:</p><ul>
<li>1 for \(-2\pi \ldots 0\)</li>
<li>0 for \( 0 \ldots 2\pi\)</li>
<li>-1 for \( 2\pi \ldots 4\pi\)</li>
</ul>
<p>etc.</p>
<p>For symmetric variables, this is for example:</p><ul>
<li>1 for \(-3\pi \ldots -2\pi\), with symmetry property</li>
<li>1 for \(-2\pi \ldots -\pi\)</li>
<li>0 for \(-\pi \ldots 0\), with symmetry property</li>
<li>0 for \( 0 \ldots \pi\)</li>
<li>-1 for \( \pi \ldots 2\pi\), with symmetry property</li>
<li>-1 for \( 3\pi \ldots 3\pi\) etc.</li>
</ul>
<p>By default, the variables in the Flux coord. system are used, but this can be changed optionally with the flag <code>"use_E</code>.</p>
<dl class="section return"><dt>Returns</dt><dd>ierr</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">grid_in</td><td>input grid</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid_out</td><td>output grid</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">theta_i</td><td>interpolation index</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fund_theta_int_displ</td><td>displacement of fundamental theta interval</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tb_sym</td><td>top-bottom symmetry</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">use_e</td><td>whether E is used instead of F </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="HELENA__ops_8f90_source.html#l00413">413</a> of file <a class="el" href="HELENA__ops_8f90_source.html">HELENA_ops.f90</a>.</p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacehelena__ops_ab1329afe5af2ff92d96f4be15a096b38_icgraph.svg" width="1044" height="147"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a7796861de18ae7ac9c3aa07a8628be38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7796861de18ae7ac9c3aa07a8628be38">&#9670;&nbsp;</a></span>interp_hel_on_grid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public helena_ops::interp_hel_on_grid </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structgrid__vars_1_1grid__type.html">grid_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>grid_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structgrid__vars_1_1grid__type.html">grid_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>grid_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structeq__vars_1_1eq__2__type.html">eq_2_type</a>), intent(inout), optional&#160;</td>
          <td class="paramname"><em>eq_2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(x_1_type), intent(inout), optional&#160;</td>
          <td class="paramname"><em>X_1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(x_2_type), intent(inout), optional&#160;</td>
          <td class="paramname"><em>X_2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structeq__vars_1_1eq__2__type.html">eq_2_type</a>), intent(inout), optional&#160;</td>
          <td class="paramname"><em>eq_2_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(x_1_type), intent(inout), optional&#160;</td>
          <td class="paramname"><em>X_1_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(x_2_type), intent(inout), optional&#160;</td>
          <td class="paramname"><em>X_2_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structeq__vars_1_1eq__1__type.html">eq_1_type</a>), intent(in), optional&#160;</td>
          <td class="paramname"><em>eq_1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>grid_name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Interpolate variables resulting from HELENA equilibria to another grid (angularly). </p>
<p>The input and output grid to be provided depend on the quantities to be interpolated:</p><ul>
<li>equilibrium variables: flux variables (no need to convert) and derived quantities (need equilibrium grid)</li>
<li>metric variables: jac_FD (need equilibrium grid)</li>
<li>vectorial perturbation variables: U_i, DU_i (need perturbation grid)</li>
<li>tensorial perturbation variables: PV_i, KV_i (need perturbation grid)</li>
</ul>
<p>Also, a message can be printed if a grid name is passed.</p>
<dl class="section note"><dt>Note</dt><dd><ol type="1">
<li>The metric coefficients are interpolated and then compensated for the straight-field-line coordinates as in <a class="el" href="citelist.html#CITEREF_Weyens3D">[16]</a> .</li>
<li>By default the interpolated quantities overwrite the original ones, but alternative output variables can be provided.</li>
<li>as the equilibrium and perturbation grid are not generally identical, this routine has to be called separately for the variables tabulated in either grid.</li>
</ol>
</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>ierr</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">grid_in</td><td>input grid</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid_out</td><td>output grid</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">eq_2</td><td>general metric equilibrium variables</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">x_1</td><td>general vectorial perturbation variables</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">x_2</td><td>general tensorial perturbation variables</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">eq_2_out</td><td>field-aligned metric equilibrium variables</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">x_1_out</td><td>field-aligned vectorial perturbation variables</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">x_2_out</td><td>field-aligned tensorial perturbation variables</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eq_1</td><td>general flux equilibrium variables for metric interpolation</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid_name</td><td>name of grid to which to adapt quantities </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="HELENA__ops_8f90_source.html#l00550">550</a> of file <a class="el" href="HELENA__ops_8f90_source.html">HELENA_ops.f90</a>.</p>
<div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacehelena__ops_a7796861de18ae7ac9c3aa07a8628be38_cgraph.svg" width="862" height="324"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacehelena__ops_a7796861de18ae7ac9c3aa07a8628be38_icgraph.svg" width="822" height="147"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ae05ba1182eb002d93c27ca4ff7ab8cf2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae05ba1182eb002d93c27ca4ff7ab8cf2">&#9670;&nbsp;</a></span>read_hel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public helena_ops::read_hel </td>
          <td>(</td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>n_r_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(inout)&#160;</td>
          <td class="paramname"><em>use_pol_flux_H</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads the HELENA equilibrium data. </p>
<p>Adapted from HELENA routine <code>IODSK</code>.</p>
<p>The variales in the HELENA mapping file are globalized in two ways:</p><ul>
<li>X and Y are normalized w.r.t. vacuum geometric axis <code>R_vac</code> and toroidal field at the geometric axis <code>B_vac</code>.</li>
<li><code> R[m] = R_vac[m] (1 + eps X[]) </code>,</li>
<li><code> Z[m] = R_vac[m] eps Y[] </code>.</li>
</ul>
<p>The covariant toroidal field <code>F_H</code>, <code>pres_H</code> and poloidal flux are normalized w.r.t magnetic axis <code>R_m</code> and total toroidal field at magnetic axis <code>B_m:</code> </p><ul>
<li><code> RBphi[Tm] = F_H[] R_m[m] B_m[T] </code>,</li>
<li><code> pres[N/m^2] = pres_H[] (B_m[T])^2/mu_0[N/A^2] </code>,</li>
<li><code> flux_p[Tm^2] = 2pi (s[])^2 cpsurf[] B_m[T] (R_m[m])^2 </code>.</li>
</ul>
<p>The first normalization type is the HELENA normalization, whereas the second is the MISHKA normalization.</p>
<p>Everything is translated to MISHKA normalization to make comparison with MISHKA simple. This is done using the factors:</p><ul>
<li><code> radius[] = a[m] / R_m[m] </code>,</li>
<li><code> eps[] = a[m] / R_vac[m] </code>, so that the expressions become:</li>
<li><code> R[m] = radius[] (1/eps[] + X[]) R_m[m]</code>,</li>
<li><code> Z[m] = radius[] Y[] R_m[m]</code>,</li>
<li><code> RBphi[Tm] = F_H[] B_m[T] R_m[m]</code>,</li>
<li><code> pres[N/m^2] = pres_H[] B_m[T]^2 mu_0[N/A^2]^-1</code>,</li>
<li><code> flux_p[Tm^2] = 2pi (s[])^2 cpsurf[] B_m[T] R_m[T]^2</code>.</li>
</ul>
<p>Finally, in HELENA, the total current <code>I</code>, the poloidal beta and the density at the geometric axis can be prescribed through:</p><ul>
<li><code> XIAB = mu_0 I / (a_vac B_vac) </code>,</li>
<li><code> BETAP = 8 pi S &lt;p&gt; / (I^2 mu_0) </code>,</li>
<li><code> ZN </code>,</li>
</ul>
<p>where <code> a_vac = eps R_vac </code> and <code>B_vac</code> are vacuum quantities, <code>S</code> is the 2-D cross-sectional area and &lt;p&gt; is the 2-D averaged pressure.</p>
<dl class="section note"><dt>Note</dt><dd>To translate this to the MISHKA normalization factors as<ul>
<li><code> R_m = (eps/radius) R_vac </code>,</li>
<li><code> B_m = B_vac / B0 </code>,</li>
</ul>
</dd>
<dd>
where<ul>
<li><code>radius</code> is in the mapping file (12), as well as in the HELENA output (20).</li>
<li><code>eps</code> is in the mapping file (12), as well as in the HELENA input (10) and output (20).</li>
<li><code>B0</code> is in the mapping file (12), as well as in the HELENA output (20). </li>
</ul>
</dd>
<dd>
Furthermore, the density on axis can be specified as <code>ZN0</code> from HELENA input (10). <br />
 The other variables should probably not be touched for consistency. </dd>
<dd>
Finally, the variables IAS and B0 are in the mapping file (12) only in patched versions. See <a class="el" href="page_tutorial.html#tutorial_eq">Getting the Equilibrium</a>.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>ierr</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">n_r_in</td><td>nr. of normal points in input grid</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">use_pol_flux_h</td><td>.true. if HELENA equilibrium is based on pol. flux </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="HELENA__ops_8f90_source.html#l00084">84</a> of file <a class="el" href="HELENA__ops_8f90_source.html">HELENA_ops.f90</a>.</p>
<div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacehelena__ops_ae05ba1182eb002d93c27ca4ff7ab8cf2_cgraph.svg" width="1331" height="362"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacehelena__ops_ae05ba1182eb002d93c27ca4ff7ab8cf2_icgraph.svg" width="559" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a83f2ad5dc967c7bae287b60fddb8eb0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83f2ad5dc967c7bae287b60fddb8eb0a">&#9670;&nbsp;</a></span>test_harm_cont_h()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public helena_ops::test_harm_cont_h </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Investaige harmonic content of the HELENA variables. </p>
<dl class="section note"><dt>Note</dt><dd>Run with one process. </dd></dl>

<p class="definition">Definition at line <a class="el" href="HELENA__ops_8f90_source.html#l01485">1485</a> of file <a class="el" href="HELENA__ops_8f90_source.html">HELENA_ops.f90</a>.</p>
<div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacehelena__ops_a83f2ad5dc967c7bae287b60fddb8eb0a_cgraph.svg" width="1578" height="320"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacehelena__ops_a83f2ad5dc967c7bae287b60fddb8eb0a_icgraph.svg" width="480" height="58"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a0f156b3653264fb016d6d311eb59114c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f156b3653264fb016d6d311eb59114c">&#9670;&nbsp;</a></span>test_metrics_h()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public helena_ops::test_metrics_h </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks whether the metric elements provided by HELENA are consistent with a direct calculation using the coordinate transformations <a class="el" href="citelist.html#CITEREF_Weyens3D">[16]</a>. </p>
<p>Direct calculations used: </p><p class="formulaDsp">
\[\begin{aligned} \left|\nabla \psi\right|^2 &amp;= \frac{1}{\mathcal{J}^2} \left(\left(\frac{\partial Z}{\partial \chi}\right)^2 + \left(\frac{\partial R}{\partial \chi}\right)^2\right) \\ \left|\nabla \psi \cdot \nabla \chi\right| &amp;= \frac{1}{\mathcal{J}^2} \left( \frac{\partial Z}{\partial \chi} \frac{\partial Z}{\partial \psi} - \frac{\partial R}{\partial \chi} \frac{\partial R}{\partial \psi} \right) \\ \left|\nabla \chi\right|^2 &amp;= \frac{1}{\mathcal{J}^2} \left(\left(\frac{\partial Z}{\partial \psi}\right)^2 + \left(\frac{\partial R}{\partial \psi}\right)^2\right) \\ \left|\nabla \phi\right|^2 &amp;= \frac{1}{R^2} \end{aligned}\]
</p>
<p> with </p><p class="formulaDsp">
\[\mathcal{J} = \frac{\partial Z}{\partial \psi} \frac{\partial R}{\partial \chi} - \frac{\partial R}{\partial \psi} \frac{\partial Z}{\partial \chi}\]
</p>
<p>Also, test whether the pressure balance \(\nabla p = \vec{J}\times\vec{B} \) is satisfied.</p>
<dl class="section note"><dt>Note</dt><dd>Debug version only</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>ierr </dd></dl>

<p class="definition">Definition at line <a class="el" href="HELENA__ops_8f90_source.html#l01289">1289</a> of file <a class="el" href="HELENA__ops_8f90_source.html">HELENA_ops.f90</a>.</p>
<div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacehelena__ops_a0f156b3653264fb016d6d311eb59114c_cgraph.svg" width="1204" height="392"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacehelena__ops_a0f156b3653264fb016d6d311eb59114c_icgraph.svg" width="520" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<address class="footer"><small>
<center>this documentation was created with <a href="http://www.doxygen.org/index.html">Doxygen 1.8.13</a> by <a href="mailto:weyenst@gmail.com">Toon Weyens</a></center>
</small></address>
</body>
</html>
