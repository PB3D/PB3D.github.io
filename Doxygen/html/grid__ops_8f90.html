<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PB3D: /opt/PB3D/Modules/grid_ops.f90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PB3D
   &#160;<span id="projectnumber">[2.27]</span>
   </div>
   <div id="projectbrief">Ideal linear high-n MHD stability in 3-D</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_abd866f922fda2a610a7ae3b578a9cb5.html">PB3D</a></li><li class="navelem"><a class="el" href="dir_c08747878f0308ef1ee4ad272e6068b4.html">Modules</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#namespaces">Modules</a> &#124;
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">grid_ops.f90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a href="grid__ops_8f90_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Modules</h2></td></tr>
<tr class="memitem:namespacegrid__ops"><td class="memItemLeft" align="right" valign="top">module &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegrid__ops.html">grid_ops</a></td></tr>
<tr class="memdesc:namespacegrid__ops"><td class="mdescLeft">&#160;</td><td class="mdescRight">Operations that have to do with the grids and different coordinate systems. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a1c18f90f93f5fce7ebb4dba60b70e0f8"><td class="memItemLeft" align="right" valign="top">integer function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegrid__ops.html#a1c18f90f93f5fce7ebb4dba60b70e0f8">grid_ops::calc_norm_range</a> (style, in_limits, eq_limits, X_limits, sol_limits, r_F_eq, r_F_X, r_F_sol, jq)</td></tr>
<tr class="memdesc:a1c18f90f93f5fce7ebb4dba60b70e0f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates normal range for the input grid, the equilibrium grid and/or the solution grid.  <a href="namespacegrid__ops.html#a1c18f90f93f5fce7ebb4dba60b70e0f8">More...</a><br /></td></tr>
<tr class="separator:a1c18f90f93f5fce7ebb4dba60b70e0f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aebe21d718069318bced62bc3d2d09393"><td class="memItemLeft" align="right" valign="top">integer function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="grid__ops_8f90.html#aebe21d718069318bced62bc3d2d09393">calc_norm_range_pb3d_in</a> (in_limits)</td></tr>
<tr class="memdesc:aebe21d718069318bced62bc3d2d09393"><td class="mdescLeft">&#160;</td><td class="mdescRight">PB3D input version.  <a href="#aebe21d718069318bced62bc3d2d09393">More...</a><br /></td></tr>
<tr class="separator:aebe21d718069318bced62bc3d2d09393"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a868669b6df6c0fa6a8cedd993042f6ea"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="grid__ops_8f90.html#a868669b6df6c0fa6a8cedd993042f6ea">calc_norm_range_pb3d_eq</a> (eq_limits)</td></tr>
<tr class="memdesc:a868669b6df6c0fa6a8cedd993042f6ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">PB3D equilibrium version.  <a href="#a868669b6df6c0fa6a8cedd993042f6ea">More...</a><br /></td></tr>
<tr class="separator:a868669b6df6c0fa6a8cedd993042f6ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bd0af6203161233f7687c029d6c4ca0"><td class="memItemLeft" align="right" valign="top">integer function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="grid__ops_8f90.html#a0bd0af6203161233f7687c029d6c4ca0">calc_norm_range_pb3d_x</a> (eq_limits, X_limits, r_F_eq, r_F_X, jq)</td></tr>
<tr class="memdesc:a0bd0af6203161233f7687c029d6c4ca0"><td class="mdescLeft">&#160;</td><td class="mdescRight">PB3D perturbation version.  <a href="#a0bd0af6203161233f7687c029d6c4ca0">More...</a><br /></td></tr>
<tr class="separator:a0bd0af6203161233f7687c029d6c4ca0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9121423739548f1a1fa4e87055f49010"><td class="memItemLeft" align="right" valign="top">integer function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="grid__ops_8f90.html#a9121423739548f1a1fa4e87055f49010">calc_norm_range_pb3d_sol</a> (sol_limits, r_F_sol, n_procs)</td></tr>
<tr class="memdesc:a9121423739548f1a1fa4e87055f49010"><td class="mdescLeft">&#160;</td><td class="mdescRight">PB3D solution version.  <a href="#a9121423739548f1a1fa4e87055f49010">More...</a><br /></td></tr>
<tr class="separator:a9121423739548f1a1fa4e87055f49010"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3b47be0188da6dd19a745f796c1500f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="grid__ops_8f90.html#aa3b47be0188da6dd19a745f796c1500f">calc_norm_range_post</a> (eq_limits, X_limits, sol_limits, r_F_eq, r_F_X, r_F_sol)</td></tr>
<tr class="memdesc:aa3b47be0188da6dd19a745f796c1500f"><td class="mdescLeft">&#160;</td><td class="mdescRight">POST version.  <a href="#aa3b47be0188da6dd19a745f796c1500f">More...</a><br /></td></tr>
<tr class="separator:aa3b47be0188da6dd19a745f796c1500f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af63366847d1caa64a7d329672292fd34"><td class="memItemLeft" align="right" valign="top">integer function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegrid__ops.html#af63366847d1caa64a7d329672292fd34">grid_ops::setup_grid_eq</a> (grid_eq, eq_limits)</td></tr>
<tr class="memdesc:af63366847d1caa64a7d329672292fd34"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets up the equilibrium grid.  <a href="namespacegrid__ops.html#af63366847d1caa64a7d329672292fd34">More...</a><br /></td></tr>
<tr class="separator:af63366847d1caa64a7d329672292fd34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad16495ddd320562451c2325bafecf2d8"><td class="memItemLeft" align="right" valign="top">integer function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegrid__ops.html#ad16495ddd320562451c2325bafecf2d8">grid_ops::setup_grid_eq_b</a> (grid_eq, grid_eq_B, eq, only_half_grid)</td></tr>
<tr class="memdesc:ad16495ddd320562451c2325bafecf2d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets up the field-aligned equilibrium grid.  <a href="namespacegrid__ops.html#ad16495ddd320562451c2325bafecf2d8">More...</a><br /></td></tr>
<tr class="separator:ad16495ddd320562451c2325bafecf2d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1047889ec84da6e56aae619570a16988"><td class="memItemLeft" align="right" valign="top">integer function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegrid__ops.html#a1047889ec84da6e56aae619570a16988">grid_ops::setup_grid_x</a> (grid_eq, grid_X, r_F_X, X_limits)</td></tr>
<tr class="memdesc:a1047889ec84da6e56aae619570a16988"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets up the general perturbation grid, in which the perturbation variables are calculated.  <a href="namespacegrid__ops.html#a1047889ec84da6e56aae619570a16988">More...</a><br /></td></tr>
<tr class="separator:a1047889ec84da6e56aae619570a16988"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeff1569cb9a043b03ed49250524fbd95"><td class="memItemLeft" align="right" valign="top">integer function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegrid__ops.html#aeff1569cb9a043b03ed49250524fbd95">grid_ops::setup_grid_sol</a> (grid_eq, grid_X, grid_sol, r_F_sol, sol_limits)</td></tr>
<tr class="memdesc:aeff1569cb9a043b03ed49250524fbd95"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets up the general solution grid, in which the solution variables are calculated.  <a href="namespacegrid__ops.html#aeff1569cb9a043b03ed49250524fbd95">More...</a><br /></td></tr>
<tr class="separator:aeff1569cb9a043b03ed49250524fbd95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06107dbdfd1dd62e372cc29ab0255bad"><td class="memItemLeft" align="right" valign="top">integer function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegrid__ops.html#a06107dbdfd1dd62e372cc29ab0255bad">grid_ops::calc_ang_grid_eq_b</a> (grid_eq, eq, only_half_grid)</td></tr>
<tr class="memdesc:a06107dbdfd1dd62e372cc29ab0255bad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate equilibrium grid that follows magnetic field lines.  <a href="namespacegrid__ops.html#a06107dbdfd1dd62e372cc29ab0255bad">More...</a><br /></td></tr>
<tr class="separator:a06107dbdfd1dd62e372cc29ab0255bad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab10ef5b486ee3861df2da4e53bc22630"><td class="memItemLeft" align="right" valign="top">integer function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegrid__ops.html#ab10ef5b486ee3861df2da4e53bc22630">grid_ops::redistribute_output_grid</a> (grid, grid_out, no_outer_trim)</td></tr>
<tr class="memdesc:ab10ef5b486ee3861df2da4e53bc22630"><td class="mdescLeft">&#160;</td><td class="mdescRight">Redistribute a grid to match the normal distribution of solution grid.  <a href="namespacegrid__ops.html#ab10ef5b486ee3861df2da4e53bc22630">More...</a><br /></td></tr>
<tr class="separator:ab10ef5b486ee3861df2da4e53bc22630"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addd76b7b3be0b51e0863ae0cdfef41e6"><td class="memItemLeft" align="right" valign="top">integer function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegrid__ops.html#addd76b7b3be0b51e0863ae0cdfef41e6">grid_ops::magn_grid_plot</a> (grid)</td></tr>
<tr class="memdesc:addd76b7b3be0b51e0863ae0cdfef41e6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Plots the grid in real 3-D space.  <a href="namespacegrid__ops.html#addd76b7b3be0b51e0863ae0cdfef41e6">More...</a><br /></td></tr>
<tr class="separator:addd76b7b3be0b51e0863ae0cdfef41e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4827e794d37334c0cad9bb2016e64d46"><td class="memItemLeft" align="right" valign="top">integer function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegrid__ops.html#a4827e794d37334c0cad9bb2016e64d46">grid_ops::print_output_grid</a> (grid, grid_name, data_name, rich_lvl, par_div, remove_previous_arrs)</td></tr>
<tr class="memdesc:a4827e794d37334c0cad9bb2016e64d46"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print grid variables to an output file.  <a href="namespacegrid__ops.html#a4827e794d37334c0cad9bb2016e64d46">More...</a><br /></td></tr>
<tr class="separator:a4827e794d37334c0cad9bb2016e64d46"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ad043ab1b07b2d251bb7596b8c8d2f960"><td class="memItemLeft" align="right" valign="top">logical, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegrid__ops.html#ad043ab1b07b2d251bb7596b8c8d2f960">grid_ops::debug_calc_ang_grid_eq_b</a> = .false.</td></tr>
<tr class="memdesc:ad043ab1b07b2d251bb7596b8c8d2f960"><td class="mdescLeft">&#160;</td><td class="mdescRight">plot debug information for <a class="el" href="namespacegrid__ops.html#a06107dbdfd1dd62e372cc29ab0255bad" title="Calculate equilibrium grid that follows magnetic field lines. ">calc_ang_grid_eq_b()</a>  <a href="namespacegrid__ops.html#ad043ab1b07b2d251bb7596b8c8d2f960">More...</a><br /></td></tr>
<tr class="separator:ad043ab1b07b2d251bb7596b8c8d2f960"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a868669b6df6c0fa6a8cedd993042f6ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a868669b6df6c0fa6a8cedd993042f6ea">&#9670;&nbsp;</a></span>calc_norm_range_pb3d_eq()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine calc_norm_range::calc_norm_range_pb3d_eq </td>
          <td>(</td>
          <td class="paramtype">integer, dimension(2), intent(inout)&#160;</td>
          <td class="paramname"><em>eq_limits</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>PB3D equilibrium version. </p>
<p>The normal range is calculated by dividing the full equilibrium range passed from the input phase between the processes.</p>
<dl class="section note"><dt>Note</dt><dd>For X_style 2 (solution) or 3 (optimized), at the end of the equilibrium phase, there will be an exchange of data from each process to each process so that they all have the tightest possible fit of data of the corresponding perturbation limits.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">eq_limits</td><td>min. and max. index of eq. grid for this process </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="grid__ops_8f90_source.html#l00246">246</a> of file <a class="el" href="grid__ops_8f90_source.html">grid_ops.f90</a>.</p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="grid__ops_8f90_a868669b6df6c0fa6a8cedd993042f6ea_icgraph.svg" width="1100" height="318"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="aebe21d718069318bced62bc3d2d09393"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aebe21d718069318bced62bc3d2d09393">&#9670;&nbsp;</a></span>calc_norm_range_pb3d_in()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function calc_norm_range::calc_norm_range_pb3d_in </td>
          <td>(</td>
          <td class="paramtype">integer, dimension(2), intent(inout)&#160;</td>
          <td class="paramname"><em>in_limits</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>PB3D input version. </p>
<p>The normal range is calculated by finding the tightest range of the input variables encompassing the entire solution range. Additionally, the global max_flux variables are set as well..</p>
<dl class="section note"><dt>Note</dt><dd>This is the global, undivided range. The division information is calculated in 'eq_limits'. Furthermore, the input variables have to be tabulated on the full grid provided by the equilibrium code to be able to be used in PB3D and POST.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">in_limits</td><td>total min. and max. index of eq. grid for this process </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="grid__ops_8f90_source.html#l00137">137</a> of file <a class="el" href="grid__ops_8f90_source.html">grid_ops.f90</a>.</p>
<div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="grid__ops_8f90_aebe21d718069318bced62bc3d2d09393_icgraph.svg" width="1100" height="318"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a9121423739548f1a1fa4e87055f49010"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9121423739548f1a1fa4e87055f49010">&#9670;&nbsp;</a></span>calc_norm_range_pb3d_sol()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function calc_norm_range::calc_norm_range_pb3d_sol </td>
          <td>(</td>
          <td class="paramtype">integer, dimension(2), intent(inout)&#160;</td>
          <td class="paramname"><em>sol_limits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>r_F_sol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>n_procs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>PB3D solution version. </p>
<p>The normal range is determined by simply dividing the solution range, a ghost range is required.</p>
<p>By default, this routine uses <code>sol_n_procs</code> processes, but this can be overruled.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">sol_limits</td><td>min. and max. index of sol grid for this process</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">r_f_sol</td><td>solution r_F</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_procs</td><td>how many processes used </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="grid__ops_8f90_source.html#l00387">387</a> of file <a class="el" href="grid__ops_8f90_source.html">grid_ops.f90</a>.</p>
<div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="grid__ops_8f90_a9121423739548f1a1fa4e87055f49010_icgraph.svg" width="1355" height="318"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a0bd0af6203161233f7687c029d6c4ca0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0bd0af6203161233f7687c029d6c4ca0">&#9670;&nbsp;</a></span>calc_norm_range_pb3d_x()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function calc_norm_range::calc_norm_range_pb3d_x </td>
          <td>(</td>
          <td class="paramtype">integer, dimension(2), intent(in)&#160;</td>
          <td class="paramname"><em>eq_limits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(2), intent(inout)&#160;</td>
          <td class="paramname"><em>X_limits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>r_F_eq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(inout), allocatable&#160;</td>
          <td class="paramname"><em>r_F_X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>jq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>PB3D perturbation version. </p>
<p>The normal range is determined according to X_grid style:</p><ol type="1">
<li>taken identical to the equilibrium grid, which means that after the perturbation phase the integrated tensorial quantities have to be interpolated in <a class="el" href="namespacedriver__sol.html#af1c4ea0286ad714d3f91bb1608e4fc27" title="Interpolate tensorial perturbation quantities in the third dimension. ">interp_v()</a> in driver_sol() after having been redistributed at the start of the solution driver.</li>
<li>taken identical to the solution grid, which means that the the equilibrium quantities have to be interpolated in <a class="el" href="namespacex__ops.html#a4e39701da15ff952add5133db1897b52" title="Calculate ,  or , . ">calc_u()</a>, <a class="el" href="namespacex__ops.html#a045e8903230dfa0fb8b89b458d0c8ee2" title="calculate  (pol. flux) or  (tor. flux) at all equilibrium loc_n_r values. ">calc_kv()</a> and <a class="el" href="namespacex__ops.html#a51f3bf0b4c8d688ffbcc3a1adbca9762" title="calculate  (pol. flux) or  (tor. flux) at all equilibrium loc_n_r values. ">calc_pv()</a> after having been redistributed at the end of the equilibrium driver.</li>
<li>by considering an optimal interpolation extension of the equilibrium range, adding intermediairy points between grid points where the safety factor changes too quickly, according to the variable 'max_njq_change'. This uses <code>prim_X</code>.</li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">eq_limits</td><td>min. and max. index of eq grid for this process</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">x_limits</td><td>min. and max. index of X grid for this process</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r_f_eq</td><td>equilibrium r_F</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">r_f_x</td><td>perturbation r_F</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jq</td><td>q_saf (pol. flux) or rot_t (tor. flux) in total Flux variables </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="grid__ops_8f90_source.html#l00285">285</a> of file <a class="el" href="grid__ops_8f90_source.html">grid_ops.f90</a>.</p>
<div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="grid__ops_8f90_a0bd0af6203161233f7687c029d6c4ca0_cgraph.svg" width="1387" height="464"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="grid__ops_8f90_a0bd0af6203161233f7687c029d6c4ca0_icgraph.svg" width="1092" height="318"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="aa3b47be0188da6dd19a745f796c1500f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3b47be0188da6dd19a745f796c1500f">&#9670;&nbsp;</a></span>calc_norm_range_post()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine calc_norm_range::calc_norm_range_post </td>
          <td>(</td>
          <td class="paramtype">integer, dimension(2), intent(inout)&#160;</td>
          <td class="paramname"><em>eq_limits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(2), intent(inout)&#160;</td>
          <td class="paramname"><em>X_limits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(2), intent(inout)&#160;</td>
          <td class="paramname"><em>sol_limits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>r_F_eq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>r_F_X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>r_F_sol</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>POST version. </p>
<p>The normal range is determined by simply dividing a possible subset of the solution range, indicated by <code>min_r_plot</code> and <code>max_r_sol</code>, including a ghost range and getting a bounding equilibrium and perturbation range.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">eq_limits</td><td>min. and max. index of eq grid for this process</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">x_limits</td><td>min. and max. index of X grid for this process</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">sol_limits</td><td>min. and max. index of sol grid for this process</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r_f_eq</td><td>eq r_F</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r_f_x</td><td>X r_F</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r_f_sol</td><td>sol r_F </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="grid__ops_8f90_source.html#l00452">452</a> of file <a class="el" href="grid__ops_8f90_source.html">grid_ops.f90</a>.</p>
<div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="grid__ops_8f90_aa3b47be0188da6dd19a745f796c1500f_cgraph.svg" width="424" height="58"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="grid__ops_8f90_aa3b47be0188da6dd19a745f796c1500f_icgraph.svg" width="1076" height="318"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<address class="footer"><small>
<center>this documentation was created with <a href="http://www.doxygen.org/index.html">Doxygen 1.8.13</a> by <a href="mailto:weyenst@gmail.com">Toon Weyens</a></center>
</small></address>
</body>
</html>
