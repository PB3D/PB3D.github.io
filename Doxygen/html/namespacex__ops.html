<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.16.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PB3D: x_ops Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PB3D<span id="projectnumber">&#160;[2.47]</span>
   </div>
   <div id="projectbrief">Ideal linear high-n MHD stability in 3-D</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.16.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Interfaces and Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">x_ops Module Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Operations considering perturbation quantities.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-nested-classes" class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Interfaces and Types</h2></td></tr>
<tr class="memitem:calc_5Fx" id="r_calc_5Fx"><td class="memItemLeft">interface &#160;</td><td class="memItemRight"><a class="el" href="interfacex__ops_1_1calc__x.html">calc_x</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates either vectorial or tensorial perturbation variables.  <a href="interfacex__ops_1_1calc__x.html#details">More...</a><br /></td></tr>
<tr class="memitem:redistribute_5Foutput_5Fx" id="r_redistribute_5Foutput_5Fx"><td class="memItemLeft">interface &#160;</td><td class="memItemRight"><a class="el" href="interfacex__ops_1_1redistribute__output__x.html">redistribute_output_x</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Redistribute the perturbation variables.  <a href="interfacex__ops_1_1redistribute__output__x.html#details">More...</a><br /></td></tr>
<tr class="memitem:print_5Foutput_5Fx" id="r_print_5Foutput_5Fx"><td class="memItemLeft">interface &#160;</td><td class="memItemRight"><a class="el" href="interfacex__ops_1_1print__output__x.html">print_output_x</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print either vectorial or tensorial perturbation quantities of a certain order to an output file.  <a href="interfacex__ops_1_1print__output__x.html#details">More...</a><br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a73a80c582379669f8e07b09dd7456878" id="r_a73a80c582379669f8e07b09dd7456878"><td class="memItemLeft">integer function, public&#160;</td><td class="memItemRight"><a class="el" href="#a73a80c582379669f8e07b09dd7456878">init_modes</a> (grid_eq, eq)</td></tr>
<tr class="memdesc:a73a80c582379669f8e07b09dd7456878"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes some variables concerning the mode numbers.  <br /></td></tr>
<tr class="memitem:a640d64aeae8a574eb05f164c1bdad3bd" id="r_a640d64aeae8a574eb05f164c1bdad3bd"><td class="memItemLeft">integer function, public&#160;</td><td class="memItemRight"><a class="el" href="#a640d64aeae8a574eb05f164c1bdad3bd">setup_modes</a> (mds, grid_eq, grid, plot_name)</td></tr>
<tr class="memdesc:a640d64aeae8a574eb05f164c1bdad3bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets up some variables concerning the mode numbers.  <br /></td></tr>
<tr class="memitem:a7d9275e2d927d92548416f21b983b604" id="r_a7d9275e2d927d92548416f21b983b604"><td class="memItemLeft">integer function, public&#160;</td><td class="memItemRight"><a class="el" href="#a7d9275e2d927d92548416f21b983b604">check_x_modes</a> (grid_eq, eq)</td></tr>
<tr class="memdesc:a7d9275e2d927d92548416f21b983b604"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks whether the high-n approximation is valid:  <br /></td></tr>
<tr class="memitem:a1a90026bbbeddc25e82cfdd304df251f" id="r_a1a90026bbbeddc25e82cfdd304df251f"><td class="memItemLeft">integer function, public&#160;</td><td class="memItemRight"><a class="el" href="#a1a90026bbbeddc25e82cfdd304df251f">calc_res_surf</a> (mds, grid_eq, eq, res_surf, info, jq)</td></tr>
<tr class="memdesc:a1a90026bbbeddc25e82cfdd304df251f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates resonating flux surfaces for the perturbation modes.  <br /></td></tr>
<tr class="memitem:abdaf1308e13cede3a153e8c6cf35a637" id="r_abdaf1308e13cede3a153e8c6cf35a637"><td class="memItemLeft">integer function, public&#160;</td><td class="memItemRight"><a class="el" href="#abdaf1308e13cede3a153e8c6cf35a637">resonance_plot</a> (mds, grid_eq, eq)</td></tr>
<tr class="memdesc:abdaf1308e13cede3a153e8c6cf35a637"><td class="mdescLeft">&#160;</td><td class="mdescRight">plot \(q\)-profile or \(\iota\)-profile in flux coordinates with \(nq-m = 0\) or \(n-\iota m = 0\) indicated if requested.  <br /></td></tr>
<tr class="memitem:afbb67819a435e90b45b5986ab065d55c" id="r_afbb67819a435e90b45b5986ab065d55c"><td class="memItemLeft">integer function, public&#160;</td><td class="memItemRight"><a class="el" href="#afbb67819a435e90b45b5986ab065d55c">calc_magn_ints</a> (grid_eq, grid_x, eq, x, x_int, prev_style, lim_sec_x)</td></tr>
<tr class="memdesc:afbb67819a435e90b45b5986ab065d55c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the magnetic integrals from \(\widetilde{PV}_{k,m}^i\) and \(\widetilde{KV}_{k,m}^i\) in an equidistant grid where the step size can vary depending on the normal coordinate.  <br /></td></tr>
<tr class="memitem:a677c88d85fe1bfbf3579a2421ce16f2f" id="r_a677c88d85fe1bfbf3579a2421ce16f2f"><td class="memItemLeft">integer function, public&#160;</td><td class="memItemRight"><a class="el" href="#a677c88d85fe1bfbf3579a2421ce16f2f">divide_x_jobs</a> (arr_size)</td></tr>
<tr class="memdesc:a677c88d85fe1bfbf3579a2421ce16f2f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Divides the perturbation jobs.  <br /></td></tr>
<tr class="memitem:a749acd00c1dd08da16d9bbce94422656" id="r_a749acd00c1dd08da16d9bbce94422656"><td class="memItemLeft">integer function, public&#160;</td><td class="memItemRight"><a class="el" href="#a749acd00c1dd08da16d9bbce94422656">print_debug_x_1</a> (mds, grid_x, x_1)</td></tr>
<tr class="memdesc:a749acd00c1dd08da16d9bbce94422656"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints debug information for X_1 driver.  <br /></td></tr>
<tr class="memitem:ad7b07e5851eb44994a384363c86f35d6" id="r_ad7b07e5851eb44994a384363c86f35d6"><td class="memItemLeft">integer function, public&#160;</td><td class="memItemRight"><a class="el" href="#ad7b07e5851eb44994a384363c86f35d6">print_debug_x_2</a> (mds, grid_x, x_2_int)</td></tr>
<tr class="memdesc:ad7b07e5851eb44994a384363c86f35d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints debug information for X_2 driver.  <br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-var-members" class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a342c624ea5f9a15264c78767da34684c" id="r_a342c624ea5f9a15264c78767da34684c"><td class="memItemLeft">logical, public&#160;</td><td class="memItemRight"><a class="el" href="#a342c624ea5f9a15264c78767da34684c">debug_check_x_modes_2</a> = .false.</td></tr>
<tr class="memdesc:a342c624ea5f9a15264c78767da34684c"><td class="mdescLeft">&#160;</td><td class="mdescRight">plot debug information for check_x_modes_2()  <br /></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Operations considering perturbation quantities. </p>
</div><a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function/Subroutine Documentation</h2>
<a id="afbb67819a435e90b45b5986ab065d55c" name="afbb67819a435e90b45b5986ab065d55c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afbb67819a435e90b45b5986ab065d55c">&#9670;&#160;</a></span>calc_magn_ints()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public x_ops::calc_magn_ints </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structgrid__vars_1_1grid__type.html">grid_type</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>grid_eq</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structgrid__vars_1_1grid__type.html">grid_type</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>grid_x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structeq__vars_1_1eq__2__type.html">eq_2_type</a>), intent(in), target</td>          <td class="paramname"><span class="paramname"><em>eq</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structx__vars_1_1x__2__type.html">x_2_type</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structx__vars_1_1x__2__type.html">x_2_type</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>x_int</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional</td>          <td class="paramname"><span class="paramname"><em>prev_style</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(2,2), intent(in), optional</td>          <td class="paramname"><span class="paramname"><em>lim_sec_x</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the magnetic integrals from \(\widetilde{PV}_{k,m}^i\) and \(\widetilde{KV}_{k,m}^i\) in an equidistant grid where the step size can vary depending on the normal coordinate. </p>
<p>All the variables should thus be field-line oriented. The result is saved in the first index of the X variables, the other can be ignored.</p>
<p>Using <code>prev_style</code>, the results of this calculation on X can be combined with the ones already present in <code>X_int</code>.</p><ul>
<li><code>prev_style=0</code>: Overwrite [def].</li>
<li><code>prev_style=1</code>: Add to current integral.</li>
<li><code>prev_style=2</code>: Divide by 2 and add to current integral. Also modify the indices of the current integral:<ul>
<li>for <code>magn_int_style</code> = 1: <span class="tt">1 2 2 2 2 2 1 -&gt; 2 2 2 2 2 2</span>,</li>
<li>for <code>magn_int_style</code> = 2: <span class="tt">1 3 3 2 3 3 1 -&gt; 3 2 3 3 2 3</span>.</li>
</ul>
</li>
<li><code>prev_style=3</code>: Add to current integral. Also modify the indices of the current integral as in <code>prev_style</code> = 2.</li>
<li>else: ignore previous magnetic integrals.</li>
</ul>
<p>Therefore, it is to be used in order. For example:</p><ol type="1">
<li>\(\phantom{\rightarrow}\) (R=1,E=1): style 0,</li>
<li>\(\rightarrow\) (R=1,E=2): style 1,</li>
<li>\(\rightarrow\) (R=2,E=1): style 2,</li>
<li>\(\rightarrow\) (R=2,E=2): style 3.</li>
</ol>
<p>Afterwards, it would cycle through 2 and 3, as style 0 and 1 are only for the first Richardson level.</p>
<dl class="section note"><dt>Note</dt><dd><ol type="1">
<li>The variable type for the integrated tensorial perturbation variables is also <code>X_2</code>, but it is assumed that the first index has dimension 1, the rest is ignored.</li>
<li>Simpson's 3/8 rule converges faster than the trapezoidal rule, but normally needs a better starting point (i.e. higher <code>min_n_par_X</code>)</li>
<li>For alpha style 1, Weyl's lemma is used to convert the surface integral into a line integral along the magnetic field. This means that the resulting line integral still needs to be multiplied by \(\frac{2\pi}{M}\), where \(M\) is the number of times the poloidal or toroidal angle completes a full \(2\pi\) tour, depending on <code>use_pol_flux_F</code> <a class="el" href="citelist.html#CITEREF_helander2014">[6]</a>.</li>
<li>For alpha style 2, this factor is just the step size in alpha.</li>
</ol>
</dd></dl>
<dl class="section see"><dt>See also</dt><dd>See <a class="el" href="structx__vars_1_1x__2__type.html" title="tensorial perturbation type">x_vars.x_2_type</a>.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>ierr </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">grid_eq</td><td>equilibrium grid </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid_x</td><td>perturbation grid </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eq</td><td>metric equilibrium </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>tensorial perturbation variables </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">x_int</td><td>interpolated tensorial perturbation variables, containing all mode combinations </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">prev_style</td><td>style to treat X_prev </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lim_sec_x</td><td>limits of <code>m_X</code> (pol flux) or <code>n_X</code> (tor flux) for both dimensions </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="X__ops_8f90_source.html#l03079">3079</a> of file <a class="el" href="X__ops_8f90_source.html">X_ops.f90</a>.</p>
<div id="dynsection-0" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;"><span class="dynarrow"><span class="arrowhead closed"></span></span>Here is the call graph for this function:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" loading="lazy" frameborder="0" src="namespacex__ops_afbb67819a435e90b45b5986ab065d55c_cgraph.svg" width="486" height="115"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-1" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;"><span class="dynarrow"><span class="arrowhead closed"></span></span>Here is the caller graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" loading="lazy" frameborder="0" src="namespacex__ops_afbb67819a435e90b45b5986ab065d55c_icgraph.svg" width="611" height="39"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a1a90026bbbeddc25e82cfdd304df251f" name="a1a90026bbbeddc25e82cfdd304df251f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a90026bbbeddc25e82cfdd304df251f">&#9670;&#160;</a></span>calc_res_surf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public x_ops::calc_res_surf </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structx__vars_1_1modes__type.html">modes_type</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mds</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structgrid__vars_1_1grid__type.html">grid_type</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>grid_eq</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structeq__vars_1_1eq__1__type.html">eq_1_type</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>eq</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:,:), intent(inout), allocatable</td>          <td class="paramname"><span class="paramname"><em>res_surf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional</td>          <td class="paramname"><span class="paramname"><em>info</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(inout), optional, allocatable</td>          <td class="paramname"><span class="paramname"><em>jq</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates resonating flux surfaces for the perturbation modes. </p>
<p>The output consists of mode number, resonating normal position and the fraction \(\frac{m}{n}\) or \(\frac{n}{m}\). for those modes for which a solution is found that is within the plasma range.</p>
<p>It contains three pieces of information:</p><ul>
<li><span class="tt">(:,1)</span>: the mode index</li>
<li><span class="tt">(:,2)</span>: the radial position in Flux coordinates</li>
<li><span class="tt">(:,3)</span>: the fraction \(\frac{m}{n}\) or \(\frac{n}{m}\)</li>
</ul>
<p>for every single mode in <code>sec</code> of <code>mds</code>, which can be tabulated in an arbitrary grid, not necessarily the equilibrium one.</p>
<p>Optionally, the total safety factor or rotational transform can be returned to the master.</p>
<p>Also, information can be displayed with info.</p>
<dl class="section return"><dt>Returns</dt><dd>ierr </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mds</td><td>general modes variables </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid_eq</td><td>equilibrium grid_eq </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eq</td><td>flux equilibrium </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">res_surf</td><td>resonant surface </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">info</td><td>if info is displayed </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">jq</td><td>either safety factor or rotational transform </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="X__ops_8f90_source.html#l01637">1637</a> of file <a class="el" href="X__ops_8f90_source.html">X_ops.f90</a>.</p>
<div id="dynsection-2" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;"><span class="dynarrow"><span class="arrowhead closed"></span></span>Here is the call graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" loading="lazy" frameborder="0" src="namespacex__ops_a1a90026bbbeddc25e82cfdd304df251f_cgraph.svg" width="952" height="335"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-3" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;"><span class="dynarrow"><span class="arrowhead closed"></span></span>Here is the caller graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" loading="lazy" frameborder="0" src="namespacex__ops_a1a90026bbbeddc25e82cfdd304df251f_icgraph.svg" width="840" height="91"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a7d9275e2d927d92548416f21b983b604" name="a7d9275e2d927d92548416f21b983b604"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d9275e2d927d92548416f21b983b604">&#9670;&#160;</a></span>check_x_modes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public x_ops::check_x_modes </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structgrid__vars_1_1grid__type.html">grid_type</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>grid_eq</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structeq__vars_1_1eq__1__type.html">eq_1_type</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>eq</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks whether the high-n approximation is valid: </p>
<p>This depends on the <code>X_style:</code> </p>
<p>For X_style 1 (prescribed): every mode should resonate at least somewhere in the whole normal range:</p><ul>
<li>\(\frac{\left|nq-m\right|}{\left|n\right|} &lt; T\) and \(\frac{\left|nq-m\right|}{\left|m\right|} &lt; T\) for poloidal flux</li>
<li>\(\frac{\left|q-\iota m\right|}{\left|m\right|} &lt; T\) and \(\frac{\left|n-\iota m\right|}{\left|n\right|} &lt; T\) for toroidal flux</li>
</ul>
<p>where \(T\) = <code>tol</code> &lt;&lt; 1.</p>
<p>This condition is determined by the sign of \(q\) (or \(\iota\)) and given by:</p><ul>
<li>\(\max\left(q_\text{min}-T,\frac{q_\text{min}}{1+T}\right) &lt;
             \frac{m}{n} &lt;
             \min\left(q_\text{max}+T,\frac{q_\text{max}}{1-T}\right)\), \(q&gt;0\)</li>
<li>\(\max\left(q_\text{min}-T,\frac{q_\text{min}}{1-T}\right) &lt;
             \frac{m}{n} &lt;
             \min\left(q_\text{max}+T,\frac{q_\text{max}}{1+T}\right)\), \(q&lt;0\)</li>
</ul>
<p>for poloidal flux.</p>
<p>For toroidal flux, \(q\) should be replaced by \(\iota\) and \(\frac{m}{n}\) by \(\frac{n}{m}\).</p>
<p>For <code>X_style</code> 2 (fast): the resonance has been taken care of, but it remains to be checked whether the number of modes is efficient.</p>
<dl class="section return"><dt>Returns</dt><dd>ierr </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">grid_eq</td><td>equilibrium grid </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eq</td><td>flux equilibrium </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="X__ops_8f90_source.html#l01349">1349</a> of file <a class="el" href="X__ops_8f90_source.html">X_ops.f90</a>.</p>
<div id="dynsection-4" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;"><span class="dynarrow"><span class="arrowhead closed"></span></span>Here is the call graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" loading="lazy" frameborder="0" src="namespacex__ops_a7d9275e2d927d92548416f21b983b604_cgraph.svg" width="1174" height="499"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-5" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;"><span class="dynarrow"><span class="arrowhead closed"></span></span>Here is the caller graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" loading="lazy" frameborder="0" src="namespacex__ops_a7d9275e2d927d92548416f21b983b604_icgraph.svg" width="603" height="39"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a677c88d85fe1bfbf3579a2421ce16f2f" name="a677c88d85fe1bfbf3579a2421ce16f2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a677c88d85fe1bfbf3579a2421ce16f2f">&#9670;&#160;</a></span>divide_x_jobs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public x_ops::divide_x_jobs </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)</td>          <td class="paramname"><span class="paramname"><em>arr_size</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Divides the perturbation jobs. </p>
<p>This concerns the calculation of the magnetic integrals of blocks of tensorial perturbation variables. These are set up using the equilibrium and vectorial perturbation variables that are stored in memory, but only the integrated tensorial result is stored in memory, with negligible variables size.</p>
<p>The size of the (k,m) pairs to be calculated is determined by looking at what fits in memory when the equilibrium and vectorial perturbation variables are stored in memory first.</p>
<dl class="section return"><dt>Returns</dt><dd>ierr </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">arr_size</td><td>array size (using loc_n_r) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="X__ops_8f90_source.html#l03363">3363</a> of file <a class="el" href="X__ops_8f90_source.html">X_ops.f90</a>.</p>
<div id="dynsection-6" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;"><span class="dynarrow"><span class="arrowhead closed"></span></span>Here is the call graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" loading="lazy" frameborder="0" src="namespacex__ops_a677c88d85fe1bfbf3579a2421ce16f2f_cgraph.svg" width="1110" height="115"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-7" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;"><span class="dynarrow"><span class="arrowhead closed"></span></span>Here is the caller graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" loading="lazy" frameborder="0" src="namespacex__ops_a677c88d85fe1bfbf3579a2421ce16f2f_icgraph.svg" width="603" height="39"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a73a80c582379669f8e07b09dd7456878" name="a73a80c582379669f8e07b09dd7456878"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73a80c582379669f8e07b09dd7456878">&#9670;&#160;</a></span>init_modes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public x_ops::init_modes </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structgrid__vars_1_1grid__type.html">grid_type</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>grid_eq</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structeq__vars_1_1eq__1__type.html">eq_1_type</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>eq</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes some variables concerning the mode numbers. </p>
<p>Setup minimum and maximum of mode numbers at every flux surface in equilibrium coordinates</p><ul>
<li><code>min_n_X</code>, <code>max_n_X</code> </li>
<li><code>min_m_X</code>, <code>max_m_X</code>,</li>
</ul>
<p>It functions depending on the <code>X_style</code> used: 1 (prescribed) or 2 (fast). For the fast style, at every flux surface the range of modes is sought that resonates most:</p><ul>
<li>\(m = nq \pm \frac{N}{2}\) for poloidal flux</li>
<li>\(n = \iota m \pm \frac{N}{2}\) for toroidal flux</li>
</ul>
<p>where \(N\) = <code>n_mod_X</code>.</p>
<p>However, at the same time, both <code>m</code> and <code>n</code> have to be larger, in absolute value, than <code>min_sec_X</code>. Therefore, the range of width <code>n_mod_X</code> can be shifted upwards.</p>
<dl class="section return"><dt>Returns</dt><dd>ierr </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">grid_eq</td><td>equilibrium grid </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eq</td><td>flux equilibrium </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="X__ops_8f90_source.html#l00918">918</a> of file <a class="el" href="X__ops_8f90_source.html">X_ops.f90</a>.</p>
<div id="dynsection-8" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;"><span class="dynarrow"><span class="arrowhead closed"></span></span>Here is the call graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" loading="lazy" frameborder="0" src="namespacex__ops_a73a80c582379669f8e07b09dd7456878_cgraph.svg" width="880" height="154"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-9" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;"><span class="dynarrow"><span class="arrowhead closed"></span></span>Here is the caller graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" loading="lazy" frameborder="0" src="namespacex__ops_a73a80c582379669f8e07b09dd7456878_icgraph.svg" width="824" height="192"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a749acd00c1dd08da16d9bbce94422656" name="a749acd00c1dd08da16d9bbce94422656"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a749acd00c1dd08da16d9bbce94422656">&#9670;&#160;</a></span>print_debug_x_1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public x_ops::print_debug_x_1 </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structx__vars_1_1modes__type.html">modes_type</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mds</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structgrid__vars_1_1grid__type.html">grid_type</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>grid_x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structx__vars_1_1x__1__type.html">x_1_type</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>x_1</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prints debug information for X_1 driver. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mds</td><td>general modes variables </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid_x</td><td>perturbation grid </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x_1</td><td>vectorial X variables </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="X__ops_8f90_source.html#l03489">3489</a> of file <a class="el" href="X__ops_8f90_source.html">X_ops.f90</a>.</p>
<div id="dynsection-10" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;"><span class="dynarrow"><span class="arrowhead closed"></span></span>Here is the call graph for this function:</div>
<div id="dynsection-10-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-10-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" loading="lazy" frameborder="0" src="namespacex__ops_a749acd00c1dd08da16d9bbce94422656_cgraph.svg" width="478" height="39"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-11" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;"><span class="dynarrow"><span class="arrowhead closed"></span></span>Here is the caller graph for this function:</div>
<div id="dynsection-11-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-11-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" loading="lazy" frameborder="0" src="namespacex__ops_a749acd00c1dd08da16d9bbce94422656_icgraph.svg" width="619" height="39"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ad7b07e5851eb44994a384363c86f35d6" name="ad7b07e5851eb44994a384363c86f35d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7b07e5851eb44994a384363c86f35d6">&#9670;&#160;</a></span>print_debug_x_2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public x_ops::print_debug_x_2 </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structx__vars_1_1modes__type.html">modes_type</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mds</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structgrid__vars_1_1grid__type.html">grid_type</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>grid_x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structx__vars_1_1x__2__type.html">x_2_type</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>x_2_int</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prints debug information for X_2 driver. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mds</td><td>general modes variables </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid_x</td><td>perturbation grid </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x_2_int</td><td>tensorial X variables </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="X__ops_8f90_source.html#l03632">3632</a> of file <a class="el" href="X__ops_8f90_source.html">X_ops.f90</a>.</p>
<div id="dynsection-12" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;"><span class="dynarrow"><span class="arrowhead closed"></span></span>Here is the call graph for this function:</div>
<div id="dynsection-12-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-12-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" loading="lazy" frameborder="0" src="namespacex__ops_ad7b07e5851eb44994a384363c86f35d6_cgraph.svg" width="478" height="115"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-13" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;"><span class="dynarrow"><span class="arrowhead closed"></span></span>Here is the caller graph for this function:</div>
<div id="dynsection-13-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-13-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" loading="lazy" frameborder="0" src="namespacex__ops_ad7b07e5851eb44994a384363c86f35d6_icgraph.svg" width="651" height="91"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="abdaf1308e13cede3a153e8c6cf35a637" name="abdaf1308e13cede3a153e8c6cf35a637"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abdaf1308e13cede3a153e8c6cf35a637">&#9670;&#160;</a></span>resonance_plot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public x_ops::resonance_plot </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structx__vars_1_1modes__type.html">modes_type</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mds</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structgrid__vars_1_1grid__type.html">grid_type</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>grid_eq</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structeq__vars_1_1eq__1__type.html">eq_1_type</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>eq</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>plot \(q\)-profile or \(\iota\)-profile in flux coordinates with \(nq-m = 0\) or \(n-\iota m = 0\) indicated if requested. </p>
<p>The plot will be done in the grid in which <code>mds</code> is tabulated, which is not necessarily the equilibrium one.</p>
<dl class="section return"><dt>Returns</dt><dd>ierr </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mds</td><td>general modes variables </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid_eq</td><td>equilibrium grid </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eq</td><td>flux equilibrium </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="X__ops_8f90_source.html#l01813">1813</a> of file <a class="el" href="X__ops_8f90_source.html">X_ops.f90</a>.</p>
<div id="dynsection-14" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;"><span class="dynarrow"><span class="arrowhead closed"></span></span>Here is the call graph for this function:</div>
<div id="dynsection-14-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-14-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" loading="lazy" frameborder="0" src="namespacex__ops_abdaf1308e13cede3a153e8c6cf35a637_cgraph.svg" width="1262" height="818"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-15" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;"><span class="dynarrow"><span class="arrowhead closed"></span></span>Here is the caller graph for this function:</div>
<div id="dynsection-15-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-15-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" loading="lazy" frameborder="0" src="namespacex__ops_abdaf1308e13cede3a153e8c6cf35a637_icgraph.svg" width="611" height="91"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a640d64aeae8a574eb05f164c1bdad3bd" name="a640d64aeae8a574eb05f164c1bdad3bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a640d64aeae8a574eb05f164c1bdad3bd">&#9670;&#160;</a></span>setup_modes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public x_ops::setup_modes </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structx__vars_1_1modes__type.html">modes_type</a>), intent(inout), target</td>          <td class="paramname"><span class="paramname"><em>mds</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structgrid__vars_1_1grid__type.html">grid_type</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>grid_eq</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structgrid__vars_1_1grid__type.html">grid_type</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>grid</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in), optional</td>          <td class="paramname"><span class="paramname"><em>plot_name</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets up some variables concerning the mode numbers. </p>
<p>Apart from the mode numbers</p><ul>
<li><code>n</code>, <code>m</code>,</li>
</ul>
<p>also the variables of the secondary modes</p><ul>
<li>sec,</li>
</ul>
<p>are set up in the coordinates of the grid passed. The normal values of this grid are saved as well, in</p><ul>
<li>r_F.</li>
</ul>
<p>All variables are tabulated in the full normal grid. The mode indices, however, are chosen so that there is maximum overlap between different normal positions. This is trivial for <code>X_style</code> 1 (prescribed), but for <code>X_style</code> 2 (fast), this is best explained by an example:</p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md8"></a>
kd m1 m2 m3</h2>
<p>1 10 11 12 &lt;- start 2 10 11 12 &lt;- no change in limits 2 13 11 12 &lt;- limits shift up by one 3 13 11 12 &lt;- no change in limits 4 13 14 12 &lt;- limits shift up by one 5 16 14 15 &lt;- limits shift up by two 6 13 14 15 &lt;- limits shift down by one</p>
<p>This procedure makes use of the global variables</p><ul>
<li><code>min_m_X</code>, max_m_X, min_n_X, max_m_X</li>
</ul>
<p>that have to be set up using init_nm_x().</p>
<p>Optionally, <code>n</code> and <code>m</code> can be plot.</p>
<dl class="section return"><dt>Returns</dt><dd>ierr </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">mds</td><td>modes variables </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid_eq</td><td>equilibrium grid </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid</td><td>grid at which to calculate modes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">plot_name</td><td>name to be used when plotting <code>n</code> and <code>m</code> </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="X__ops_8f90_source.html#l01059">1059</a> of file <a class="el" href="X__ops_8f90_source.html">X_ops.f90</a>.</p>
<div id="dynsection-16" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;"><span class="dynarrow"><span class="arrowhead closed"></span></span>Here is the call graph for this function:</div>
<div id="dynsection-16-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-16-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" loading="lazy" frameborder="0" src="namespacex__ops_a640d64aeae8a574eb05f164c1bdad3bd_cgraph.svg" width="1158" height="422"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-17" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;"><span class="dynarrow"><span class="arrowhead closed"></span></span>Here is the caller graph for this function:</div>
<div id="dynsection-17-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-17-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" loading="lazy" frameborder="0" src="namespacex__ops_a640d64aeae8a574eb05f164c1bdad3bd_icgraph.svg" width="864" height="243"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a name="doc-var-members" id="doc-var-members"></a><h2 id="header-doc-var-members" class="groupheader">Variable Documentation</h2>
<a id="a342c624ea5f9a15264c78767da34684c" name="a342c624ea5f9a15264c78767da34684c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a342c624ea5f9a15264c78767da34684c">&#9670;&#160;</a></span>debug_check_x_modes_2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical, public x_ops::debug_check_x_modes_2 = .false.</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>plot debug information for check_x_modes_2() </p>
<dl class="section note"><dt>Note</dt><dd>Debug version only </dd></dl>

<p class="definition">Definition at line <a class="el" href="X__ops_8f90_source.html#l00026">26</a> of file <a class="el" href="X__ops_8f90_source.html">X_ops.f90</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<address class="footer"><small>
<center>this documentation was created with <a href="http://www.doxygen.org/index.html">Doxygen 1.16.1</a> by <a href="mailto:weyenst@gmail.com">Toon Weyens</a></center>
</small></address>
</body>
</html>
