<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PB3D: vac_ops Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PB3D
   &#160;<span id="projectnumber">[2.43]</span>
   </div>
   <div id="projectbrief">Ideal linear high-n MHD stability in 3-D</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">vac_ops Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Operations and variables pertaining to the vacuum response.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a37220702fbf378626a0f2c12f446e0aa"><td class="memItemLeft" align="right" valign="top">integer function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevac__ops.html#a37220702fbf378626a0f2c12f446e0aa">store_vac</a> (grid, eq_1, eq_2, vac)</td></tr>
<tr class="memdesc:a37220702fbf378626a0f2c12f446e0aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stores calculation of the vacuum response by storing the necessary variables.  <a href="#a37220702fbf378626a0f2c12f446e0aa">More...</a><br /></td></tr>
<tr class="separator:a37220702fbf378626a0f2c12f446e0aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e3f92fbe9fa6cf3de6ac301676b96d1"><td class="memItemLeft" align="right" valign="top">integer function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevac__ops.html#a7e3f92fbe9fa6cf3de6ac301676b96d1">calc_gh</a> (vac, n_r_in, lims_r_in, x_vec_in, G_in, H_in)</td></tr>
<tr class="memdesc:a7e3f92fbe9fa6cf3de6ac301676b96d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the matrices <code>G</code> and <code>H</code>.  <a href="#a7e3f92fbe9fa6cf3de6ac301676b96d1">More...</a><br /></td></tr>
<tr class="separator:a7e3f92fbe9fa6cf3de6ac301676b96d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a267742c3c9a1b395aee76527d1e8352c"><td class="memItemLeft" align="right" valign="top">integer function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevac__ops.html#a267742c3c9a1b395aee76527d1e8352c">calc_gh_1</a> (vac, n_r_in, lims_r_in, x_vec_in, G_in, H_in, ext_in)</td></tr>
<tr class="memdesc:a267742c3c9a1b395aee76527d1e8352c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates matrices <code>G</code> and <code>H</code> in 3-D configuration.  <a href="#a267742c3c9a1b395aee76527d1e8352c">More...</a><br /></td></tr>
<tr class="separator:a267742c3c9a1b395aee76527d1e8352c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4987d1f48f1f83b1f0d38ea85b4998b"><td class="memItemLeft" align="right" valign="top">integer function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevac__ops.html#ae4987d1f48f1f83b1f0d38ea85b4998b">calc_gh_2</a> (vac, n_r_in, lims_r_in, x_vec_in, G_in, H_in, ext_in)</td></tr>
<tr class="memdesc:ae4987d1f48f1f83b1f0d38ea85b4998b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates matrices <code>G</code> and <code>H</code> in axisymmetric configurations.  <a href="#ae4987d1f48f1f83b1f0d38ea85b4998b">More...</a><br /></td></tr>
<tr class="separator:ae4987d1f48f1f83b1f0d38ea85b4998b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e5a8322b3aa2e3704b1050426f06d9d"><td class="memItemLeft" align="right" valign="top">integer function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevac__ops.html#a5e5a8322b3aa2e3704b1050426f06d9d">calc_vac_res</a> (mds, vac)</td></tr>
<tr class="memdesc:a5e5a8322b3aa2e3704b1050426f06d9d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the vacuum response.  <a href="#a5e5a8322b3aa2e3704b1050426f06d9d">More...</a><br /></td></tr>
<tr class="separator:a5e5a8322b3aa2e3704b1050426f06d9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a2a3aed45951aecef42197b82a5a6da"><td class="memItemLeft" align="right" valign="top">integer function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevac__ops.html#a3a2a3aed45951aecef42197b82a5a6da">vac_pot_plot</a> (grid_sol, vac, sol, X_id)</td></tr>
<tr class="memdesc:a3a2a3aed45951aecef42197b82a5a6da"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate vacuum potential at some positions that are not resonant.  <a href="#a3a2a3aed45951aecef42197b82a5a6da">More...</a><br /></td></tr>
<tr class="separator:a3a2a3aed45951aecef42197b82a5a6da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace79efa50ae5a120e515164c99ce9582"><td class="memItemLeft" align="right" valign="top">integer function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevac__ops.html#ace79efa50ae5a120e515164c99ce9582">solve_phi_bem</a> (vac, R, Phi, n_RPhi, n_loc_RPhi, lims_c_RPhi, desc_RPhi)</td></tr>
<tr class="memdesc:ace79efa50ae5a120e515164c99ce9582"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates potential <code>Phi</code> on boundary of BEM in terms of some right-hand side .  <a href="#ace79efa50ae5a120e515164c99ce9582">More...</a><br /></td></tr>
<tr class="separator:ace79efa50ae5a120e515164c99ce9582"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78969bf43f80f0df3acf23c47edf7aff"><td class="memItemLeft" align="right" valign="top">integer function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevac__ops.html#a78969bf43f80f0df3acf23c47edf7aff">print_output_vac</a> (vac, data_name, rich_lvl)</td></tr>
<tr class="memdesc:a78969bf43f80f0df3acf23c47edf7aff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print vacuum quantities of a certain order to an output file.  <a href="#a78969bf43f80f0df3acf23c47edf7aff">More...</a><br /></td></tr>
<tr class="separator:a78969bf43f80f0df3acf23c47edf7aff"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a9c1d2227ea0118cb9158f7e08f41affc"><td class="memItemLeft" align="right" valign="top">logical, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevac__ops.html#a9c1d2227ea0118cb9158f7e08f41affc">debug_calc_gh</a> = .true.</td></tr>
<tr class="memdesc:a9c1d2227ea0118cb9158f7e08f41affc"><td class="mdescLeft">&#160;</td><td class="mdescRight">plot debug information for calc_GH()  <a href="#a9c1d2227ea0118cb9158f7e08f41affc">More...</a><br /></td></tr>
<tr class="separator:a9c1d2227ea0118cb9158f7e08f41affc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b99f921f077f63f641d5a9c86d88eaf"><td class="memItemLeft" align="right" valign="top">logical, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevac__ops.html#a6b99f921f077f63f641d5a9c86d88eaf">debug_calc_vac_res</a> = .true.</td></tr>
<tr class="memdesc:a6b99f921f077f63f641d5a9c86d88eaf"><td class="mdescLeft">&#160;</td><td class="mdescRight">plot debug information for <a class="el" href="namespacevac__ops.html#a5e5a8322b3aa2e3704b1050426f06d9d" title="Calculates the vacuum response. ">calc_vac_res()</a>  <a href="#a6b99f921f077f63f641d5a9c86d88eaf">More...</a><br /></td></tr>
<tr class="separator:a6b99f921f077f63f641d5a9c86d88eaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1afb20e30f5f99547fc8df4ace204ee9"><td class="memItemLeft" align="right" valign="top">logical, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevac__ops.html#a1afb20e30f5f99547fc8df4ace204ee9">debug_vac_pot_plot</a> = .true.</td></tr>
<tr class="memdesc:a1afb20e30f5f99547fc8df4ace204ee9"><td class="mdescLeft">&#160;</td><td class="mdescRight">plot debug information for <a class="el" href="namespacevac__ops.html#a3a2a3aed45951aecef42197b82a5a6da" title="Calculate vacuum potential at some positions that are not resonant. ">vac_pot_plot()</a>  <a href="#a1afb20e30f5f99547fc8df4ace204ee9">More...</a><br /></td></tr>
<tr class="separator:a1afb20e30f5f99547fc8df4ace204ee9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Operations and variables pertaining to the vacuum response. </p>
<p>The vacuum response is calculated using the Boundary Element Method. There are two possibilities, indicated by the variable <code>style</code> in <code><a class="el" href="namespacevac__vars.html" title="Variables pertaining to the vacuum quantities. ">vac_vars</a></code>.</p><ol type="1">
<li>3-D field aligned:<ul>
<li>Makes use of the collocation method for the grid points along the magnetic field lines.</li>
<li>The 3-D integrals are therefore integrated using Weyl's theorem <a class="el" href="citelist.html#CITEREF_Helander2014">[6]</a>, p. 5.</li>
</ul>
</li>
<li>axisymmetric:<ul>
<li>Makes use of an analytical expression for the toroidal integration of the Green's functions, as shown in <a class="el" href="citelist.html#CITEREF_Cohl1999">[3]</a>.</li>
<li>The integration in the poloidal angle is done using the collocation method.</li>
</ul>
</li>
</ol>
<p>The final matrix equation is solved through Strumpack <a class="el" href="citelist.html#CITEREF_Meiser2016">[10]</a>.</p>
<dl class="section see"><dt>See also</dt><dd>See <a class="el" href="citelist.html#CITEREF_Weyens3D">[17]</a>.</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000001">Todo:</a></b></dt><dd>The vacuum part of PB3D is still under construction and not usable yet. </dd></dl>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a7e3f92fbe9fa6cf3de6ac301676b96d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e3f92fbe9fa6cf3de6ac301676b96d1">&#9670;&nbsp;</a></span>calc_gh()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function vac_ops::calc_gh </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structvac__vars_1_1vac__type.html">vac_type</a>), intent(inout), target&#160;</td>
          <td class="paramname"><em>vac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>n_r_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:,:), intent(in), optional, target&#160;</td>
          <td class="paramname"><em>lims_r_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:,:), intent(in), optional, target&#160;</td>
          <td class="paramname"><em>x_vec_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:,:), intent(in), optional, target&#160;</td>
          <td class="paramname"><em>G_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:,:), intent(in), optional, target&#160;</td>
          <td class="paramname"><em>H_in</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the matrices <code>G</code> and <code>H</code>. </p>
<p>This is done by iterating over the subintervals, calculating the contributions to the potential values on the left and right boundary of the interval, and adding these to the appropriate values in G and H.</p>
<p>As each process in the blacs grid only has access to its own values, an extra interval is is calculated to the left and right of the internal process grid edges.</p>
<p>Optionally, this procedure can be used to calculate the coefficients G and H with respect to other points, outside of the boundary. This is useful when the potential is to be calculated at external points.</p>
<p>In this case, however, no (near-) singular points are calculated, and if they appear any way, perhaps by accident, they will not be accurate.</p>
<p>Multiple field lines are stored sequentially, which implies that the integral between the last point on a field line and the first point on the next field lines needs to be left out.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000002">Todo:</a></b></dt><dd>For 3-D vacuums, step sizes are constant. Subsequent Richardson levels should therefore make use of the fact that the contribution to the points inherited from the previous levels can be just scaled by 1/2 and do not need to be recalculated. Currently, the copy is done correctly in <a class="el" href="namespacevac__utilities.html#a8e7889688701f6ac2fd2c60cdee2b96a" title="Copies vacuum variables of a previous level into the appropriate, interlaced place of a next level...">interlaced_vac_copy()</a>, but they are afterwards overwritten.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>ierr</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">vac</td><td>vacuum variables</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_r_in</td><td>total number of rows of external poins of influence</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lims_r_in</td><td>row limits of external points of influence</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x_vec_in</td><td>external position of influence</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">g_in</td><td>external G</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">h_in</td><td>external H </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="vac__ops_8f90_source.html#l00501">501</a> of file <a class="el" href="vac__ops_8f90_source.html">vac_ops.f90</a>.</p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacevac__ops_a7e3f92fbe9fa6cf3de6ac301676b96d1_cgraph.svg" width="1347" height="1175"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacevac__ops_a7e3f92fbe9fa6cf3de6ac301676b96d1_icgraph.svg" width="782" height="94"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a267742c3c9a1b395aee76527d1e8352c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a267742c3c9a1b395aee76527d1e8352c">&#9670;&nbsp;</a></span>calc_gh_1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function vac_ops::calc_gh_1 </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structvac__vars_1_1vac__type.html">vac_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>vac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>n_r_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>lims_r_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>x_vec_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:,:), intent(in), pointer&#160;</td>
          <td class="paramname"><em>G_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:,:), intent(in), pointer&#160;</td>
          <td class="paramname"><em>H_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>ext_in</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates matrices <code>G</code> and <code>H</code> in 3-D configuration. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="namespacevac__ops.html#a7e3f92fbe9fa6cf3de6ac301676b96d1" title="Calculate the matrices G and H. ">calc_gh</a>.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">vac</td><td>vacuum variables</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_r_in</td><td>total number of rows of external poins of influence</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lims_r_in</td><td>row limits of external points of influence</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x_vec_in</td><td>position of influence</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">g_in</td><td>G at position of influence</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">h_in</td><td>H at position of influence</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ext_in</td><td>position of influence is external </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="vac__ops_8f90_source.html#l00779">779</a> of file <a class="el" href="vac__ops_8f90_source.html">vac_ops.f90</a>.</p>
<div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacevac__ops_a267742c3c9a1b395aee76527d1e8352c_cgraph.svg" width="655" height="288"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacevac__ops_a267742c3c9a1b395aee76527d1e8352c_icgraph.svg" width="996" height="94"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ae4987d1f48f1f83b1f0d38ea85b4998b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4987d1f48f1f83b1f0d38ea85b4998b">&#9670;&nbsp;</a></span>calc_gh_2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function vac_ops::calc_gh_2 </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structvac__vars_1_1vac__type.html">vac_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>vac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>n_r_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>lims_r_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>x_vec_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:,:), intent(in), pointer&#160;</td>
          <td class="paramname"><em>G_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:,:), intent(in), pointer&#160;</td>
          <td class="paramname"><em>H_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>ext_in</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates matrices <code>G</code> and <code>H</code> in axisymmetric configurations. </p>
<p>It makes use of toroidal functions.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="namespacevac__ops.html#a7e3f92fbe9fa6cf3de6ac301676b96d1" title="Calculate the matrices G and H. ">calc_gh</a>.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">vac</td><td>vacuum variables</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_r_in</td><td>total number of rows of external poins of influence</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lims_r_in</td><td>row limits of external points of influence</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x_vec_in</td><td>position of influence</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">g_in</td><td>G at position of influence</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">h_in</td><td>H at position of influence</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ext_in</td><td>position of influence is external </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="vac__ops_8f90_source.html#l00983">983</a> of file <a class="el" href="vac__ops_8f90_source.html">vac_ops.f90</a>.</p>
<div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacevac__ops_ae4987d1f48f1f83b1f0d38ea85b4998b_cgraph.svg" width="902" height="338"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacevac__ops_ae4987d1f48f1f83b1f0d38ea85b4998b_icgraph.svg" width="996" height="94"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a5e5a8322b3aa2e3704b1050426f06d9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e5a8322b3aa2e3704b1050426f06d9d">&#9670;&nbsp;</a></span>calc_vac_res()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public vac_ops::calc_vac_res </td>
          <td>(</td>
          <td class="paramtype">type(modes_type), intent(in)&#160;</td>
          <td class="paramname"><em>mds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structvac__vars_1_1vac__type.html">vac_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>vac</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the vacuum response. </p>
<p>First <code>G</code> and <code>H</code> are completed if this is not the first Richardson level.</p>
<p>Then the vacuum contribution is calculated using the two-fold strategy of first solving \(\overline{\text{H}}\overline{\Phi} = \overline{\text{G}}\overline{\text{E}} \overline{\text{P}}\), followed by left-multiplication of \(\overline{\Phi}\) by \(\overline{\text{P}}\overline{\text{E}}^\dagger\).</p>
<p>The non-square matrix \(\overline{\text{E}}\) contains the exponents for different mode numbers and different poloidal grid points, whereas \(\overline{\text{P}}\) are diagonal matrices that contain the factors \((nq-m)\).</p>
<p>In practice, the complex matrix \(\overline{\text{E}}\) is split in the two components of a real matrix twice the width.</p>
<p>For vacuum style 1, the poloidal grid points correspond to the paralell grid points and have to be provied by a <code>grid</code> variable.</p>
<p>If <code>jump_to_sol</code> is used for the current Richardson level, the vacuum quantities are not calculated, but just restored.</p>
<p>Currently, this procedure only works for vacuum style 2 (axisymmetric).</p>
<dl class="section return"><dt>Returns</dt><dd>ierr</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mds</td><td>general modes variables</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">vac</td><td>vacuum variables </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="vac__ops_8f90_source.html#l01417">1417</a> of file <a class="el" href="vac__ops_8f90_source.html">vac_ops.f90</a>.</p>
<div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacevac__ops_a5e5a8322b3aa2e3704b1050426f06d9d_cgraph.svg" width="1738" height="1951"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacevac__ops_a5e5a8322b3aa2e3704b1050426f06d9d_icgraph.svg" width="583" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a78969bf43f80f0df3acf23c47edf7aff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78969bf43f80f0df3acf23c47edf7aff">&#9670;&nbsp;</a></span>print_output_vac()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public vac_ops::print_output_vac </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structvac__vars_1_1vac__type.html">vac_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>vac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>data_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>rich_lvl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print vacuum quantities of a certain order to an output file. </p>
<ul>
<li>vac:<ul>
<li><code>misc_vac</code> </li>
<li><code>norm</code> </li>
<li><code>x_vec</code> </li>
<li><code>vac_res</code> </li>
</ul>
</li>
</ul>
<p>If <code>rich_lvl</code> is provided, <code>"_R_[rich_lvl]"</code> is appended to the data name if it is <code>&gt;0</code>.</p>
<dl class="section note"><dt>Note</dt><dd><ol type="1">
<li>This routine should be called by a single process, in contrast to the other output routines such as <a class="el" href="interfaceeq__ops_1_1print__output__eq.html" title="Print equilibrium quantities to an output file: ">eq_ops.print_output_eq()</a>, <a class="el" href="namespacesol__ops.html#a06eb95d55da45ff2a1f830a380e0cf80" title="Print solution quantities to an output file: ">print_output_sol()</a>, ...</li>
<li>This process should be the last one, as it will set the boundary contribution.</li>
<li>This routine does not save the <code>H</code> and <code>G</code> matrices because they are large and foreseen to be saved directly as Hierarchical matrices in the future. They therefore need to be regenerated if Richardson restart is done, or when after a jump to solution, another Richardson level is attempted. In calc_vac, it is checked when copying the vacuum variables from previous to current Richardson level, whether the <code>G</code> and <code>H</code> matrices are allocated and if not, they are calculated.</li>
</ol>
</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>ierr</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">vac</td><td>vacuum variables</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data_name</td><td>name under which to store</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rich_lvl</td><td>Richardson level to print </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="vac__ops_8f90_source.html#l02337">2337</a> of file <a class="el" href="vac__ops_8f90_source.html">vac_ops.f90</a>.</p>
<div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacevac__ops_a78969bf43f80f0df3acf23c47edf7aff_cgraph.svg" width="1475" height="598"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-9" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-9-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacevac__ops_a78969bf43f80f0df3acf23c47edf7aff_icgraph.svg" width="615" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ace79efa50ae5a120e515164c99ce9582"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace79efa50ae5a120e515164c99ce9582">&#9670;&nbsp;</a></span>solve_phi_bem()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function vac_ops::solve_phi_bem </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structvac__vars_1_1vac__type.html">vac_type</a>), intent(in), target&#160;</td>
          <td class="paramname"><em>vac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>R</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:,:), intent(inout), target&#160;</td>
          <td class="paramname"><em>Phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(2), intent(in)&#160;</td>
          <td class="paramname"><em>n_RPhi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(2), intent(in)&#160;</td>
          <td class="paramname"><em>n_loc_RPhi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>lims_c_RPhi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(blacsctxtsize), intent(in), target&#160;</td>
          <td class="paramname"><em>desc_RPhi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates potential <code>Phi</code> on boundary of BEM in terms of some right-hand side . </p>
<p>This is done by solving with STRUMPack the system of equations \(\overline{\text{H}}\overline{\Phi} = \overline{\text{G}}\overline{\text{R}}\), where \(\overline{\text{R}}\) is the right-hand side, for example equal to \(\overline{\text{E}}\overline{\text{P}}\) to solve in function of the individual Fourier modes.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">vac</td><td>vacuum variables</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">phi</td><td>\(\overline{\Phi}\)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r</td><td>\(\overline{\text{R}}\)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_rphi</td><td><code>n</code> for \(\overline{\text{R}}\) and \(\overline{\Phi}\)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_loc_rphi</td><td>local <code>n</code> for \(\overline{\text{R}}\) and \(\overline{\Phi}\)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lims_c_rphi</td><td>local limits for row and columns of \(\overline{\text{R}}\) and \(\overline{\Phi}\)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">desc_rphi</td><td>descriptor for \(\overline{\text{R}}\) and \(\overline{\Phi}\) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="vac__ops_8f90_source.html#l02153">2153</a> of file <a class="el" href="vac__ops_8f90_source.html">vac_ops.f90</a>.</p>
<div id="dynsection-10" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-10-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-10-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-10-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacevac__ops_ace79efa50ae5a120e515164c99ce9582_cgraph.svg" width="1355" height="346"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-11" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-11-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-11-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-11-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacevac__ops_ace79efa50ae5a120e515164c99ce9582_icgraph.svg" width="830" height="94"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a37220702fbf378626a0f2c12f446e0aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37220702fbf378626a0f2c12f446e0aa">&#9670;&nbsp;</a></span>store_vac()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public vac_ops::store_vac </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structgrid__vars_1_1grid__type.html">grid_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structeq__vars_1_1eq__1__type.html">eq_1_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>eq_1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structeq__vars_1_1eq__2__type.html">eq_2_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>eq_2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structvac__vars_1_1vac__type.html">vac_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>vac</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stores calculation of the vacuum response by storing the necessary variables. </p>
<p>This is done by the last process, which is the one that contains the variables at the plasma edge, and then this is broadcasted to the other processes.</p>
<p>The workings of this routine are summarized in the following diagram for VMEC: </p><div class="dotgraph">
<iframe scrolling="no" frameborder="0" src="dot_inline_dotgraph_1.svg" width="747" height="774"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
<p>Before storing the new variables, the procedure checks the following things:</p><ul>
<li>For the first equilibrium job, this routine copies the results from the previous Richardson level into the appropriate subranges of the new vacuum variables if no restart of Richardson levels was done.</li>
<li>If a restart was done and the level is greater than one, there is a reconstruction of the previous level's variables. But this will happen in <a class="el" href="namespacevac__ops.html#a5e5a8322b3aa2e3704b1050426f06d9d" title="Calculates the vacuum response. ">calc_vac_res()</a>, not in this procedure.</li>
</ul>
<p>If there is a jump straight to the solution, however, the procedure returns after reconstructing the current level's variables.</p>
<p>If the previous <code>G</code> and <code>H</code> variables are empty, they are regenerated later, in <a class="el" href="namespacevac__ops.html#a7e3f92fbe9fa6cf3de6ac301676b96d1" title="Calculate the matrices G and H. ">calc_gh()</a>. This indicates that a reconstruction happened, either because a Richardson restart was performed, or because a new Richardson level was started after a previous level in which it was jumped straight to the solution.</p>
<p>For HELENA, there is only 1 equilibrium job at the first Richardson level, and the vacuum has to be calculated only once then. If there is a jump to solution or if there is Richardson restart, it only needs to be reconstructed.</p>
<dl class="section return"><dt>Returns</dt><dd>ierr</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">grid</td><td>equilibrium grid</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eq_1</td><td>flux equilibrium variables</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eq_2</td><td>metric equilibrium variables</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">vac</td><td>vacuum variables </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="vac__ops_8f90_source.html#l00113">113</a> of file <a class="el" href="vac__ops_8f90_source.html">vac_ops.f90</a>.</p>
<div id="dynsection-12" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-12-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-12-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-12-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacevac__ops_a37220702fbf378626a0f2c12f446e0aa_cgraph.svg" width="1722" height="1287"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-13" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-13-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-13-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-13-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacevac__ops_a37220702fbf378626a0f2c12f446e0aa_icgraph.svg" width="543" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a3a2a3aed45951aecef42197b82a5a6da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a2a3aed45951aecef42197b82a5a6da">&#9670;&nbsp;</a></span>vac_pot_plot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public vac_ops::vac_pot_plot </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structgrid__vars_1_1grid__type.html">grid_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>grid_sol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structvac__vars_1_1vac__type.html">vac_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>vac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structsol__vars_1_1sol__type.html">sol_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>sol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>X_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate vacuum potential at some positions that are not resonant. </p>
<p>This is done by using the relation between H and G on the plasma boundary, \(\overline{\text{H}}_\text{s} \overline{\Phi}_\text{s} = \overline{\text{G}}_\text{s} \overline{\text{D}\phi}_\text{s}\), where \(\overline{\text{D}\phi}_\text{s}\) is the normal derivative of the potential on the plasma edge. The matrices \(\overline{\text{H}}\) and \(\overline{\text{G}}\) have to be calculated in advance.</p>
<p>This relation is then used at different positions to calculate the potential at a different position through \(4 \pi \phi = \left[ - \overline{\text{H}} \overline{\text{I}} \overline{\text{H}}_\text{s}^{-1} \overline{\text{G}}_\text{s} + \overline{\text{G}} \overline{\text{I}} \right] \overline{\text{D}\phi}_\text{s}\), where \(\overline{\text{I}}\) is an integration rule.</p>
<p>This system of equations contains one row per point at which the potential is to be calculated.</p>
<p>Currently, this routine creates a 3-D regular grid that is equidistant in cylindrical coordinates, with <code>n_vac_plot</code> values in R and Z, and <code>n_zeta_plot</code> values in the cylindrical angle. The limits in these variables, furthermore, are given by <code>min_Rvac_plot</code>, <code>max_Rvac_plot</code>, <code>min_Zvac_plot</code>, <code>max_Zvac_plot</code>, <code>min_zeta_plot</code> and <code>max_zeta_plot</code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">grid_sol</td><td>solution grid</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">vac</td><td>vacuum variables</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sol</td><td>solution variables</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x_id</td><td>nr. of Eigenvalue </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="vac__ops_8f90_source.html#l01847">1847</a> of file <a class="el" href="vac__ops_8f90_source.html">vac_ops.f90</a>.</p>
<div id="dynsection-14" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-14-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-14-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-14-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacevac__ops_a3a2a3aed45951aecef42197b82a5a6da_cgraph.svg" width="1634" height="1248"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-15" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-15-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-15-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-15-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacevac__ops_a3a2a3aed45951aecef42197b82a5a6da_icgraph.svg" width="551" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a9c1d2227ea0118cb9158f7e08f41affc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c1d2227ea0118cb9158f7e08f41affc">&#9670;&nbsp;</a></span>debug_calc_gh</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical, public vac_ops::debug_calc_gh = .true.</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>plot debug information for calc_GH() </p>
<dl class="section note"><dt>Note</dt><dd>Debug version only </dd></dl>

<p class="definition">Definition at line <a class="el" href="vac__ops_8f90_source.html#l00046">46</a> of file <a class="el" href="vac__ops_8f90_source.html">vac_ops.f90</a>.</p>

</div>
</div>
<a id="a6b99f921f077f63f641d5a9c86d88eaf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b99f921f077f63f641d5a9c86d88eaf">&#9670;&nbsp;</a></span>debug_calc_vac_res</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical, public vac_ops::debug_calc_vac_res = .true.</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>plot debug information for <a class="el" href="namespacevac__ops.html#a5e5a8322b3aa2e3704b1050426f06d9d" title="Calculates the vacuum response. ">calc_vac_res()</a> </p>
<dl class="section note"><dt>Note</dt><dd>Debug version only </dd></dl>

<p class="definition">Definition at line <a class="el" href="vac__ops_8f90_source.html#l00047">47</a> of file <a class="el" href="vac__ops_8f90_source.html">vac_ops.f90</a>.</p>

</div>
</div>
<a id="a1afb20e30f5f99547fc8df4ace204ee9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1afb20e30f5f99547fc8df4ace204ee9">&#9670;&nbsp;</a></span>debug_vac_pot_plot</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical, public vac_ops::debug_vac_pot_plot = .true.</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>plot debug information for <a class="el" href="namespacevac__ops.html#a3a2a3aed45951aecef42197b82a5a6da" title="Calculate vacuum potential at some positions that are not resonant. ">vac_pot_plot()</a> </p>
<dl class="section note"><dt>Note</dt><dd>Debug version only </dd></dl>

<p class="definition">Definition at line <a class="el" href="vac__ops_8f90_source.html#l00048">48</a> of file <a class="el" href="vac__ops_8f90_source.html">vac_ops.f90</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<address class="footer"><small>
<center>this documentation was created with <a href="http://www.doxygen.org/index.html">Doxygen 1.8.13</a> by <a href="mailto:weyenst@gmail.com">Toon Weyens</a></center>
</small></address>
</body>
</html>
