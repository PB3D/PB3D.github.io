<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.16.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PB3D: slepc_utilities Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PB3D<span id="projectnumber">&#160;[2.47]</span>
   </div>
   <div id="projectbrief">Ideal linear high-n MHD stability in 3-D</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.16.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">slepc_utilities Module Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Numerical utilities related to SLEPC (and PETSC) operations.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:aa34aa361f0bfff9621ecba179f9ed0c6" id="r_aa34aa361f0bfff9621ecba179f9ed0c6"><td class="memItemLeft">integer function, public&#160;</td><td class="memItemRight"><a class="el" href="#aa34aa361f0bfff9621ecba179f9ed0c6">insert_block_mat</a> (mds, block, mat, r_id, ind, n_r, transp, overwrite, ind_insert)</td></tr>
<tr class="memdesc:aa34aa361f0bfff9621ecba179f9ed0c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Insert a block pertaining to 1 normal point into a matrix.  <br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-var-members" class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a5cb92553633cb22ff703286298862ac7" id="r_a5cb92553633cb22ff703286298862ac7"><td class="memItemLeft">logical, public&#160;</td><td class="memItemRight"><a class="el" href="#a5cb92553633cb22ff703286298862ac7">debug_insert_block_mat</a> = .false.</td></tr>
<tr class="memdesc:a5cb92553633cb22ff703286298862ac7"><td class="mdescLeft">&#160;</td><td class="mdescRight">plot debug information for <a class="el" href="#aa34aa361f0bfff9621ecba179f9ed0c6" title="Insert a block pertaining to 1 normal point into a matrix.">insert_block_mat()</a>  <br /></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Numerical utilities related to SLEPC (and PETSC) operations. </p>
<dl class="section see"><dt>See also</dt><dd>References: <a class="el" href="citelist.html#CITEREF_hernandez2005slepc">[7]</a> </dd></dl>
</div><a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function/Subroutine Documentation</h2>
<a id="aa34aa361f0bfff9621ecba179f9ed0c6" name="aa34aa361f0bfff9621ecba179f9ed0c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa34aa361f0bfff9621ecba179f9ed0c6">&#9670;&#160;</a></span>insert_block_mat()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public slepc_utilities::insert_block_mat </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structx__vars_1_1modes__type.html">modes_type</a>), intent(in), target</td>          <td class="paramname"><span class="paramname"><em>mds</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dimension(:,:), intent(in)</td>          <td class="paramname"><span class="paramname"><em>block</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">intent(inout)</td>          <td class="paramname"><span class="paramname"><em>mat</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">intent(in)</td>          <td class="paramname"><span class="paramname"><em>r_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dimension(2), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ind</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">intent(in)</td>          <td class="paramname"><span class="paramname"><em>n_r</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">optional</td>          <td class="paramname"><span class="paramname"><em>transp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">optional</td>          <td class="paramname"><span class="paramname"><em>overwrite</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">optional</td>          <td class="paramname"><span class="paramname"><em>ind_insert</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Insert a block pertaining to 1 normal point into a matrix. </p>
<p>Optionally, also set the Hermitian transpose and / or overwrite instead of add value.</p>
<p>This routine takes into account that if the mode numbers change as a function of the normal coordinate, as is the case for X_style 2 (fast), part of the local blocks, which were set up without taking this into account, can have information that correspond to mode numbers that are not present any more for off-diagonal entries, and lack an equal amount of information that corresponds to the mode numbers that have taken their places.</p>
<p>Omission of this effect is justifiable if there are many more mode couplings that are not omitted (i.e. when <code>n_mod_X</code> is large), so that it is a small effect, and/or when the coupling between these modes is already negligible.</p>
<p>Unfortunately, it can be argued that this is not generally the case for the fast version (<code>X_style</code> = 2) since \(\widetilde{PV}^1\) and \(\widetilde{PV}^2\) are both \(\sim (nq-m)\), which indicates that the smallest elements in the corresponding off-diagonal blocks lie in the central columns for \(\widetilde{PV}^1\) and in the central columns and rows for \(\widetilde{PV}^2\), while the problematic elements lie farthest away from the central columns for \(\widetilde{PV}^1\) and the central columns and rows for \(\widetilde{PV}^2\), so these are generally not small.</p>
<p>The coefficients due to normal discretization get increasingly small for higher orders, though, which compensates this for higher orders.</p>
<p>Finally, an alternative would be to set the problematic elements not to zero but extrapolated from the closest elements, but then consistency would be sacrified, for example in the energy reconstruction of the POST-processing: In the energy reconstruction the exact same terms are neglected as well.</p>
<p>To conclude, for fast <code>X_style</code> 2, the number of modes (<code>n_mod_X</code>) has to be chosen high enough compared with the variation of the mode numbers; i.e. the variation of the safety factor or rotational transform.</p>
<dl class="section note"><dt>Note</dt><dd>The grid in which the modes variables <code>mds</code> are tabulated up must be the same as the one in which <code>mat</code> is set up. If this is not the case, the indices in <code>mds</code> have to be adapted.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>ierr </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mds</td><td>general modes variables </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="SLEPC__utilities_8f90_source.html#l00081">81</a> of file <a class="el" href="SLEPC__utilities_8f90_source.html">SLEPC_utilities.f90</a>.</p>
<div id="dynsection-0" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;"><span class="dynarrow"><span class="arrowhead closed"></span></span>Here is the call graph for this function:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" loading="lazy" frameborder="0" src="namespaceslepc__utilities_aa34aa361f0bfff9621ecba179f9ed0c6_cgraph.svg" width="1403" height="482"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-1" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;"><span class="dynarrow"><span class="arrowhead closed"></span></span>Here is the caller graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" loading="lazy" frameborder="0" src="namespaceslepc__utilities_aa34aa361f0bfff9621ecba179f9ed0c6_icgraph.svg" width="1118" height="91"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a name="doc-var-members" id="doc-var-members"></a><h2 id="header-doc-var-members" class="groupheader">Variable Documentation</h2>
<a id="a5cb92553633cb22ff703286298862ac7" name="a5cb92553633cb22ff703286298862ac7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5cb92553633cb22ff703286298862ac7">&#9670;&#160;</a></span>debug_insert_block_mat</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical, public slepc_utilities::debug_insert_block_mat = .false.</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>plot debug information for <a class="el" href="#aa34aa361f0bfff9621ecba179f9ed0c6" title="Insert a block pertaining to 1 normal point into a matrix.">insert_block_mat()</a> </p>
<dl class="section note"><dt>Note</dt><dd>Debug version only </dd></dl>

<p class="definition">Definition at line <a class="el" href="SLEPC__utilities_8f90_source.html#l00031">31</a> of file <a class="el" href="SLEPC__utilities_8f90_source.html">SLEPC_utilities.f90</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<address class="footer"><small>
<center>this documentation was created with <a href="http://www.doxygen.org/index.html">Doxygen 1.16.1</a> by <a href="mailto:weyenst@gmail.com">Toon Weyens</a></center>
</small></address>
</body>
</html>
