<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PB3D: pb3d_ops Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PB3D
   &#160;<span id="projectnumber">[2.45]</span>
   </div>
   <div id="projectbrief">Ideal linear high-n MHD stability in 3-D</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">pb3d_ops Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Operations on PB3D output.  
<a href="namespacepb3d__ops.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:ad1481747b9b9832f816d4bf1dd2d6737"><td class="memItemLeft" align="right" valign="top">integer function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepb3d__ops.html#ad1481747b9b9832f816d4bf1dd2d6737">reconstruct_pb3d_in</a> (data_name)</td></tr>
<tr class="memdesc:ad1481747b9b9832f816d4bf1dd2d6737"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reconstructs the input variables from PB3D HDF5 output.  <a href="namespacepb3d__ops.html#ad1481747b9b9832f816d4bf1dd2d6737">More...</a><br /></td></tr>
<tr class="separator:ad1481747b9b9832f816d4bf1dd2d6737"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4218b582c5029ff05893265fa329877b"><td class="memItemLeft" align="right" valign="top">integer function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepb3d__ops.html#a4218b582c5029ff05893265fa329877b">reconstruct_pb3d_grid</a> (grid, data_name, rich_lvl, tot_rich, lim_pos, grid_limits)</td></tr>
<tr class="memdesc:a4218b582c5029ff05893265fa329877b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reconstructs grid variables from PB3D HDF5 output.  <a href="namespacepb3d__ops.html#a4218b582c5029ff05893265fa329877b">More...</a><br /></td></tr>
<tr class="separator:a4218b582c5029ff05893265fa329877b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3142ca9965fa01b2777db762ed1a6eba"><td class="memItemLeft" align="right" valign="top">integer function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepb3d__ops.html#a3142ca9965fa01b2777db762ed1a6eba">reconstruct_pb3d_eq_1</a> (grid_eq, eq, data_name, lim_pos)</td></tr>
<tr class="memdesc:a3142ca9965fa01b2777db762ed1a6eba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reconstructs the equilibrium variables from PB3D HDF5 output.  <a href="namespacepb3d__ops.html#a3142ca9965fa01b2777db762ed1a6eba">More...</a><br /></td></tr>
<tr class="separator:a3142ca9965fa01b2777db762ed1a6eba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf99ae865680f4cf0a0a9932786689bf"><td class="memItemLeft" align="right" valign="top">integer function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepb3d__ops.html#aaf99ae865680f4cf0a0a9932786689bf">reconstruct_pb3d_eq_2</a> (grid_eq, eq, data_name, rich_lvl, tot_rich, lim_pos)</td></tr>
<tr class="memdesc:aaf99ae865680f4cf0a0a9932786689bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reconstructs the equilibrium variables from PB3D HDF5 output.  <a href="namespacepb3d__ops.html#aaf99ae865680f4cf0a0a9932786689bf">More...</a><br /></td></tr>
<tr class="separator:aaf99ae865680f4cf0a0a9932786689bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e87e553956f0dc4371d85b008e5e131"><td class="memItemLeft" align="right" valign="top">integer function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepb3d__ops.html#a8e87e553956f0dc4371d85b008e5e131">reconstruct_pb3d_x_1</a> (mds, grid_X, X, data_name, rich_lvl, tot_rich, lim_sec_X, lim_pos)</td></tr>
<tr class="memdesc:a8e87e553956f0dc4371d85b008e5e131"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reconstructs the vectorial perturbation variables from PB3D HDF5 output.  <a href="namespacepb3d__ops.html#a8e87e553956f0dc4371d85b008e5e131">More...</a><br /></td></tr>
<tr class="separator:a8e87e553956f0dc4371d85b008e5e131"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff64b6722845a07139e2832c0be36145"><td class="memItemLeft" align="right" valign="top">integer function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepb3d__ops.html#aff64b6722845a07139e2832c0be36145">reconstruct_pb3d_x_2</a> (mds, grid_X, X, data_name, rich_lvl, tot_rich, lim_sec_X, lim_pos, is_field_averaged)</td></tr>
<tr class="memdesc:aff64b6722845a07139e2832c0be36145"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reconstructs the tensorial perturbation variables from PB3D HDF5 output.  <a href="namespacepb3d__ops.html#aff64b6722845a07139e2832c0be36145">More...</a><br /></td></tr>
<tr class="separator:aff64b6722845a07139e2832c0be36145"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a281c496a42c4ea46606e929e10d51582"><td class="memItemLeft" align="right" valign="top">integer function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepb3d__ops.html#a281c496a42c4ea46606e929e10d51582">reconstruct_pb3d_vac</a> (vac, data_name, rich_lvl)</td></tr>
<tr class="memdesc:a281c496a42c4ea46606e929e10d51582"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reconstructs the vacuum variables from PB3D HDF5 output.  <a href="namespacepb3d__ops.html#a281c496a42c4ea46606e929e10d51582">More...</a><br /></td></tr>
<tr class="separator:a281c496a42c4ea46606e929e10d51582"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7afc544227f34f2877eb5a14d620823"><td class="memItemLeft" align="right" valign="top">integer function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepb3d__ops.html#ae7afc544227f34f2877eb5a14d620823">reconstruct_pb3d_sol</a> (mds, grid_sol, sol, data_name, rich_lvl, lim_sec_sol, lim_pos)</td></tr>
<tr class="memdesc:ae7afc544227f34f2877eb5a14d620823"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reconstructs the solution variables from PB3D HDF5 output.  <a href="namespacepb3d__ops.html#ae7afc544227f34f2877eb5a14d620823">More...</a><br /></td></tr>
<tr class="separator:ae7afc544227f34f2877eb5a14d620823"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a528ae2857b7272d29d96f66ee60980a7"><td class="memItemLeft" align="right" valign="top">integer function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepb3d__ops.html#a528ae2857b7272d29d96f66ee60980a7">get_pb3d_grid_size</a> (n, grid_name, rich_lvl, tot_rich)</td></tr>
<tr class="memdesc:a528ae2857b7272d29d96f66ee60980a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">get grid size  <a href="namespacepb3d__ops.html#a528ae2857b7272d29d96f66ee60980a7">More...</a><br /></td></tr>
<tr class="separator:a528ae2857b7272d29d96f66ee60980a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Operations on PB3D output. </p>
<dl class="section note"><dt>Note</dt><dd>If you have parallel jobs, if the reconstruction routines are called for multiple equilibrium jobs, this can only be done after the last equilibrium job is finished. There are no checks for this. </dd></dl>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a528ae2857b7272d29d96f66ee60980a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a528ae2857b7272d29d96f66ee60980a7">&#9670;&nbsp;</a></span>get_pb3d_grid_size()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public pb3d_ops::get_pb3d_grid_size </td>
          <td>(</td>
          <td class="paramtype">integer, dimension(3), intent(inout)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>grid_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>rich_lvl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>tot_rich</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>get grid size </p>
<dl class="section note"><dt>Note</dt><dd><code>grid_</code> is added in front the grid_name.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>ierr </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">n</td><td>n of grid </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid_name</td><td>name of grid </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rich_lvl</td><td>Richardson level to reconstruct </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tot_rich</td><td>whether to combine with previous Richardson levels </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="PB3D__ops_8f90_source.html#l01454">1454</a> of file <a class="el" href="PB3D__ops_8f90_source.html">PB3D_ops.f90</a>.</p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacepb3d__ops_a528ae2857b7272d29d96f66ee60980a7_cgraph.svg" width="1418" height="483"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacepb3d__ops_a528ae2857b7272d29d96f66ee60980a7_icgraph.svg" width="1087" height="443"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a3142ca9965fa01b2777db762ed1a6eba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3142ca9965fa01b2777db762ed1a6eba">&#9670;&nbsp;</a></span>reconstruct_pb3d_eq_1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public pb3d_ops::reconstruct_pb3d_eq_1 </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structgrid__vars_1_1grid__type.html">grid_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>grid_eq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structeq__vars_1_1eq__1__type.html">eq_1_type</a>), intent(inout), optional&#160;</td>
          <td class="paramname"><em>eq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>data_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(1,2), intent(in), optional&#160;</td>
          <td class="paramname"><em>lim_pos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reconstructs the equilibrium variables from PB3D HDF5 output. </p>
<p>Furthermore, using <code>lim_pos</code>, you can obtain a subset of the data by directly passing its limits to the underlying HDF5 routine. This refers to the position dimensions only. If provided, the normal limits of a divided grid refer to the subset, as in <a class="el" href="namespacegrid__utilities.html#a04f971c38083f873a04eb6568bed466b" title="Copy a grid A to a new grid B, that was not yet initialized.">copy_grid()</a>.</p>
<dl class="section return"><dt>Returns</dt><dd>ierr </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">grid_eq</td><td>equilibrium grid </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">eq</td><td>flux equilibrium </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data_name</td><td>name to reconstruct </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lim_pos</td><td>position limits of subset of data </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="PB3D__ops_8f90_source.html#l00597">597</a> of file <a class="el" href="PB3D__ops_8f90_source.html">PB3D_ops.f90</a>.</p>
<div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacepb3d__ops_a3142ca9965fa01b2777db762ed1a6eba_cgraph.svg" width="1434" height="483"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacepb3d__ops_a3142ca9965fa01b2777db762ed1a6eba_icgraph.svg" width="820" height="212"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="aaf99ae865680f4cf0a0a9932786689bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf99ae865680f4cf0a0a9932786689bf">&#9670;&nbsp;</a></span>reconstruct_pb3d_eq_2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public pb3d_ops::reconstruct_pb3d_eq_2 </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structgrid__vars_1_1grid__type.html">grid_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>grid_eq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structeq__vars_1_1eq__2__type.html">eq_2_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>eq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>data_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>rich_lvl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>tot_rich</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(3,2), intent(in), optional&#160;</td>
          <td class="paramname"><em>lim_pos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reconstructs the equilibrium variables from PB3D HDF5 output. </p>
<p>Also, if <code>rich_lvl</code> is provided, <code>_R_[rich_lvl]</code> is appended to the data name if it is &gt; 0.</p>
<p>With <code>tot_rich</code> the information from previous Richardson levels can be combined.</p>
<p>Furthermore, using <code>lim_pos</code>, you can obtain a subset of the data by directly passing its limits to the underlying HDF5 routine. This refers to the position dimensions only. If provided, the normal limits of a divided grid refer to the subset, as in <a class="el" href="namespacegrid__utilities.html#a04f971c38083f873a04eb6568bed466b" title="Copy a grid A to a new grid B, that was not yet initialized.">copy_grid()</a>.</p>
<dl class="section return"><dt>Returns</dt><dd>ierr </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">grid_eq</td><td>equilibrium grid </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">eq</td><td>metric equilibrium </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data_name</td><td>name to reconstruct </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rich_lvl</td><td>Richardson level to reconstruct </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tot_rich</td><td>whether to combine with previous Richardson levels </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lim_pos</td><td>position limits of subset of data </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="PB3D__ops_8f90_source.html#l00695">695</a> of file <a class="el" href="PB3D__ops_8f90_source.html">PB3D_ops.f90</a>.</p>
<div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacepb3d__ops_aaf99ae865680f4cf0a0a9932786689bf_cgraph.svg" width="1434" height="483"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacepb3d__ops_aaf99ae865680f4cf0a0a9932786689bf_icgraph.svg" width="879" height="215"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a4218b582c5029ff05893265fa329877b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4218b582c5029ff05893265fa329877b">&#9670;&nbsp;</a></span>reconstruct_pb3d_grid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public pb3d_ops::reconstruct_pb3d_grid </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structgrid__vars_1_1grid__type.html">grid_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>data_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>rich_lvl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>tot_rich</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(3,2), intent(in), optional&#160;</td>
          <td class="paramname"><em>lim_pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(2), intent(in), optional&#160;</td>
          <td class="paramname"><em>grid_limits</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reconstructs grid variables from PB3D HDF5 output. </p>
<p>Also, if <code>rich_lvl</code> is provided, <code>_R_[rich_lvl]</code> is appended to the data name if it is &gt; 0.</p>
<p>With <code>tot_rich</code> the information from previous Richardson levels can be combined.</p>
<p>Furthermore, using <code>lim_pos</code>, you can obtain a subset of the data by directly passing its limits to the underlying HDF5 routine. This refers to the position dimensions only. If provided, the normal limits of a divided grid refer to the subset, as in <a class="el" href="namespacegrid__utilities.html#a04f971c38083f873a04eb6568bed466b" title="Copy a grid A to a new grid B, that was not yet initialized.">copy_grid()</a>.</p>
<dl class="section note"><dt>Note</dt><dd><ol type="1">
<li><code>grid_</code> is added in front the data_name.</li>
<li>By providing <code>lim_pos</code> equal to 0 in the angular dimensions, the angular part can be discarded when reconstructing the grid.</li>
</ol>
</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>ierr </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">data_name</td><td>name of grid </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rich_lvl</td><td>Richardson level to reconstruct </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tot_rich</td><td>whether to combine with previous Richardson levels </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lim_pos</td><td>position limits of subset of data </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid_limits</td><td>i_limit of grid </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="PB3D__ops_8f90_source.html#l00442">442</a> of file <a class="el" href="PB3D__ops_8f90_source.html">PB3D_ops.f90</a>.</p>
<div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacepb3d__ops_a4218b582c5029ff05893265fa329877b_cgraph.svg" width="1664" height="482"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacepb3d__ops_a4218b582c5029ff05893265fa329877b_icgraph.svg" width="883" height="431"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ad1481747b9b9832f816d4bf1dd2d6737"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1481747b9b9832f816d4bf1dd2d6737">&#9670;&nbsp;</a></span>reconstruct_pb3d_in()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public pb3d_ops::reconstruct_pb3d_in </td>
          <td>(</td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>data_name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reconstructs the input variables from PB3D HDF5 output. </p>
<dl class="section return"><dt>Returns</dt><dd>ierr </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">data_name</td><td>name of input variables </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="PB3D__ops_8f90_source.html#l00041">41</a> of file <a class="el" href="PB3D__ops_8f90_source.html">PB3D_ops.f90</a>.</p>
<div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacepb3d__ops_ad1481747b9b9832f816d4bf1dd2d6737_cgraph.svg" width="1434" height="615"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-9" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-9-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacepb3d__ops_ad1481747b9b9832f816d4bf1dd2d6737_icgraph.svg" width="999" height="263"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ae7afc544227f34f2877eb5a14d620823"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7afc544227f34f2877eb5a14d620823">&#9670;&nbsp;</a></span>reconstruct_pb3d_sol()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public pb3d_ops::reconstruct_pb3d_sol </td>
          <td>(</td>
          <td class="paramtype">type(modes_type), intent(in)&#160;</td>
          <td class="paramname"><em>mds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structgrid__vars_1_1grid__type.html">grid_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>grid_sol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structsol__vars_1_1sol__type.html">sol_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>sol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>data_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>rich_lvl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(2), intent(in), optional&#160;</td>
          <td class="paramname"><em>lim_sec_sol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(1,2), intent(in), optional&#160;</td>
          <td class="paramname"><em>lim_pos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reconstructs the solution variables from PB3D HDF5 output. </p>
<p>Also, if <code>rich_lvl</code> is provided, <code>_R_[rich_lvl]</code> is appended to the data name if it is &gt; 0.</p>
<p>Furthermore, using <code>lim_pos</code>, you can obtain a subset of the data by directly passing its limits to the underlying HDF5 routine. This refers to the position dimensions only. If provided, the normal limits of a divided grid refer to the subset, as in <a class="el" href="namespacegrid__utilities.html#a04f971c38083f873a04eb6568bed466b" title="Copy a grid A to a new grid B, that was not yet initialized.">copy_grid()</a>.</p>
<p><code>lim_sec_sol</code>, on the other hand, selects a range of mode numbers.</p>
<dl class="section return"><dt>Returns</dt><dd>ierr </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mds</td><td>general modes variables </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid_sol</td><td>solution grid </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">sol</td><td>solution variables </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data_name</td><td>name to reconstruct </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rich_lvl</td><td>Richardson level to reconstruct </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lim_sec_sol</td><td>limits of m_X (pol. flux) or n_X (tor. flux) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lim_pos</td><td>position limits of subset of data </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="PB3D__ops_8f90_source.html#l01359">1359</a> of file <a class="el" href="PB3D__ops_8f90_source.html">PB3D_ops.f90</a>.</p>
<div id="dynsection-10" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-10-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-10-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-10-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacepb3d__ops_ae7afc544227f34f2877eb5a14d620823_cgraph.svg" width="1434" height="483"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-11" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-11-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-11-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-11-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacepb3d__ops_ae7afc544227f34f2877eb5a14d620823_icgraph.svg" width="824" height="212"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a281c496a42c4ea46606e929e10d51582"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a281c496a42c4ea46606e929e10d51582">&#9670;&nbsp;</a></span>reconstruct_pb3d_vac()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public pb3d_ops::reconstruct_pb3d_vac </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structvac__vars_1_1vac__type.html">vac_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>vac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>data_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>rich_lvl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reconstructs the vacuum variables from PB3D HDF5 output. </p>
<p>Also, if <code>rich_lvl</code> is provided, <code>_R_[rich_lvl]</code> is appended to the data name if it is &gt; 0.</p>
<dl class="section return"><dt>Returns</dt><dd>ierr </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">vac</td><td>vacuum variables </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data_name</td><td>name to reconstruct </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rich_lvl</td><td>Richardson level to reconstruct </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="PB3D__ops_8f90_source.html#l01228">1228</a> of file <a class="el" href="PB3D__ops_8f90_source.html">PB3D_ops.f90</a>.</p>
<div id="dynsection-12" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-12-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-12-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-12-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacepb3d__ops_a281c496a42c4ea46606e929e10d51582_cgraph.svg" width="1490" height="612"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-13" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-13-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-13-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-13-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacepb3d__ops_a281c496a42c4ea46606e929e10d51582_icgraph.svg" width="834" height="147"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a8e87e553956f0dc4371d85b008e5e131"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e87e553956f0dc4371d85b008e5e131">&#9670;&nbsp;</a></span>reconstruct_pb3d_x_1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public pb3d_ops::reconstruct_pb3d_x_1 </td>
          <td>(</td>
          <td class="paramtype">type(modes_type), intent(in)&#160;</td>
          <td class="paramname"><em>mds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structgrid__vars_1_1grid__type.html">grid_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>grid_X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(x_1_type), intent(inout)&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>data_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>rich_lvl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>tot_rich</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(2), intent(in), optional&#160;</td>
          <td class="paramname"><em>lim_sec_X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(3,2), intent(in), optional&#160;</td>
          <td class="paramname"><em>lim_pos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reconstructs the vectorial perturbation variables from PB3D HDF5 output. </p>
<p>Also, if <code>rich_lvl</code> is provided, <code>_R_[rich_lvl]</code> is appended to the data name if it is &gt; 0.</p>
<p>With <code>tot_rich</code> the information from previous Richardson levels can be combined.</p>
<p>Furthermore, using <code>lim_pos</code>, you can obtain a subset of the data by directly passing its limits to the underlying HDF5 routine. This refers to the position dimensions only. If provided, the normal limits of a divided grid refer to the subset, as in <a class="el" href="namespacegrid__utilities.html#a04f971c38083f873a04eb6568bed466b" title="Copy a grid A to a new grid B, that was not yet initialized.">copy_grid()</a>.</p>
<p><code>lim_sec_X</code>, on the other hand, selects a range of mode numbers.</p>
<dl class="section return"><dt>Returns</dt><dd>ierr </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mds</td><td>general modes variables </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid_x</td><td>perturbation grid </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">x</td><td>vectorial perturbation variables </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data_name</td><td>name to reconstruct </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rich_lvl</td><td>Richardson level to reconstruct </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tot_rich</td><td>whether to combine with previous Richardson levels </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lim_sec_x</td><td>limits of m_X (pol. flux) or n_X (tor. flux) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lim_pos</td><td>position limits of subset of data </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="PB3D__ops_8f90_source.html#l00833">833</a> of file <a class="el" href="PB3D__ops_8f90_source.html">PB3D_ops.f90</a>.</p>
<div id="dynsection-14" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-14-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-14-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-14-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacepb3d__ops_a8e87e553956f0dc4371d85b008e5e131_cgraph.svg" width="1434" height="483"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-15" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-15-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-15-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-15-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacepb3d__ops_a8e87e553956f0dc4371d85b008e5e131_icgraph.svg" width="856" height="215"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="aff64b6722845a07139e2832c0be36145"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff64b6722845a07139e2832c0be36145">&#9670;&nbsp;</a></span>reconstruct_pb3d_x_2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public pb3d_ops::reconstruct_pb3d_x_2 </td>
          <td>(</td>
          <td class="paramtype">type(modes_type), intent(in)&#160;</td>
          <td class="paramname"><em>mds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structgrid__vars_1_1grid__type.html">grid_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>grid_X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(x_2_type), intent(inout)&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>data_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>rich_lvl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>tot_rich</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(2,2), intent(in), optional&#160;</td>
          <td class="paramname"><em>lim_sec_X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(3,2), intent(in), optional&#160;</td>
          <td class="paramname"><em>lim_pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>is_field_averaged</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reconstructs the tensorial perturbation variables from PB3D HDF5 output. </p>
<p>Also, if <code>rich_lvl</code> is provided, <code>_R_[rich_lvl]</code> is appended to the data name if it is &gt; 0.</p>
<p>With <code>tot_rich</code> the information from previous Richardson levels can be combined.</p>
<p>Furthermore, using <code>lim_pos</code>, you can obtain a subset of the data by directly passing its limits to the underlying HDF5 routine. This refers to the position dimensions only. If provided, the normal limits of a divided grid refer to the subset, as in <a class="el" href="namespacegrid__utilities.html#a04f971c38083f873a04eb6568bed466b" title="Copy a grid A to a new grid B, that was not yet initialized.">copy_grid()</a>.</p>
<p><code>lim_sec_X</code>, on the other hand, selects a range of mode numbers.</p>
<dl class="section note"><dt>Note</dt><dd>The tensorial perturbation type can also be used for field- aligned variables, in which case the first index is assumed to have dimension 1 only. This can be triggered using <code>is_field_averaged</code>.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>ierr </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mds</td><td>general modes variables </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid_x</td><td>perturbation grid </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">x</td><td>tensorial perturbation vars </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data_name</td><td>name to reconstruct </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rich_lvl</td><td>Richardson level to reconstruct </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tot_rich</td><td>whether to combine with previous Richardson levels </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lim_sec_x</td><td>limits of m_X (pol flux) or n_X (tor flux) for both dimensions </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lim_pos</td><td>position limits of subset of data </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">is_field_averaged</td><td>if field-averaged, only one dimension for first index </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="PB3D__ops_8f90_source.html#l00992">992</a> of file <a class="el" href="PB3D__ops_8f90_source.html">PB3D_ops.f90</a>.</p>
<div id="dynsection-16" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-16-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-16-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-16-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacepb3d__ops_aff64b6722845a07139e2832c0be36145_cgraph.svg" width="1490" height="612"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-17" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-17-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-17-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-17-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacepb3d__ops_aff64b6722845a07139e2832c0be36145_icgraph.svg" width="824" height="75"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<address class="footer"><small>
<center>this documentation was created with <a href="http://www.doxygen.org/index.html">Doxygen 1.8.17</a> by <a href="mailto:weyenst@gmail.com">Toon Weyens</a></center>
</small></address>
</body>
</html>
