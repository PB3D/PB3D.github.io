<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PB3D: vac_utilities Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PB3D
   &#160;<span id="projectnumber">[2.34]</span>
   </div>
   <div id="projectbrief">Ideal linear high-n MHD stability in 3-D</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">vac_utilities Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Numerical utilities related to the vacuum response.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:aa8859980354d180445ed0437d7f51bcd"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevac__utilities.html#aa8859980354d180445ed0437d7f51bcd">calc_gh_int_1</a> (G, H, x_s, x_in, norm_s, h_fac_in, step_size, tol)</td></tr>
<tr class="memdesc:aa8859980354d180445ed0437d7f51bcd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate G_ij and H_ij on an interval for field line aligned configurations.  <a href="#aa8859980354d180445ed0437d7f51bcd">More...</a><br /></td></tr>
<tr class="separator:aa8859980354d180445ed0437d7f51bcd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af387fcaa54ec681e55d6eb685ad622bd"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevac__utilities.html#af387fcaa54ec681e55d6eb685ad622bd">calc_gh_int_2</a> (G, H, t_s, t_in, x_s, x_in, norm_s, norm_in, Aij, ql, tol, b_coeff, n_tor)</td></tr>
<tr class="memdesc:af387fcaa54ec681e55d6eb685ad622bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate G_ij and H_ij on an interval for axisymmetric configurations.  <a href="#af387fcaa54ec681e55d6eb685ad622bd">More...</a><br /></td></tr>
<tr class="separator:af387fcaa54ec681e55d6eb685ad622bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05e8e1f24569b4bff05e61a867268fc3"><td class="memItemLeft" align="right" valign="top">integer function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevac__utilities.html#a05e8e1f24569b4bff05e61a867268fc3">vec_dis2loc</a> (ctxt, vec_dis, lims, vec_loc, proc)</td></tr>
<tr class="memdesc:a05e8e1f24569b4bff05e61a867268fc3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gathers a distributed vector on a single process.  <a href="#a05e8e1f24569b4bff05e61a867268fc3">More...</a><br /></td></tr>
<tr class="separator:a05e8e1f24569b4bff05e61a867268fc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae70e8a1fc132ba79a9a4f49f4944a352"><td class="memItemLeft" align="right" valign="top">integer function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevac__utilities.html#ae70e8a1fc132ba79a9a4f49f4944a352">mat_dis2loc</a> (ctxt, mat_dis, lims_r, lims_c, mat_loc, proc)</td></tr>
<tr class="memdesc:ae70e8a1fc132ba79a9a4f49f4944a352"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gathers a distributed vector on a single process.  <a href="#ae70e8a1fc132ba79a9a4f49f4944a352">More...</a><br /></td></tr>
<tr class="separator:ae70e8a1fc132ba79a9a4f49f4944a352"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e7889688701f6ac2fd2c60cdee2b96a"><td class="memItemLeft" align="right" valign="top">integer function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevac__utilities.html#a8e7889688701f6ac2fd2c60cdee2b96a">interlaced_vac_copy</a> (vac_old, vac)</td></tr>
<tr class="memdesc:a8e7889688701f6ac2fd2c60cdee2b96a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copies vacuum variables of a previous level into the appropriate, interlaced place of a next level.  <a href="#a8e7889688701f6ac2fd2c60cdee2b96a">More...</a><br /></td></tr>
<tr class="separator:a8e7889688701f6ac2fd2c60cdee2b96a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Numerical utilities related to the vacuum response. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="namespacevac__ops.html" title="Operations and variables pertaining to the vacuum response. ">vac_ops</a> for information. </dd></dl>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="aa8859980354d180445ed0437d7f51bcd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8859980354d180445ed0437d7f51bcd">&#9670;&nbsp;</a></span>calc_gh_int_1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public vac_utilities::calc_gh_int_1 </td>
          <td>(</td>
          <td class="paramtype">real(dp), dimension(2), intent(inout)&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(2), intent(inout)&#160;</td>
          <td class="paramname"><em>H</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(2,3), intent(in)&#160;</td>
          <td class="paramname"><em>x_s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>x_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(2,3), intent(in)&#160;</td>
          <td class="paramname"><em>norm_s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(4), intent(in)&#160;</td>
          <td class="paramname"><em>h_fac_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(2), intent(in)&#160;</td>
          <td class="paramname"><em>step_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>tol</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate G_ij and H_ij on an interval for field line aligned configurations. </p>
<p>The indices for the source variables are <code>[left:right,dim]</code> where <code>dim</code> is the Cartesian dimension. The same holds for <code>ql</code>.</p>
<p>For subintegrals close to the singularity, the procedure uses the analytical approximation.</p>
<dl class="section note"><dt>Note</dt><dd>This routine does not calculate the contribution \(2\beta\).</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x_s</td><td>position vector at left and right limit of source interval</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x_in</td><td>position vector at which to calculate influence</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">norm_s</td><td>normal vector at left and right limit of source interval</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">h_fac_in</td><td>metric factors at which to calculate influence</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">step_size</td><td>step sizes in parallel direction and alpha</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tol</td><td>tolerance on distance between points </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="vac__utilities_8f90_source.html#l00033">33</a> of file <a class="el" href="vac__utilities_8f90_source.html">vac_utilities.f90</a>.</p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacevac__utilities_aa8859980354d180445ed0437d7f51bcd_icgraph.svg" width="1219" height="94"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="af387fcaa54ec681e55d6eb685ad622bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af387fcaa54ec681e55d6eb685ad622bd">&#9670;&nbsp;</a></span>calc_gh_int_2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public vac_utilities::calc_gh_int_2 </td>
          <td>(</td>
          <td class="paramtype">real(dp), dimension(2), intent(inout)&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(2), intent(inout)&#160;</td>
          <td class="paramname"><em>H</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(2), intent(in)&#160;</td>
          <td class="paramname"><em>t_s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>t_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(2,2), intent(in)&#160;</td>
          <td class="paramname"><em>x_s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(2), intent(in)&#160;</td>
          <td class="paramname"><em>x_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(2,2), intent(in)&#160;</td>
          <td class="paramname"><em>norm_s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(2), intent(in)&#160;</td>
          <td class="paramname"><em>norm_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(2), intent(in)&#160;</td>
          <td class="paramname"><em>Aij</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(2,2), intent(in)&#160;</td>
          <td class="paramname"><em>ql</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>tol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(2), intent(in)&#160;</td>
          <td class="paramname"><em>b_coeff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>n_tor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate G_ij and H_ij on an interval for axisymmetric configurations. </p>
<p>The indices for the source variables are <code>[left:right,dim]</code> where <code>dim</code> is the Cartesian dimension. The same holds for <code>ql</code>.</p>
<p>For subintegrals close to the singularity (i.e. where the tolerance is no being met), the routine approximates the toroidal functions with the analytical approximation. If one of the boundaries of the subintegral is far enough from the singularity, there is an additional contribution due to the difference between the actual toroidal function and the approximation. This contribution is zero if both boundaries are close, because in this case it is assumed that the entire integral is given by the analytical approximation.</p>
<dl class="section note"><dt>Note</dt><dd>This routine does not calculate the contribution \(2\beta\).</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">t_s</td><td>pol. angle at left and right limit of source interval</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">t_in</td><td>pol. angle at which to calculate influence</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x_s</td><td>position vector at left and right limit of source interval</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x_in</td><td>position vector at which to calculate influence</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">norm_s</td><td>normal vector at left and right limit of source interval</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">norm_in</td><td>normal vector at which to calculate influence</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">aij</td><td>Aij helper variable for H</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ql</td><td>ql for n-1 and n at left and right limit of source interval</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tol</td><td>tolerance on rho2</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">b_coeff</td><td>\(b = \sum_{k=1}^n \frac{2}{2k-1}\) for n and n-1</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_tor</td><td>toroidal mode number </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="vac__utilities_8f90_source.html#l00099">99</a> of file <a class="el" href="vac__utilities_8f90_source.html">vac_utilities.f90</a>.</p>
<div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacevac__utilities_af387fcaa54ec681e55d6eb685ad622bd_icgraph.svg" width="1219" height="94"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a8e7889688701f6ac2fd2c60cdee2b96a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e7889688701f6ac2fd2c60cdee2b96a">&#9670;&nbsp;</a></span>interlaced_vac_copy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public vac_utilities::interlaced_vac_copy </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structvac__vars_1_1vac__type.html">vac_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>vac_old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structvac__vars_1_1vac__type.html">vac_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>vac</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Copies vacuum variables of a previous level into the appropriate, interlaced place of a next level. </p>
<p>This is done by multiplying left by \(\overline{\text{T}}\) and right by \(\overline{\text{T}}^T\) with </p><p class="formulaDsp">
\[ a_{ij} = \left\{\begin{aligned} 1 \quad &amp;\text{for} \left(i,j\right) = \left(2j-1+(i-1)n_\text{old},j+(i-1)n_\text{old}\right) \\ 0 \quad &amp;\text{otherwise} \end{aligned}\right. \]
</p>
<p> where \(i\) ranges from \(1\) to \(n_\text{old}\) and \(j\) from \(1\) to \(m_\text{old}\), with the size of \(\overline{\text{T}}\) equal to \(n_\text{new} \times n_\text{old} \) where \(n\) refers to <code>n_bnd(1)</code> and \(m\) to <code>n_bnd(2)</code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">vac_old</td><td>old vacuum</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">vac</td><td>vacuum </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="vac__utilities_8f90_source.html#l00355">355</a> of file <a class="el" href="vac__utilities_8f90_source.html">vac_utilities.f90</a>.</p>
<div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacevac__utilities_a8e7889688701f6ac2fd2c60cdee2b96a_cgraph.svg" width="1180" height="374"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacevac__utilities_a8e7889688701f6ac2fd2c60cdee2b96a_icgraph.svg" width="814" height="58"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ae70e8a1fc132ba79a9a4f49f4944a352"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae70e8a1fc132ba79a9a4f49f4944a352">&#9670;&nbsp;</a></span>mat_dis2loc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public vac_utilities::mat_dis2loc </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ctxt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>mat_dis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>lims_r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>lims_c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>mat_loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>proc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gathers a distributed vector on a single process. </p>
<dl class="section see"><dt>See also</dt><dd>See <a class="el" href="namespacevac__utilities.html#a05e8e1f24569b4bff05e61a867268fc3" title="Gathers a distributed vector on a single process. ">vec_dis2loc()</a> for exaplanation.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctxt</td><td>context for matrix</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mat_dis</td><td>distributed matrix</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lims_r</td><td>limits for different subrows</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lims_c</td><td>limits for different subcolumns</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">mat_loc</td><td>local matrix</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">proc</td><td>which process receives result </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="vac__utilities_8f90_source.html#l00277">277</a> of file <a class="el" href="vac__utilities_8f90_source.html">vac_utilities.f90</a>.</p>
<div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacevac__utilities_ae70e8a1fc132ba79a9a4f49f4944a352_cgraph.svg" width="408" height="58"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacevac__utilities_ae70e8a1fc132ba79a9a4f49f4944a352_icgraph.svg" width="1068" height="190"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a05e8e1f24569b4bff05e61a867268fc3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05e8e1f24569b4bff05e61a867268fc3">&#9670;&nbsp;</a></span>vec_dis2loc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public vac_utilities::vec_dis2loc </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ctxt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>vec_dis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>lims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>vec_loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>proc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gathers a distributed vector on a single process. </p>
<p>For the distributed vector, the limits of the different subrows need to be provided, as discussed in <a class="el" href="namespacevac__vars.html#a81df0b01b0c2bf8072453f4ca12e2d5e" title="Initializes a vacuum type. ">init_vac()</a>.</p>
<p>By default, the result lands on the master process, but this can be changed using <code>proc</code>. If it is negative, all processes receive the result. In any case, <code>vec_loc</code> will be utilized.</p>
<dl class="section note"><dt>Note</dt><dd><code>vec_loc</code> needs to be allocated to the total dimensions, even when the results is not received by the process.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctxt</td><td>context for vector</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">vec_dis</td><td>distributed vector</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lims</td><td>limits for different subrows</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">vec_loc</td><td>local vector</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">proc</td><td>which process receives result </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="vac__utilities_8f90_source.html#l00223">223</a> of file <a class="el" href="vac__utilities_8f90_source.html">vac_utilities.f90</a>.</p>
<div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacevac__utilities_a05e8e1f24569b4bff05e61a867268fc3_cgraph.svg" width="408" height="58"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacevac__utilities_a05e8e1f24569b4bff05e61a867268fc3_icgraph.svg" width="1211" height="94"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<address class="footer"><small>
<center>this documentation was created with <a href="http://www.doxygen.org/index.html">Doxygen 1.8.13</a> by <a href="mailto:weyenst@gmail.com">Toon Weyens</a></center>
</small></address>
</body>
</html>
