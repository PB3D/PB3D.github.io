<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.16.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PB3D: Installation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PB3D<span id="projectnumber">&#160;[2.47]</span>
   </div>
   <div id="projectbrief">Ideal linear high-n MHD stability in 3-D</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.16.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">Installation </div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul>
  <li class="level1">
    <a href="#installation_introduction">Introduction </a>
  </li>
  <li class="level1">
    <a href="#installation_compilation">Compilation </a>
  </li>
  <li class="level1">
    <a href="#installation_makefile">Makefile Example </a>
  </li>
</ul>
</div>
<div class="textblock"><h1 class="doxsection"><a class="anchor" id="installation_introduction"></a>
Introduction</h1>
<p>PB3D is written in Fortran, and makes use of multiple numerical libraries:</p><ul>
<li><a href="http://www.netlib.org/lapack/">blas / lapack</a><ul>
<li>for basic linear algebra</li>
</ul>
</li>
<li><a href="http://www.netlib.org/scalapack/">pblas / blacs / scalapack</a><ul>
<li>for parallelized basic linear algebra</li>
</ul>
</li>
<li><a href="https://www.hdfgroup.org/HDF5/">HDF5</a><ul>
<li>for storage files</li>
<li>works in parallel</li>
</ul>
</li>
<li><a href="https://www.unidata.ucar.edu/software/netcdf/">NetCDF</a><ul>
<li>to read input of VMEC</li>
<li>sequential</li>
</ul>
</li>
<li><a href="https://www.mcs.anl.gov/petsc/">PETSc</a> / <a href="http://slepc.upv.es/">SLEPc</a><ul>
<li>for linear algebra of large, sparse matrices</li>
<li>can reach \(\sim \mathcal{O} (n)\) complexity</li>
<li>Minimal installation instructions:<ol type="1">
<li>Configure PETSc using <span class="tt">./configure PETSC_ARCH=complex COPTFLAGS=-O3 CXXOPTFLAGS=-O3 FOPTFLAGS=-O3 \\endiskip</span><br  />
 <span class="tt">--with-scalar-type=complex \\endiskip</span><br  />
 <span class="tt">--download-metis \\endiskip</span><br  />
 <span class="tt">--download-mumps \\endiskip</span><br  />
 <span class="tt">--download-parmetis \\endiskip</span><br  />
 <span class="tt">--with-scalapack-lib="-L[SCALAPACKDIR]/lib -lscalapack" \\endiskip</span><br  />
 <span class="tt">--with-valgrind-dir=/usr \\endiskip</span><br  />
 <span class="tt">--with-debugging=no \\endiskip</span><br  />
 <span class="tt">--with-fortran-kernels=1</span><br  />
 (If you want debug, remove <span class="tt">--with-debugging=no</span>, <span class="tt">--with-fortran-kernels=1</span>, COPTSFLAGS, CXXOPTFLAGS and FOPTFLAGS, and change PETSC_ARCH to <span class="tt">debug-complex</span>.)<br  />
 (If you use a different HDF5, add <span class="tt">--with-hdf5-dir=[HDF5DIR]</span>.)</li>
<li>follow instructions to do makes and tests.</li>
<li>Set global variables <span class="tt">export SLEPC_DIR=[SLEPC DIR]</span>, <span class="tt">export PETSC_DIR=[PETSC_DIR]</span> and <span class="tt">export PETSC_ARCH=[debug-]complex</span> (depending on whether it is debug or not).</li>
<li>Configure SLEPc using <span class="tt">./configure</span></li>
<li>follow instructions to do makes and tests</li>
</ol>
</li>
</ul>
</li>
<li><a href="http://portal.nersc.gov/project/sparse/strumpack/">StrumPack</a><ul>
<li>for linear algebra of structured matrices <a class="el" href="citelist.html#CITEREF_ambikasaran2013">[1]</a></li>
<li>the vacuum potential energy perturbation calculations use such matrices as they are generated with a \(1/r\) kernel.</li>
<li>can reach \(\sim \mathcal{O} (n \log(n))\) complexity</li>
<li>we use the dense version of the package, which for Fortran is 1.1.1.</li>
<li>Minimal installation instructions:<ol type="1">
<li><a href="http://portal.nersc.gov/project/sparse/strumpack/STRUMPACK-Dense-1.1.1.tar.gz">Download</a>, untar and go to root folder.</li>
<li>Go to examples, copy <span class="tt">Makefile.gnu</span> to <span class="tt">Makefile.inc</span> and adapt:<ol type="a">
<li>for example, it might be necessary to add <span class="tt">-lblacs</span> before <span class="tt">-lscalapack</span></li>
<li>if you use intel, have a look at the <a href="https://software.intel.com/en-us/articles/intel-mkl-link-line-advisor">link line advisor</a>, and update the <span class="tt">LIB</span></li>
<li>possibly, you might have to set the <span class="tt">CC</span> and <span class="tt">FC</span> compiler commands to, for example, <span class="tt">mpicc</span> respectively <span class="tt">mpiifort</span></li>
</ol>
</li>
<li>Create directories <span class="tt">lib</span> and <span class="tt">inc</span>.</li>
<li>Run <span class="tt">make f90_example</span></li>
<li>Make a library of <span class="tt">StrumpackDensePackage.o</span> using <span class="tt">ar -rcs libstrumpack.a  *.o</span> in src.</li>
<li>In inc, create a symlink <span class="tt">libstrumpack.a</span> to <span class="tt">libstrumpack.a</span> in src.</li>
<li>In lib, create a symlink <span class="tt">strumpackdensepackage.mod</span> to <span class="tt">strumpackdensepackage.mod</span> in examples.</li>
</ol>
</li>
</ul>
</li>
<li><a href="https://bitbucket.org/lazerson_princeton/stellopt/wiki/Home">libstell</a><ul>
<li>part of Stellopt suite, which contains VMEC</li>
<li>provides routines to read VMEC output data</li>
</ul>
</li>
<li><a href="https://w3.pppl.gov/ntcc/PSPLINE/">pspline</a><ul>
<li>Princeton Spline and Hermite Cubic Interpolation Routines</li>
<li>Minimal installation instructions:<ol type="1">
<li>Export <code>FFLAGS</code> en <code>CFLAGS</code> if you want to optimize:<ul>
<li>copy <span class="tt">share/Make.overwrite.sample</span> to <span class="tt">share/Make.overwrite</span></li>
<li>Run the gmake below and note the flags, then edit these and put them in <span class="tt">share/Make.overwrite</span></li>
<li>if GCC:<ul>
<li><span class="tt">FFLAGS = -c -O3 -m64 -fno-range-check -fdollar-ok -cpp ; export FFLAGS</span></li>
<li><span class="tt">CFLAGS = -c -O3 -m64 ; export CFLAGS</span></li>
<li><span class="tt">CXXFLAGS = -c -O3 -m64 ; export CXXFLAGS</span></li>
</ul>
</li>
<li>if Intel:<ul>
<li><span class="tt">FFLAGS = -c -O3 -nowarn -ftz -auto-scalar -traceback -align dcommons</span></li>
<li><span class="tt">MPI_FFLAGS =  -c -O3 -nowarn  -ftz -traceback -align dcommons -auto-scalar</span> (possibly add FC=mpiifort, <code>CXX=mpicpc</code>, <code>CC=mpiicc</code> if on a cluster)</li>
</ul>
</li>
</ul>
</li>
<li>Compile with <span class="tt">gmake NETCDF_DIR= FORTRAN_VARIANT=[VARIANT]</span> with <span class="tt">[VARIANT]</span> either <span class="tt">GCC</span> or <span class="tt">Intel</span> (add <span class="tt">DEBUG=1</span> and remove the FLAGS if debug wanted). Possibly also add <span class="tt">OBJ=$[COMP_DIR]</span> if on a cluster, with <span class="tt">[COMP_DIR]</span> the directory where to put the resulting library.</li>
<li>Run tests from <code>README_Pspline</code>.</li>
</ol>
</li>
</ul>
</li>
</ul>
<p>They should probably be installed in this order. On linux distributions such as Ubuntu, they may be available as packages.</p>
<p>Furthermore, PB3D comes bundled with some other, smaller libraries:</p><ul>
<li><a href="http://www.netlib.org/fftpack/">fftpack</a><ul>
<li>to calculate the fast Fourier transform</li>
</ul>
</li>
<li><a href="http://foul.sourceforge.net/">foul</a><ul>
<li>the Fortran Output Library</li>
</ul>
</li>
</ul>
<p>These do not have to be installed separately.</p>
<h1 class="doxsection"><a class="anchor" id="installation_compilation"></a>
Compilation</h1>
<p>When all dependencies are satisfied, the program is then compiled in the standard way:</p><ul>
<li>Including the headers of all the libraries in the compilation of the object files:<ul>
<li>This is done using <span class="tt">-I[path_to_library]</span>.</li>
<li>Make sure you add the <span class="tt">-o</span> option to create only object files.</li>
</ul>
</li>
<li>Linking with the actual libraries<ul>
<li>This is done using <span class="tt">-L[path_to_library] -l[library_name]</span>.</li>
</ul>
</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="installation_makefile"></a>
Makefile Example</h1>
<div class="fragment"><div class="line"><span class="lineno">    1</span>##############################################################################</div>
<div class="line"><span class="lineno">    2</span>#</div>
<div class="line"><span class="lineno">    3</span>#   Example makefile for the program PB3D (Peeling Ballooning in 3D)</div>
<div class="line"><span class="lineno">    4</span>#   \author Author: Toon Weyens</div>
<div class="line"><span class="lineno">    5</span>#</div>
<div class="line"><span class="lineno">    6</span>#   Don&#39;t forget to set the directories:</div>
<div class="line"><span class="lineno">    7</span>#       - LIBSTELL_DIR</div>
<div class="line"><span class="lineno">    8</span>#       - HDF5_DIR</div>
<div class="line"><span class="lineno">    9</span>#       - NETCDFF_DIR (note: Fortran library)</div>
<div class="line"><span class="lineno">   10</span>#       - PETSC_DIR</div>
<div class="line"><span class="lineno">   11</span>#       - SLEPC_DIR</div>
<div class="line"><span class="lineno">   12</span>#       - STRUMPACK_DIR</div>
<div class="line"><span class="lineno">   13</span>##############################################################################</div>
<div class="line"><span class="lineno">   14</span> </div>
<div class="line"><span class="lineno">   15</span>##############################################################################</div>
<div class="line"><span class="lineno">   16</span>#   Include</div>
<div class="line"><span class="lineno">   17</span>##############################################################################</div>
<div class="line"><span class="lineno">   18</span>## [PETSc and SLEPc trick]</div>
<div class="line"><span class="lineno">   19</span>include  $(PETSC_DIR)/lib/petsc/conf/variables</div>
<div class="line"><span class="lineno">   20</span>include  $(SLEPC_DIR)/lib/slepc/conf/slepc_variables</div>
<div class="line"><span class="lineno">   21</span>## [PETSc and SLEPc trick]</div>
<div class="line"><span class="lineno">   22</span> </div>
<div class="line"><span class="lineno">   23</span>## [PETSc and SLEPc trick inc]</div>
<div class="line"><span class="lineno">   24</span>INCLUDE = $(PETSC_FC_INCLUDES) $(SLEPC_INCLUDE)</div>
<div class="line"><span class="lineno">   25</span>## [PETSc and SLEPc trick inc]</div>
<div class="line"><span class="lineno">   26</span>## [Libstell special]</div>
<div class="line"><span class="lineno">   27</span>INCLUDE += -I$(LIBSTELL_DIR)/libstell_dir</div>
<div class="line"><span class="lineno">   28</span>## [Libstell special]</div>
<div class="line"><span class="lineno">   29</span>INCLUDE += -I$(STRUMPACK_DIR)/include</div>
<div class="line"><span class="lineno">   30</span>## [PB3D include]</div>
<div class="line"><span class="lineno">   31</span>INCLUDE += -I$(PB3D_DIR)/include</div>
<div class="line"><span class="lineno">   32</span>## [PB3D include]</div>
<div class="line"><span class="lineno">   33</span>INCLUDE += -I/usr/include/hdf5/openmpi</div>
<div class="line"><span class="lineno">   34</span> </div>
<div class="line"><span class="lineno">   35</span>##############################################################################</div>
<div class="line"><span class="lineno">   36</span>#   Link</div>
<div class="line"><span class="lineno">   37</span>##############################################################################</div>
<div class="line"><span class="lineno">   38</span>## [PB3D libraries]</div>
<div class="line"><span class="lineno">   39</span>LIB_INTERNAL = libdfftpack.a libfoul.a libbspline.a</div>
<div class="line"><span class="lineno">   40</span>## [PB3D libraries]</div>
<div class="line"><span class="lineno">   41</span> </div>
<div class="line"><span class="lineno">   42</span>LINK := $(LIB_INTERNAL)</div>
<div class="line"><span class="lineno">   43</span> </div>
<div class="line"><span class="lineno">   44</span>## [PETSc and SLEPc trick lib]</div>
<div class="line"><span class="lineno">   45</span>LINK += $(PETSC_LIB)</div>
<div class="line"><span class="lineno">   46</span>LINK += $(SLEPC_LIB)</div>
<div class="line"><span class="lineno">   47</span>## [PETSc and SLEPc trick lib]</div>
<div class="line"><span class="lineno">   48</span>LINK += $(LIBSTELL_DIR)/libstell.a</div>
<div class="line"><span class="lineno">   49</span>LINK += -L$(STRUMPACK_DIR)/lib -lstrumpack</div>
<div class="line"><span class="lineno">   50</span>LINK += -L$(HDF5_DIR) -lhdf5_fortran -lhdf5</div>
<div class="line"><span class="lineno">   51</span>LINK += -L$(NETCDFF_DIR)/lib -lnetcdff</div>
<div class="line"><span class="lineno">   52</span>LINK += -Wl,-R$(NETCDFF_DIR)/lib</div>
<div class="line"><span class="lineno">   53</span>LINK += -lscalapack -lblacs -lblas -lm</div>
<div class="line"><span class="lineno">   54</span>LINK += -lstdc++ -lmpi_cxx</div>
<div class="line"><span class="lineno">   55</span> </div>
<div class="line"><span class="lineno">   56</span> </div>
<div class="line"><span class="lineno">   57</span>##############################################################################</div>
<div class="line"><span class="lineno">   58</span>#   Compiler</div>
<div class="line"><span class="lineno">   59</span>##############################################################################</div>
<div class="line"><span class="lineno">   60</span>COMPILER=mpifort</div>
<div class="line"><span class="lineno">   61</span> </div>
<div class="line"><span class="lineno">   62</span> </div>
<div class="line"><span class="lineno">   63</span>##############################################################################</div>
<div class="line"><span class="lineno">   64</span>#   Linker</div>
<div class="line"><span class="lineno">   65</span>##############################################################################</div>
<div class="line"><span class="lineno">   66</span>LINKER=mpifort</div>
<div class="line"><span class="lineno">   67</span> </div>
<div class="line"><span class="lineno">   68</span> </div>
<div class="line"><span class="lineno">   69</span>##############################################################################</div>
<div class="line"><span class="lineno">   70</span>#   Compiler flags</div>
<div class="line"><span class="lineno">   71</span>#   options (used with -D[name]):</div>
<div class="line"><span class="lineno">   72</span>#       ldebug: debug</div>
<div class="line"><span class="lineno">   73</span>#       lIB: infiniband</div>
<div class="line"><span class="lineno">   74</span>#       lwith_gnu: use GNU compiler [default]</div>
<div class="line"><span class="lineno">   75</span>#       lwith_intel: use INTEL compiler, (checked for version 12.0.2)</div>
<div class="line"><span class="lineno">   76</span>#   note: INTEL warning 6536 is suppressed, which informs about extra &quot;USE&quot;.</div>
<div class="line"><span class="lineno">   77</span>#   note: INTEL warning 6843 is suppressed, which informs about empty</div>
<div class="line"><span class="lineno">   78</span>#       intent(out) variables</div>
<div class="line"><span class="lineno">   79</span>##############################################################################</div>
<div class="line"><span class="lineno">   80</span>COMP_FLAGS = -finit-real=snan -g -Og -Wall -Wextra -pedantic \</div>
<div class="line"><span class="lineno">   81</span>    -fimplicit-none -fbacktrace -fno-omit-frame-pointer \</div>
<div class="line"><span class="lineno">   82</span>    -fcheck=all -cpp -Dldebug# debug, profiling with gprof2dot, GCC</div>
<div class="line"><span class="lineno">   83</span>#COMP_FLAGS = -O3 -fbacktrace -g -fimplicit-none -fno-omit-frame-pointer \</div>
<div class="line"><span class="lineno">   84</span>    #-cpp# optimized, GCC</div>
<div class="line"><span class="lineno">   85</span> </div>
<div class="line"><span class="lineno">   86</span>#COMP_FLAGS = -O0 -DlIB -Dldebug -g -heap-arrays 100 -recursive \</div>
<div class="line"><span class="lineno">   87</span>    #-ftrapuv -check bounds -check uninit -traceback -implicitnone \</div>
<div class="line"><span class="lineno">   88</span>    #-fno-omit-frame-pointer -cpp -Dlwith_intel -diag-disable 6536 \</div>
<div class="line"><span class="lineno">   89</span>    #-diag-disable 6843# debug, profiling with gprof2dot, INTEL</div>
<div class="line"><span class="lineno">   90</span>#COMP_FLAGS = -O3 -DlIB -traceback -g -heap-arrays 100 -recursive \</div>
<div class="line"><span class="lineno">   91</span>    #-implicitnone -fno-omit-frame-pointer -cpp -Dlwith_intel \</div>
<div class="line"><span class="lineno">   92</span>    #-diag-disable 6536 -diag-disable 6843# optimized, INTEL</div>
<div class="line"><span class="lineno">   93</span> </div>
<div class="line"><span class="lineno">   94</span>COMP_FLAGS_EX= -O2 -w</div>
<div class="line"><span class="lineno">   95</span> </div>
<div class="line"><span class="lineno">   96</span>COMP_FLAGS_F= -O2 -funroll-loops -fexpensive-optimizations</div>
<div class="line"><span class="lineno">   97</span> </div>
<div class="line"><span class="lineno">   98</span> </div>
<div class="line"><span class="lineno">   99</span>##############################################################################</div>
<div class="line"><span class="lineno">  100</span>#   Link flags</div>
<div class="line"><span class="lineno">  101</span>##############################################################################</div>
<div class="line"><span class="lineno">  102</span>LINK_FLAGS = -fPIC -finit-real=snan# debug</div>
<div class="line"><span class="lineno">  103</span>#LINK_FLAGS = -fPIC# optimized</div>
<div class="line"><span class="lineno">  104</span> </div>
<div class="line"><span class="lineno">  105</span> </div>
<div class="line"><span class="lineno">  106</span>##############################################################################</div>
<div class="line"><span class="lineno">  107</span>#   Prepare</div>
<div class="line"><span class="lineno">  108</span>##############################################################################</div>
<div class="line"><span class="lineno">  109</span># Add &quot;Modules&quot; and &quot;Libraries&quot; to the search path for the prerequisites</div>
<div class="line"><span class="lineno">  110</span>VPATH = Modules:Libraries</div>
<div class="line"><span class="lineno">  111</span> </div>
<div class="line"><span class="lineno">  112</span># Contains list of source files (.o) and dependencies</div>
<div class="line"><span class="lineno">  113</span>DEPLIST = PB3D.dep</div>
<div class="line"><span class="lineno">  114</span>OBJLIST = ObjectList# defines &quot;ObjectFiles&quot;</div>
<div class="line"><span class="lineno">  115</span> </div>
<div class="line"><span class="lineno">  116</span># Includes source files and dependency list</div>
<div class="line"><span class="lineno">  117</span>include $(DEPLIST)# Dependencies of all the objects</div>
<div class="line"><span class="lineno">  118</span>include $(OBJLIST)# Names of all the objects</div>
<div class="line"><span class="lineno">  119</span> </div>
<div class="line"><span class="lineno">  120</span> </div>
<div class="line"><span class="lineno">  121</span>##############################################################################</div>
<div class="line"><span class="lineno">  122</span>#   Rules</div>
<div class="line"><span class="lineno">  123</span>##############################################################################</div>
<div class="line"><span class="lineno">  124</span>all:    PB3D POST</div>
<div class="line"><span class="lineno">  125</span> </div>
<div class="line"><span class="lineno">  126</span>PB3D:   $(ObjectFiles) $(LIB_INTERNAL) PB3D.o</div>
<div class="line"><span class="lineno">  127</span>    $(LINKER) -o $@ $(ObjectFiles) PB3D.o $(LINK) $(LINK_FLAGS)</div>
<div class="line"><span class="lineno">  128</span> </div>
<div class="line"><span class="lineno">  129</span>POST:   $(ObjectFiles) $(LIB_INTERNAL) POST.o</div>
<div class="line"><span class="lineno">  130</span>    $(LINKER) -o $@ $(ObjectFiles) POST.o $(LINK) $(LINK_FLAGS)</div>
<div class="line"><span class="lineno">  131</span> </div>
<div class="line"><span class="lineno">  132</span>libdfftpack.a:  dfft.o</div>
<div class="line"><span class="lineno">  133</span>    ar -rcs libdfftpack.a dfft.o</div>
<div class="line"><span class="lineno">  134</span> </div>
<div class="line"><span class="lineno">  135</span>libfoul.a:  foul.o</div>
<div class="line"><span class="lineno">  136</span>    ar -rcs libfoul.a foul.o</div>
<div class="line"><span class="lineno">  137</span> </div>
<div class="line"><span class="lineno">  138</span>libbspline.a:   bspline_sub_module.o</div>
<div class="line"><span class="lineno">  139</span>    ar -rcs libbspline.a bspline_sub_module.o</div>
<div class="line"><span class="lineno">  140</span> </div>
<div class="line"><span class="lineno">  141</span>%.o: %.f90</div>
<div class="line"><span class="lineno">  142</span>    $(COMPILER) $(INCLUDE) $(COMP_FLAGS) -c $&lt;</div>
<div class="line"><span class="lineno">  143</span> </div>
<div class="line"><span class="lineno">  144</span>%.o: %.f</div>
<div class="line"><span class="lineno">  145</span>    $(COMPILER) $(COMP_FLAGS_F) -c $&lt;</div>
<div class="line"><span class="lineno">  146</span> </div>
<div class="line"><span class="lineno">  147</span>dfft.o: dfft.f</div>
<div class="line"><span class="lineno">  148</span>    $(COMPILER) $(COMP_FLAGS_EX) -c $&lt;</div>
<div class="line"><span class="lineno">  149</span> </div>
<div class="line"><span class="lineno">  150</span>foul.o: foul.f90</div>
<div class="line"><span class="lineno">  151</span>    $(COMPILER) $(COMP_FLAGS_EX) -c $&lt;</div>
<div class="line"><span class="lineno">  152</span> </div>
<div class="line"><span class="lineno">  153</span>bspline_sub_module.o: bspline_sub_module.f90</div>
<div class="line"><span class="lineno">  154</span>    $(COMPILER) $(COMP_FLAGS_EX) -c $&lt;</div>
<div class="line"><span class="lineno">  155</span> </div>
<div class="line"><span class="lineno">  156</span>clean:</div>
<div class="line"><span class="lineno">  157</span>    @rm -f *.o *.a *.mod *~ fort.* </div>
<div class="line"><span class="lineno">  158</span> </div>
<div class="line"><span class="lineno">  159</span>clean_all:</div>
<div class="line"><span class="lineno">  160</span>    @rm -f *.o *.mod *~ fort.* PB3D POST</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd><ol type="1">
<li>PETSc and SLEPc don't like to be included in another makefile. The trick is to include two files: <div class="fragment"><div class="line"><span class="lineno">   19</span>include  $(PETSC_DIR)/lib/petsc/conf/variables</div>
<div class="line"><span class="lineno">   20</span>include  $(SLEPC_DIR)/lib/slepc/conf/slepc_variables</div>
</div><!-- fragment --> which will load the variables <code>PETSC_FC_INCLUDES</code> and <code>SLEPC_INCLUDE</code>, used in <div class="fragment"><div class="line"><span class="lineno">   24</span>INCLUDE = $(PETSC_FC_INCLUDES) $(SLEPC_INCLUDE)</div>
</div><!-- fragment --> as well as the variables <code>PETSC_LIB</code> and <code>SLEPC_LIB</code>, used in <div class="fragment"><div class="line"><span class="lineno">   45</span>LINK += $(PETSC_LIB)</div>
<div class="line"><span class="lineno">   46</span>LINK += $(SLEPC_LIB)</div>
</div><!-- fragment --></li>
<li>There are versions of libstell that do not use the standard convention. In this case you have to look for the <span class="tt">*.mod</span> files. In the example makefile this is done with <div class="fragment"><div class="line"><span class="lineno">   27</span>INCLUDE += -I$(LIBSTELL_DIR)/libstell_dir</div>
</div><!-- fragment --> instead of the standard <span class="tt">inc</span> directory.</li>
<li>In <div class="fragment"><div class="line"><span class="lineno">   31</span>INCLUDE += -I$(PB3D_DIR)/include</div>
</div><!-- fragment --> there are includefiles that contain macros and wrappers specifically for PB3D.</li>
<li>In <div class="fragment"><div class="line"><span class="lineno">   39</span>LIB_INTERNAL = libdfftpack.a libfoul.a libbspline.a</div>
</div><!-- fragment --> linking is done with external libraries that are bundled with PB3D. </li>
</ol>
</dd></dl>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<address class="footer"><small>
<center>this documentation was created with <a href="http://www.doxygen.org/index.html">Doxygen 1.16.1</a> by <a href="mailto:weyenst@gmail.com">Toon Weyens</a></center>
</small></address>
</body>
</html>
