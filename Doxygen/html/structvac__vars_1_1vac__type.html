<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.16.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PB3D: vac_vars::vac_type Type Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PB3D<span id="projectnumber">&#160;[2.47]</span>
   </div>
   <div id="projectbrief">Ideal linear high-n MHD stability in 3-D</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.16.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a href="namespacevac__vars.html">vac_vars</a></li><li class="navelem"><a href="structvac__vars_1_1vac__type.html">vac_type</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="structvac__vars_1_1vac__type-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">vac_vars::vac_type Type Reference</div></div>
</div><!--header-->
<div class="contents">

<p>vacuum type  
 <a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-pub-methods" class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:afa967069239b8a72212e3a5cbe57721b" id="r_afa967069239b8a72212e3a5cbe57721b"><td class="memItemLeft">procedure&#160;</td><td class="memItemRight"><a class="el" href="#afa967069239b8a72212e3a5cbe57721b">init</a> (vac, <a class="el" href="#afbd856ce1a362b252a9d8195b83546cd">style</a>, <a class="el" href="#a099ac67e58545d9dd3863d0397f37b05">n_bnd</a>, <a class="el" href="#a75bec679a19120000183f0d0d6fcd880">prim_x</a>, <a class="el" href="#ac337095579ae842776d35a4b975254e8">n_ang</a>, <a class="el" href="#a8cba6ae0e61249966161e44ab1c465fb">jq</a>)</td></tr>
<tr class="memdesc:afa967069239b8a72212e3a5cbe57721b"><td class="mdescLeft">&#160;</td><td class="mdescRight">initialize  <br /></td></tr>
<tr class="memitem:a6b5be1440804ecde87e2fede08ca897b" id="r_a6b5be1440804ecde87e2fede08ca897b"><td class="memItemLeft">procedure&#160;</td><td class="memItemRight"><a class="el" href="#a6b5be1440804ecde87e2fede08ca897b">dealloc</a> (vac)</td></tr>
<tr class="memdesc:a6b5be1440804ecde87e2fede08ca897b"><td class="mdescLeft">&#160;</td><td class="mdescRight">deallocate  <br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-pub-attribs" class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:afbd856ce1a362b252a9d8195b83546cd" id="r_afbd856ce1a362b252a9d8195b83546cd"><td class="memItemLeft">integer&#160;</td><td class="memItemRight"><a class="el" href="#afbd856ce1a362b252a9d8195b83546cd">style</a></td></tr>
<tr class="memdesc:afbd856ce1a362b252a9d8195b83546cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">style of vacuum (1: field-line 3-D, 2: axisymmetric)  <br /></td></tr>
<tr class="memitem:a75bec679a19120000183f0d0d6fcd880" id="r_a75bec679a19120000183f0d0d6fcd880"><td class="memItemLeft">integer&#160;</td><td class="memItemRight"><a class="el" href="#a75bec679a19120000183f0d0d6fcd880">prim_x</a></td></tr>
<tr class="memdesc:a75bec679a19120000183f0d0d6fcd880"><td class="mdescLeft">&#160;</td><td class="mdescRight">primary mode number  <br /></td></tr>
<tr class="memitem:a975901d1517e02c7a78be46054decde0" id="r_a975901d1517e02c7a78be46054decde0"><td class="memItemLeft">integer&#160;</td><td class="memItemRight"><a class="el" href="#a975901d1517e02c7a78be46054decde0">ctxt_hg</a></td></tr>
<tr class="memdesc:a975901d1517e02c7a78be46054decde0"><td class="mdescLeft">&#160;</td><td class="mdescRight">context for H and G  <br /></td></tr>
<tr class="memitem:a099ac67e58545d9dd3863d0397f37b05" id="r_a099ac67e58545d9dd3863d0397f37b05"><td class="memItemLeft">integer&#160;</td><td class="memItemRight"><a class="el" href="#a099ac67e58545d9dd3863d0397f37b05">n_bnd</a></td></tr>
<tr class="memdesc:a099ac67e58545d9dd3863d0397f37b05"><td class="mdescLeft">&#160;</td><td class="mdescRight">number of points in boundary  <br /></td></tr>
<tr class="memitem:aacac3cfc228c0a5de03540bf63bc9014" id="r_aacac3cfc228c0a5de03540bf63bc9014"><td class="memItemLeft">integer&#160;</td><td class="memItemRight"><a class="el" href="#aacac3cfc228c0a5de03540bf63bc9014">bs</a></td></tr>
<tr class="memdesc:aacac3cfc228c0a5de03540bf63bc9014"><td class="mdescLeft">&#160;</td><td class="mdescRight">block size in cyclical storage  <br /></td></tr>
<tr class="memitem:af24c1254132acf04aef2f91952b73243" id="r_af24c1254132acf04aef2f91952b73243"><td class="memItemLeft">integer&#160;</td><td class="memItemRight"><a class="el" href="#af24c1254132acf04aef2f91952b73243">mpi_comm</a></td></tr>
<tr class="memdesc:af24c1254132acf04aef2f91952b73243"><td class="mdescLeft">&#160;</td><td class="mdescRight">communicator for vacuum  <br /></td></tr>
<tr class="memitem:a7d588dd9ece3c1a645329431769c28de" id="r_a7d588dd9ece3c1a645329431769c28de"><td class="memItemLeft">integer, dimension(blacsctxtsize)&#160;</td><td class="memItemRight"><a class="el" href="#a7d588dd9ece3c1a645329431769c28de">desc_h</a></td></tr>
<tr class="memdesc:a7d588dd9ece3c1a645329431769c28de"><td class="mdescLeft">&#160;</td><td class="mdescRight">descriptor for H  <br /></td></tr>
<tr class="memitem:a8c1903cbdc406915f473535daa1cafb7" id="r_a8c1903cbdc406915f473535daa1cafb7"><td class="memItemLeft">integer, dimension(blacsctxtsize)&#160;</td><td class="memItemRight"><a class="el" href="#a8c1903cbdc406915f473535daa1cafb7">desc_g</a></td></tr>
<tr class="memdesc:a8c1903cbdc406915f473535daa1cafb7"><td class="mdescLeft">&#160;</td><td class="mdescRight">descriptor for G  <br /></td></tr>
<tr class="memitem:aaf6def83c79ec72152b8aa27081fde11" id="r_aaf6def83c79ec72152b8aa27081fde11"><td class="memItemLeft">integer, dimension(2)&#160;</td><td class="memItemRight"><a class="el" href="#aaf6def83c79ec72152b8aa27081fde11">n_p</a></td></tr>
<tr class="memdesc:aaf6def83c79ec72152b8aa27081fde11"><td class="mdescLeft">&#160;</td><td class="mdescRight">nr. of processes in grid  <br /></td></tr>
<tr class="memitem:ac337095579ae842776d35a4b975254e8" id="r_ac337095579ae842776d35a4b975254e8"><td class="memItemLeft">integer, dimension(2)&#160;</td><td class="memItemRight"><a class="el" href="#ac337095579ae842776d35a4b975254e8">n_ang</a></td></tr>
<tr class="memdesc:ac337095579ae842776d35a4b975254e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">number of angles (1) and number of field lines (2)  <br /></td></tr>
<tr class="memitem:ae875caaff6d6ddf9bf6abba721f081ec" id="r_ae875caaff6d6ddf9bf6abba721f081ec"><td class="memItemLeft">integer, dimension(2)&#160;</td><td class="memItemRight"><a class="el" href="#ae875caaff6d6ddf9bf6abba721f081ec">ind_p</a></td></tr>
<tr class="memdesc:ae875caaff6d6ddf9bf6abba721f081ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">index of local process in grid  <br /></td></tr>
<tr class="memitem:ad773e9aa724066256c3955a1a98a1d63" id="r_ad773e9aa724066256c3955a1a98a1d63"><td class="memItemLeft">integer, dimension(2)&#160;</td><td class="memItemRight"><a class="el" href="#ad773e9aa724066256c3955a1a98a1d63">n_loc</a></td></tr>
<tr class="memdesc:ad773e9aa724066256c3955a1a98a1d63"><td class="mdescLeft">&#160;</td><td class="mdescRight">local number of rows and columns  <br /></td></tr>
<tr class="memitem:aeb4618332068796eb12784a5b5582416" id="r_aeb4618332068796eb12784a5b5582416"><td class="memItemLeft">integer, dimension(:), allocatable&#160;</td><td class="memItemRight"><a class="el" href="#aeb4618332068796eb12784a5b5582416">sec_x</a></td></tr>
<tr class="memdesc:aeb4618332068796eb12784a5b5582416"><td class="mdescLeft">&#160;</td><td class="mdescRight">secondary mode numbers  <br /></td></tr>
<tr class="memitem:ad4aa76e0d91f32808465d15ac04528ec" id="r_ad4aa76e0d91f32808465d15ac04528ec"><td class="memItemLeft">integer, dimension(:,:), allocatable&#160;</td><td class="memItemRight"><a class="el" href="#ad4aa76e0d91f32808465d15ac04528ec">lims_c</a></td></tr>
<tr class="memdesc:ad4aa76e0d91f32808465d15ac04528ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">column limits for different subrows of G and H  <br /></td></tr>
<tr class="memitem:aac146dc17760b97ff3cb7966cd1b41f9" id="r_aac146dc17760b97ff3cb7966cd1b41f9"><td class="memItemLeft">integer, dimension(:,:), allocatable&#160;</td><td class="memItemRight"><a class="el" href="#aac146dc17760b97ff3cb7966cd1b41f9">lims_r</a></td></tr>
<tr class="memdesc:aac146dc17760b97ff3cb7966cd1b41f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">row limits for different subcolumns of G and H  <br /></td></tr>
<tr class="memitem:a8cba6ae0e61249966161e44ab1c465fb" id="r_a8cba6ae0e61249966161e44ab1c465fb"><td class="memItemLeft">real(dp)&#160;</td><td class="memItemRight"><a class="el" href="#a8cba6ae0e61249966161e44ab1c465fb">jq</a></td></tr>
<tr class="memdesc:a8cba6ae0e61249966161e44ab1c465fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">iota (tor. flux) or q (pol. flux) at edge  <br /></td></tr>
<tr class="memitem:a8a79c1f2b383fda22b5f3cca1f7afd31" id="r_a8a79c1f2b383fda22b5f3cca1f7afd31"><td class="memItemLeft">real(dp), dimension(:,:), allocatable&#160;</td><td class="memItemRight"><a class="el" href="#a8a79c1f2b383fda22b5f3cca1f7afd31">ang</a></td></tr>
<tr class="memdesc:a8a79c1f2b383fda22b5f3cca1f7afd31"><td class="mdescLeft">&#160;</td><td class="mdescRight">angle along field line, for each field line  <br /></td></tr>
<tr class="memitem:a0a50780974a5360abbc019e2e32f82ec" id="r_a0a50780974a5360abbc019e2e32f82ec"><td class="memItemLeft">real(dp), dimension(:,:), allocatable&#160;</td><td class="memItemRight"><a class="el" href="#a0a50780974a5360abbc019e2e32f82ec">norm</a></td></tr>
<tr class="memdesc:a0a50780974a5360abbc019e2e32f82ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">J nabla psi normal vector.  <br /></td></tr>
<tr class="memitem:a7703921b8900d9886904fd51e8cba073" id="r_a7703921b8900d9886904fd51e8cba073"><td class="memItemLeft">real(dp), dimension(:,:), allocatable&#160;</td><td class="memItemRight"><a class="el" href="#a7703921b8900d9886904fd51e8cba073">dnorm</a></td></tr>
<tr class="memdesc:a7703921b8900d9886904fd51e8cba073"><td class="mdescLeft">&#160;</td><td class="mdescRight">poloidal derivative of norm (only for style 2)  <br /></td></tr>
<tr class="memitem:abdbf97da81162577af6880aba4e44061" id="r_abdbf97da81162577af6880aba4e44061"><td class="memItemLeft">real(dp), dimension(:,:), allocatable&#160;</td><td class="memItemRight"><a class="el" href="#abdbf97da81162577af6880aba4e44061">h_fac</a></td></tr>
<tr class="memdesc:abdbf97da81162577af6880aba4e44061"><td class="mdescLeft">&#160;</td><td class="mdescRight">metric factors (1,1), (1,3) and (3,3) (only for style 1)  <br /></td></tr>
<tr class="memitem:ae485365ab16528f580d33805ba4633d3" id="r_ae485365ab16528f580d33805ba4633d3"><td class="memItemLeft">real(dp), dimension(:,:), allocatable&#160;</td><td class="memItemRight"><a class="el" href="#ae485365ab16528f580d33805ba4633d3">x_vec</a></td></tr>
<tr class="memdesc:ae485365ab16528f580d33805ba4633d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cartesian vector of position.  <br /></td></tr>
<tr class="memitem:a409e9e1182fbfe4cdf9b882297a5faf9" id="r_a409e9e1182fbfe4cdf9b882297a5faf9"><td class="memItemLeft">real(dp), dimension(:,:), allocatable&#160;</td><td class="memItemRight"><a class="el" href="#a409e9e1182fbfe4cdf9b882297a5faf9">h</a></td></tr>
<tr class="memdesc:a409e9e1182fbfe4cdf9b882297a5faf9"><td class="mdescLeft">&#160;</td><td class="mdescRight">H coefficient.  <br /></td></tr>
<tr class="memitem:abccce7d8c7e44b2bbc76104b2138ea5b" id="r_abccce7d8c7e44b2bbc76104b2138ea5b"><td class="memItemLeft">real(dp), dimension(:,:), allocatable&#160;</td><td class="memItemRight"><a class="el" href="#abccce7d8c7e44b2bbc76104b2138ea5b">g</a></td></tr>
<tr class="memdesc:abccce7d8c7e44b2bbc76104b2138ea5b"><td class="mdescLeft">&#160;</td><td class="mdescRight">G coefficient.  <br /></td></tr>
<tr class="memitem:ac7baffb7968c67d876d2c3f8a7c90a89" id="r_ac7baffb7968c67d876d2c3f8a7c90a89"><td class="memItemLeft">complex(dp), dimension(:,:), allocatable&#160;</td><td class="memItemRight"><a class="el" href="#ac7baffb7968c67d876d2c3f8a7c90a89">res</a></td></tr>
<tr class="memdesc:ac7baffb7968c67d876d2c3f8a7c90a89"><td class="mdescLeft">&#160;</td><td class="mdescRight">vacuum response  <br /></td></tr>
<tr class="memitem:ab01e7e74ce3f5c2a0e4bff7cd88d5c3f" id="r_ab01e7e74ce3f5c2a0e4bff7cd88d5c3f"><td class="memItemLeft">real(dp)&#160;</td><td class="memItemRight"><a class="el" href="#ab01e7e74ce3f5c2a0e4bff7cd88d5c3f">estim_mem_usage</a></td></tr>
<tr class="memdesc:ab01e7e74ce3f5c2a0e4bff7cd88d5c3f"><td class="mdescLeft">&#160;</td><td class="mdescRight">estimated memory usage  <br /></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><p>vacuum type </p>
<p>The arrays here are of the form:</p><ul>
<li><code>H</code>, <code>G:</code> <span class="tt">(<a class="el" href="#ad773e9aa724066256c3955a1a98a1d63" title="local number of rows and columns">n_loc</a>,<a class="el" href="#ad773e9aa724066256c3955a1a98a1d63" title="local number of rows and columns">n_loc</a>)</span></li>
<li><code>res:</code> <span class="tt">(n_mod_X,n_mod_X)</span></li>
</ul>
<p>where <code>n_loc</code> is the number of points in the boundary, i.e. a subset of <code>n_bnd</code>.</p>
<p>For vacuum style 1, the vacuum is assumed to be equidsitant in the coordinate along the magnetic field lines and, if there are multiple field lines, also in the field line label \(\alpha\). The limits on the angles are assumed to be given by the global variables <code><a class="el" href="namespacegrid__vars.html#a689c08cf03bc54338878f85c6429b856" title="min. of parallel coordinate [ ] in field-aligned grid">grid_vars.min_par_x</a></code>, <code><a class="el" href="namespacegrid__vars.html#acaa1fd21d0c728ad8f24591c0d2a5801" title="max. of parallel coordinate [ ] in field-aligned grid">grid_vars.max_par_x</a></code> and <code><a class="el" href="namespacegrid__vars.html#ad6f74227054278479670c68d8950e0e2" title="min. of field-line label [ ] in field-aligned grid">grid_vars.min_alpha</a></code>, <code><a class="el" href="namespacegrid__vars.html#ad3cab5cd1037b6956ccf74cde4539298" title="max. of field-line label [ ] in field-aligned grid">grid_vars.max_alpha</a></code>.</p>
<p>For vacuum style 2, there is an additional angle <code>ang</code>. It is composed of the angles along the magnetic fields (which refers to <code>angle_1</code> in the discussion of <code><a class="el" href="structgrid__vars_1_1grid__type.html" title="Type for grids.">grid_vars.grid_type</a></code>), of which there can be multiple, but the total sum must be equal to <code>n_bnd</code>. </p>

<p class="definition">Definition at line <a class="el" href="vac__vars_8f90_source.html#l00046">46</a> of file <a class="el" href="vac__vars_8f90_source.html">vac_vars.f90</a>.</p>
</div><a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Member Function/Subroutine Documentation</h2>
<a id="a6b5be1440804ecde87e2fede08ca897b" name="a6b5be1440804ecde87e2fede08ca897b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b5be1440804ecde87e2fede08ca897b">&#9670;&#160;</a></span>dealloc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">procedure vac_vars::vac_type::dealloc </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structvac__vars_1_1vac__type.html">vac_type</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>vac</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>deallocate </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">vac</td><td>vacuum variables to be deallocated </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="vac__vars_8f90_source.html#l00078">78</a> of file <a class="el" href="vac__vars_8f90_source.html">vac_vars.f90</a>.</p>

</div>
</div>
<a id="afa967069239b8a72212e3a5cbe57721b" name="afa967069239b8a72212e3a5cbe57721b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa967069239b8a72212e3a5cbe57721b">&#9670;&#160;</a></span>init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">procedure vac_vars::vac_type::init </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structvac__vars_1_1vac__type.html">vac_type</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>vac</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)</td>          <td class="paramname"><span class="paramname"><em>style</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)</td>          <td class="paramname"><span class="paramname"><em>n_bnd</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)</td>          <td class="paramname"><span class="paramname"><em>prim_x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(2), intent(in)</td>          <td class="paramname"><span class="paramname"><em>n_ang</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)</td>          <td class="paramname"><span class="paramname"><em>jq</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>initialize </p>
<p>The number of modes as well as <code>n</code> and <code>m</code> are also set up.</p>
<p>The variables G and H are saved in a special format, based on the block-cyclical distribution employed in scalapack. As a hypothetical example, consider a process grid corresponding to block-size 1x2 and 2x3 processes with a total size of 3x15:     </p><p class="formulaDsp">
\[\left[\begin{array}{ccccccccccccccc}
         0 &amp; 0 &amp; 1 &amp; 1 &amp; 2 &amp; 2 &amp; 0 &amp; 0 &amp; 1 &amp; 1 &amp; 2 &amp; 2 &amp; 0 &amp; 0 &amp; 1 \\
         3 &amp; 3 &amp; 4 &amp; 4 &amp; 5 &amp; 5 &amp; 3 &amp; 3 &amp; 4 &amp; 4 &amp; 5 &amp; 5 &amp; 3 &amp; 3 &amp; 4 \\
         0 &amp; 0 &amp; 1 &amp; 1 &amp; 2 &amp; 2 &amp; 0 &amp; 0 &amp; 1 &amp; 1 &amp; 2 &amp; 2 &amp; 0 &amp; 0 &amp; 1
        \end{array}\right]\]
</p>
<p>Therefore, the 3-D storage convention used is, for example, for process 1:    </p><p class="formulaDsp">
\[\begin{bmatrix}
         (1,3) &amp; (1,4) &amp; (1,9) &amp; (1,10) &amp; (1,15) &amp; (1,\cdot) \\
         (3,3) &amp; (3,4) &amp; (3,9) &amp; (3,10) &amp; (3,15) &amp; (3,\cdot)
        \end{bmatrix}\]
</p>
<p>The information concerning the delimitations of the individual subintervals in the horizontal and vertical direction can be saved once per subinterval. For process 4 of above example, this would be   </p><p class="formulaDsp">
\[         \begin{bmatrix} 2 \\ 2 \end{bmatrix} ;
\]
</p>
<p> for the vertical direction, and   </p><p class="formulaDsp">
\[         \begin{bmatrix} 3 &amp; 9 &amp; 15 \\ 4 &amp; 10 &amp; 15 \end{bmatrix} ;
\]
</p>
<p> for the horizontal direction.</p>
<p>A value \(\cdot\) indicates that the index is out of global bounds. Practically, this is checked by seeing whether the total index does not exceed the global bounds.</p>
<dl class="section return"><dt>Returns</dt><dd>ierr </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">vac</td><td>vacuum variables </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname"><a class="el" href="#afbd856ce1a362b252a9d8195b83546cd" title="style of vacuum (1: field-line 3-D, 2: axisymmetric)">style</a></td><td>style of vacuum (1: field-line 3-D, 2: axisymmetric) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname"><a class="el" href="#a099ac67e58545d9dd3863d0397f37b05" title="number of points in boundary">n_bnd</a></td><td>total number of points in boundary </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname"><a class="el" href="#a75bec679a19120000183f0d0d6fcd880" title="primary mode number">prim_x</a></td><td>primary mode number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname"><a class="el" href="#ac337095579ae842776d35a4b975254e8" title="number of angles (1) and number of field lines (2)">n_ang</a></td><td>number of angles (1) and number of field lines (2) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname"><a class="el" href="#a8cba6ae0e61249966161e44ab1c465fb" title="iota (tor. flux) or q (pol. flux) at edge">jq</a></td><td>iota (tor. flux) or q (pol. flux) at edge </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="vac__vars_8f90_source.html#l00076">76</a> of file <a class="el" href="vac__vars_8f90_source.html">vac_vars.f90</a>.</p>

</div>
</div>
<a name="doc-variable-members" id="doc-variable-members"></a><h2 id="header-doc-variable-members" class="groupheader">Member Data Documentation</h2>
<a id="a8a79c1f2b383fda22b5f3cca1f7afd31" name="a8a79c1f2b383fda22b5f3cca1f7afd31"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a79c1f2b383fda22b5f3cca1f7afd31">&#9670;&#160;</a></span>ang</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(dp), dimension(:,:), allocatable vac_vars::vac_type::ang</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>angle along field line, for each field line </p>

<p class="definition">Definition at line <a class="el" href="vac__vars_8f90_source.html#l00063">63</a> of file <a class="el" href="vac__vars_8f90_source.html">vac_vars.f90</a>.</p>

</div>
</div>
<a id="aacac3cfc228c0a5de03540bf63bc9014" name="aacac3cfc228c0a5de03540bf63bc9014"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aacac3cfc228c0a5de03540bf63bc9014">&#9670;&#160;</a></span>bs</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer vac_vars::vac_type::bs</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>block size in cyclical storage </p>

<p class="definition">Definition at line <a class="el" href="vac__vars_8f90_source.html#l00051">51</a> of file <a class="el" href="vac__vars_8f90_source.html">vac_vars.f90</a>.</p>

</div>
</div>
<a id="a975901d1517e02c7a78be46054decde0" name="a975901d1517e02c7a78be46054decde0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a975901d1517e02c7a78be46054decde0">&#9670;&#160;</a></span>ctxt_hg</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer vac_vars::vac_type::ctxt_hg</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>context for H and G </p>

<p class="definition">Definition at line <a class="el" href="vac__vars_8f90_source.html#l00049">49</a> of file <a class="el" href="vac__vars_8f90_source.html">vac_vars.f90</a>.</p>

</div>
</div>
<a id="a8c1903cbdc406915f473535daa1cafb7" name="a8c1903cbdc406915f473535daa1cafb7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c1903cbdc406915f473535daa1cafb7">&#9670;&#160;</a></span>desc_g</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(blacsctxtsize) vac_vars::vac_type::desc_g</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>descriptor for G </p>

<p class="definition">Definition at line <a class="el" href="vac__vars_8f90_source.html#l00054">54</a> of file <a class="el" href="vac__vars_8f90_source.html">vac_vars.f90</a>.</p>

</div>
</div>
<a id="a7d588dd9ece3c1a645329431769c28de" name="a7d588dd9ece3c1a645329431769c28de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d588dd9ece3c1a645329431769c28de">&#9670;&#160;</a></span>desc_h</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(blacsctxtsize) vac_vars::vac_type::desc_h</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>descriptor for H </p>

<p class="definition">Definition at line <a class="el" href="vac__vars_8f90_source.html#l00053">53</a> of file <a class="el" href="vac__vars_8f90_source.html">vac_vars.f90</a>.</p>

</div>
</div>
<a id="a7703921b8900d9886904fd51e8cba073" name="a7703921b8900d9886904fd51e8cba073"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7703921b8900d9886904fd51e8cba073">&#9670;&#160;</a></span>dnorm</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(dp), dimension(:,:), allocatable vac_vars::vac_type::dnorm</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>poloidal derivative of norm (only for style 2) </p>

<p class="definition">Definition at line <a class="el" href="vac__vars_8f90_source.html#l00065">65</a> of file <a class="el" href="vac__vars_8f90_source.html">vac_vars.f90</a>.</p>

</div>
</div>
<a id="ab01e7e74ce3f5c2a0e4bff7cd88d5c3f" name="ab01e7e74ce3f5c2a0e4bff7cd88d5c3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab01e7e74ce3f5c2a0e4bff7cd88d5c3f">&#9670;&#160;</a></span>estim_mem_usage</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(dp) vac_vars::vac_type::estim_mem_usage</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>estimated memory usage </p>
<dl class="section note"><dt>Note</dt><dd>Debug version only </dd></dl>

<p class="definition">Definition at line <a class="el" href="vac__vars_8f90_source.html#l00072">72</a> of file <a class="el" href="vac__vars_8f90_source.html">vac_vars.f90</a>.</p>

</div>
</div>
<a id="abccce7d8c7e44b2bbc76104b2138ea5b" name="abccce7d8c7e44b2bbc76104b2138ea5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abccce7d8c7e44b2bbc76104b2138ea5b">&#9670;&#160;</a></span>g</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(dp), dimension(:,:), allocatable vac_vars::vac_type::g</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>G coefficient. </p>

<p class="definition">Definition at line <a class="el" href="vac__vars_8f90_source.html#l00069">69</a> of file <a class="el" href="vac__vars_8f90_source.html">vac_vars.f90</a>.</p>

</div>
</div>
<a id="a409e9e1182fbfe4cdf9b882297a5faf9" name="a409e9e1182fbfe4cdf9b882297a5faf9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a409e9e1182fbfe4cdf9b882297a5faf9">&#9670;&#160;</a></span>h</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(dp), dimension(:,:), allocatable vac_vars::vac_type::h</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>H coefficient. </p>

<p class="definition">Definition at line <a class="el" href="vac__vars_8f90_source.html#l00068">68</a> of file <a class="el" href="vac__vars_8f90_source.html">vac_vars.f90</a>.</p>

</div>
</div>
<a id="abdbf97da81162577af6880aba4e44061" name="abdbf97da81162577af6880aba4e44061"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abdbf97da81162577af6880aba4e44061">&#9670;&#160;</a></span>h_fac</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(dp), dimension(:,:), allocatable vac_vars::vac_type::h_fac</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>metric factors (1,1), (1,3) and (3,3) (only for style 1) </p>

<p class="definition">Definition at line <a class="el" href="vac__vars_8f90_source.html#l00066">66</a> of file <a class="el" href="vac__vars_8f90_source.html">vac_vars.f90</a>.</p>

</div>
</div>
<a id="ae875caaff6d6ddf9bf6abba721f081ec" name="ae875caaff6d6ddf9bf6abba721f081ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae875caaff6d6ddf9bf6abba721f081ec">&#9670;&#160;</a></span>ind_p</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(2) vac_vars::vac_type::ind_p</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>index of local process in grid </p>

<p class="definition">Definition at line <a class="el" href="vac__vars_8f90_source.html#l00057">57</a> of file <a class="el" href="vac__vars_8f90_source.html">vac_vars.f90</a>.</p>

</div>
</div>
<a id="a8cba6ae0e61249966161e44ab1c465fb" name="a8cba6ae0e61249966161e44ab1c465fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8cba6ae0e61249966161e44ab1c465fb">&#9670;&#160;</a></span>jq</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(dp) vac_vars::vac_type::jq</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>iota (tor. flux) or q (pol. flux) at edge </p>

<p class="definition">Definition at line <a class="el" href="vac__vars_8f90_source.html#l00062">62</a> of file <a class="el" href="vac__vars_8f90_source.html">vac_vars.f90</a>.</p>

</div>
</div>
<a id="ad4aa76e0d91f32808465d15ac04528ec" name="ad4aa76e0d91f32808465d15ac04528ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4aa76e0d91f32808465d15ac04528ec">&#9670;&#160;</a></span>lims_c</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(:,:), allocatable vac_vars::vac_type::lims_c</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>column limits for different subrows of G and H </p>

<p class="definition">Definition at line <a class="el" href="vac__vars_8f90_source.html#l00060">60</a> of file <a class="el" href="vac__vars_8f90_source.html">vac_vars.f90</a>.</p>

</div>
</div>
<a id="aac146dc17760b97ff3cb7966cd1b41f9" name="aac146dc17760b97ff3cb7966cd1b41f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac146dc17760b97ff3cb7966cd1b41f9">&#9670;&#160;</a></span>lims_r</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(:,:), allocatable vac_vars::vac_type::lims_r</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>row limits for different subcolumns of G and H </p>

<p class="definition">Definition at line <a class="el" href="vac__vars_8f90_source.html#l00061">61</a> of file <a class="el" href="vac__vars_8f90_source.html">vac_vars.f90</a>.</p>

</div>
</div>
<a id="af24c1254132acf04aef2f91952b73243" name="af24c1254132acf04aef2f91952b73243"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af24c1254132acf04aef2f91952b73243">&#9670;&#160;</a></span>mpi_comm</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer vac_vars::vac_type::mpi_comm</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>communicator for vacuum </p>

<p class="definition">Definition at line <a class="el" href="vac__vars_8f90_source.html#l00052">52</a> of file <a class="el" href="vac__vars_8f90_source.html">vac_vars.f90</a>.</p>

</div>
</div>
<a id="ac337095579ae842776d35a4b975254e8" name="ac337095579ae842776d35a4b975254e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac337095579ae842776d35a4b975254e8">&#9670;&#160;</a></span>n_ang</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(2) vac_vars::vac_type::n_ang</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>number of angles (1) and number of field lines (2) </p>

<p class="definition">Definition at line <a class="el" href="vac__vars_8f90_source.html#l00056">56</a> of file <a class="el" href="vac__vars_8f90_source.html">vac_vars.f90</a>.</p>

</div>
</div>
<a id="a099ac67e58545d9dd3863d0397f37b05" name="a099ac67e58545d9dd3863d0397f37b05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a099ac67e58545d9dd3863d0397f37b05">&#9670;&#160;</a></span>n_bnd</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer vac_vars::vac_type::n_bnd</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>number of points in boundary </p>

<p class="definition">Definition at line <a class="el" href="vac__vars_8f90_source.html#l00050">50</a> of file <a class="el" href="vac__vars_8f90_source.html">vac_vars.f90</a>.</p>

</div>
</div>
<a id="ad773e9aa724066256c3955a1a98a1d63" name="ad773e9aa724066256c3955a1a98a1d63"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad773e9aa724066256c3955a1a98a1d63">&#9670;&#160;</a></span>n_loc</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(2) vac_vars::vac_type::n_loc</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>local number of rows and columns </p>

<p class="definition">Definition at line <a class="el" href="vac__vars_8f90_source.html#l00058">58</a> of file <a class="el" href="vac__vars_8f90_source.html">vac_vars.f90</a>.</p>

</div>
</div>
<a id="aaf6def83c79ec72152b8aa27081fde11" name="aaf6def83c79ec72152b8aa27081fde11"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf6def83c79ec72152b8aa27081fde11">&#9670;&#160;</a></span>n_p</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(2) vac_vars::vac_type::n_p</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>nr. of processes in grid </p>

<p class="definition">Definition at line <a class="el" href="vac__vars_8f90_source.html#l00055">55</a> of file <a class="el" href="vac__vars_8f90_source.html">vac_vars.f90</a>.</p>

</div>
</div>
<a id="a0a50780974a5360abbc019e2e32f82ec" name="a0a50780974a5360abbc019e2e32f82ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a50780974a5360abbc019e2e32f82ec">&#9670;&#160;</a></span>norm</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(dp), dimension(:,:), allocatable vac_vars::vac_type::norm</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>J nabla psi normal vector. </p>

<p class="definition">Definition at line <a class="el" href="vac__vars_8f90_source.html#l00064">64</a> of file <a class="el" href="vac__vars_8f90_source.html">vac_vars.f90</a>.</p>

</div>
</div>
<a id="a75bec679a19120000183f0d0d6fcd880" name="a75bec679a19120000183f0d0d6fcd880"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75bec679a19120000183f0d0d6fcd880">&#9670;&#160;</a></span>prim_x</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer vac_vars::vac_type::prim_x</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>primary mode number </p>

<p class="definition">Definition at line <a class="el" href="vac__vars_8f90_source.html#l00048">48</a> of file <a class="el" href="vac__vars_8f90_source.html">vac_vars.f90</a>.</p>

</div>
</div>
<a id="ac7baffb7968c67d876d2c3f8a7c90a89" name="ac7baffb7968c67d876d2c3f8a7c90a89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7baffb7968c67d876d2c3f8a7c90a89">&#9670;&#160;</a></span>res</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">complex(dp), dimension(:,:), allocatable vac_vars::vac_type::res</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>vacuum response </p>

<p class="definition">Definition at line <a class="el" href="vac__vars_8f90_source.html#l00070">70</a> of file <a class="el" href="vac__vars_8f90_source.html">vac_vars.f90</a>.</p>

</div>
</div>
<a id="aeb4618332068796eb12784a5b5582416" name="aeb4618332068796eb12784a5b5582416"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb4618332068796eb12784a5b5582416">&#9670;&#160;</a></span>sec_x</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(:), allocatable vac_vars::vac_type::sec_x</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>secondary mode numbers </p>

<p class="definition">Definition at line <a class="el" href="vac__vars_8f90_source.html#l00059">59</a> of file <a class="el" href="vac__vars_8f90_source.html">vac_vars.f90</a>.</p>

</div>
</div>
<a id="afbd856ce1a362b252a9d8195b83546cd" name="afbd856ce1a362b252a9d8195b83546cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afbd856ce1a362b252a9d8195b83546cd">&#9670;&#160;</a></span>style</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer vac_vars::vac_type::style</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>style of vacuum (1: field-line 3-D, 2: axisymmetric) </p>

<p class="definition">Definition at line <a class="el" href="vac__vars_8f90_source.html#l00047">47</a> of file <a class="el" href="vac__vars_8f90_source.html">vac_vars.f90</a>.</p>

</div>
</div>
<a id="ae485365ab16528f580d33805ba4633d3" name="ae485365ab16528f580d33805ba4633d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae485365ab16528f580d33805ba4633d3">&#9670;&#160;</a></span>x_vec</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(dp), dimension(:,:), allocatable vac_vars::vac_type::x_vec</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Cartesian vector of position. </p>

<p class="definition">Definition at line <a class="el" href="vac__vars_8f90_source.html#l00067">67</a> of file <a class="el" href="vac__vars_8f90_source.html">vac_vars.f90</a>.</p>

</div>
</div>
<hr/>The documentation for this type was generated from the following file:<ul>
<li>/Users/toonweyens/Code/PB3D/Modules/<a class="el" href="vac__vars_8f90_source.html">vac_vars.f90</a></li>
</ul>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<address class="footer"><small>
<center>this documentation was created with <a href="http://www.doxygen.org/index.html">Doxygen 1.16.1</a> by <a href="mailto:weyenst@gmail.com">Toon Weyens</a></center>
</small></address>
</body>
</html>
