\doxysection{x\+\_\+ops Module Reference}
\hypertarget{namespacex__ops}{}\label{namespacex__ops}\index{x\_ops@{x\_ops}}


Operations considering perturbation quantities.  


\doxysubsubsection*{Interfaces and Types}
\begin{DoxyCompactItemize}
\item 
interface \doxymbox{\hyperlink{interfacex__ops_1_1calc__x}{calc\+\_\+x}}
\begin{DoxyCompactList}\small\item\em Calculates either vectorial or tensorial perturbation variables. \end{DoxyCompactList}\item 
interface \doxymbox{\hyperlink{interfacex__ops_1_1redistribute__output__x}{redistribute\+\_\+output\+\_\+x}}
\begin{DoxyCompactList}\small\item\em Redistribute the perturbation variables. \end{DoxyCompactList}\item 
interface \doxymbox{\hyperlink{interfacex__ops_1_1print__output__x}{print\+\_\+output\+\_\+x}}
\begin{DoxyCompactList}\small\item\em Print either vectorial or tensorial perturbation quantities of a certain order to an output file. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Functions/\+\+Subroutines}
\begin{DoxyCompactItemize}
\item 
integer function, public \doxymbox{\hyperlink{namespacex__ops_a73a80c582379669f8e07b09dd7456878}{init\+\_\+modes}} (grid\+\_\+eq, eq)
\begin{DoxyCompactList}\small\item\em Initializes some variables concerning the mode numbers. \end{DoxyCompactList}\item 
integer function, public \doxymbox{\hyperlink{namespacex__ops_a640d64aeae8a574eb05f164c1bdad3bd}{setup\+\_\+modes}} (mds, grid\+\_\+eq, grid, plot\+\_\+name)
\begin{DoxyCompactList}\small\item\em Sets up some variables concerning the mode numbers. \end{DoxyCompactList}\item 
integer function, public \doxymbox{\hyperlink{namespacex__ops_a7d9275e2d927d92548416f21b983b604}{check\+\_\+x\+\_\+modes}} (grid\+\_\+eq, eq)
\begin{DoxyCompactList}\small\item\em Checks whether the high-\/n approximation is valid:\+ \end{DoxyCompactList}\item 
integer function, public \doxymbox{\hyperlink{namespacex__ops_a1a90026bbbeddc25e82cfdd304df251f}{calc\+\_\+res\+\_\+surf}} (mds, grid\+\_\+eq, eq, res\+\_\+surf, info, jq)
\begin{DoxyCompactList}\small\item\em Calculates resonating flux surfaces for the perturbation modes. \end{DoxyCompactList}\item 
integer function, public \doxymbox{\hyperlink{namespacex__ops_abdaf1308e13cede3a153e8c6cf35a637}{resonance\+\_\+plot}} (mds, grid\+\_\+eq, eq)
\begin{DoxyCompactList}\small\item\em plot $q$-\/profile or $\iota$-\/profile in flux coordinates with $nq-m = 0$ or $n-\iota m = 0$ indicated if requested. \end{DoxyCompactList}\item 
integer function, public \doxymbox{\hyperlink{namespacex__ops_afbb67819a435e90b45b5986ab065d55c}{calc\+\_\+magn\+\_\+ints}} (grid\+\_\+eq, grid\+\_\+x, eq, x, x\+\_\+int, prev\+\_\+style, lim\+\_\+sec\+\_\+x)
\begin{DoxyCompactList}\small\item\em Calculate the magnetic integrals from $\widetilde{PV}_{k,m}^i$ and $\widetilde{KV}_{k,m}^i$ in an equidistant grid where the step size can vary depending on the normal coordinate. \end{DoxyCompactList}\item 
integer function, public \doxymbox{\hyperlink{namespacex__ops_a677c88d85fe1bfbf3579a2421ce16f2f}{divide\+\_\+x\+\_\+jobs}} (arr\+\_\+size)
\begin{DoxyCompactList}\small\item\em Divides the perturbation jobs. \end{DoxyCompactList}\item 
integer function, public \doxymbox{\hyperlink{namespacex__ops_a749acd00c1dd08da16d9bbce94422656}{print\+\_\+debug\+\_\+x\+\_\+1}} (mds, grid\+\_\+x, x\+\_\+1)
\begin{DoxyCompactList}\small\item\em Prints debug information for X\+\_\+1 driver. \end{DoxyCompactList}\item 
integer function, public \doxymbox{\hyperlink{namespacex__ops_ad7b07e5851eb44994a384363c86f35d6}{print\+\_\+debug\+\_\+x\+\_\+2}} (mds, grid\+\_\+x, x\+\_\+2\+\_\+int)
\begin{DoxyCompactList}\small\item\em Prints debug information for X\+\_\+2 driver. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
logical, public \doxymbox{\hyperlink{namespacex__ops_a342c624ea5f9a15264c78767da34684c}{debug\+\_\+check\+\_\+x\+\_\+modes\+\_\+2}} = .false.
\begin{DoxyCompactList}\small\item\em plot debug information for check\+\_\+x\+\_\+modes\+\_\+2() \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Operations considering perturbation quantities. 

\label{doc-func-members}
\Hypertarget{namespacex__ops_doc-func-members}
\doxysubsection{Function/\+\+Subroutine Documentation}
\Hypertarget{namespacex__ops_afbb67819a435e90b45b5986ab065d55c}\index{x\_ops@{x\_ops}!calc\_magn\_ints@{calc\_magn\_ints}}
\index{calc\_magn\_ints@{calc\_magn\_ints}!x\_ops@{x\_ops}}
\doxysubsubsection{\texorpdfstring{calc\_magn\_ints()}{calc\_magn\_ints()}}
{\footnotesize\ttfamily \label{namespacex__ops_afbb67819a435e90b45b5986ab065d55c} 
integer function, public x\+\_\+ops::\+calc\+\_\+magn\+\_\+ints (\begin{DoxyParamCaption}\item[{type(\doxymbox{\hyperlink{structgrid__vars_1_1grid__type}{grid\+\_\+type}}), intent(in)}]{grid\+\_\+eq}{, }\item[{type(\doxymbox{\hyperlink{structgrid__vars_1_1grid__type}{grid\+\_\+type}}), intent(in)}]{grid\+\_\+x}{, }\item[{type(\doxymbox{\hyperlink{structeq__vars_1_1eq__2__type}{eq\+\_\+2\+\_\+type}}), intent(in), target}]{eq}{, }\item[{type(\doxymbox{\hyperlink{structx__vars_1_1x__2__type}{x\+\_\+2\+\_\+type}}), intent(in)}]{x}{, }\item[{type(\doxymbox{\hyperlink{structx__vars_1_1x__2__type}{x\+\_\+2\+\_\+type}}), intent(inout)}]{x\+\_\+int}{, }\item[{integer, intent(in), optional}]{prev\+\_\+style}{, }\item[{integer, dimension(2,2), intent(in), optional}]{lim\+\_\+sec\+\_\+x}{}\end{DoxyParamCaption})}



Calculate the magnetic integrals from $\widetilde{PV}_{k,m}^i$ and $\widetilde{KV}_{k,m}^i$ in an equidistant grid where the step size can vary depending on the normal coordinate. 

All the variables should thus be field-\/line oriented. The result is saved in the first index of the X variables, the other can be ignored.

Using {\ttfamily prev\+\_\+style}, the results of this calculation on X can be combined with the ones already present in {\ttfamily X\+\_\+int}.
\begin{DoxyItemize}
\item {\ttfamily prev\+\_\+style=0}:\+ Overwrite \+[def]\+.
\item {\ttfamily prev\+\_\+style=1}:\+ Add to current integral.
\item {\ttfamily prev\+\_\+style=2}:\+ Divide by 2 and add to current integral. Also modify the indices of the current integral:\+
\begin{DoxyItemize}
\item for {\ttfamily magn\+\_\+int\+\_\+style} = 1:\+ {\ttfamily 1 2 2 2 2 2 1 -\/\texorpdfstring{$>$}{>} 2 2 2 2 2 2},
\item for {\ttfamily magn\+\_\+int\+\_\+style} = 2:\+ {\ttfamily 1 3 3 2 3 3 1 -\/\texorpdfstring{$>$}{>} 3 2 3 3 2 3}.
\end{DoxyItemize}
\item {\ttfamily prev\+\_\+style=3}:\+ Add to current integral. Also modify the indices of the current integral as in {\ttfamily prev\+\_\+style} = 2.
\item else:\+ ignore previous magnetic integrals.
\end{DoxyItemize}

Therefore, it is to be used in order. For example:\+
\begin{DoxyEnumerate}
\item $\phantom{\rightarrow}$ (R=1,E=1):\+ style 0,
\item $\rightarrow$ (R=1,E=2):\+ style 1,
\item $\rightarrow$ (R=2,E=1):\+ style 2,
\item $\rightarrow$ (R=2,E=2):\+ style 3.
\end{DoxyEnumerate}

Afterwards, it would cycle through 2 and 3, as style 0 and 1 are only for the first Richardson level.

\begin{DoxyNote}{Note}

\begin{DoxyEnumerate}
\item The variable type for the integrated tensorial perturbation variables is also {\ttfamily X\+\_\+2}, but it is assumed that the first index has dimension 1, the rest is ignored.
\item Simpson\textquotesingle{}s 3/\+8 rule converges faster than the trapezoidal rule, but normally needs a better starting point (i.\+e. higher {\ttfamily min\+\_\+n\+\_\+par\+\_\+X})
\item For alpha style 1, Weyl\textquotesingle{}s lemma is used to convert the surface integral into a line integral along the magnetic field. This means that the resulting line integral still needs to be multiplied by $\frac{2\pi}{M}$, where $M$ is the number of times the poloidal or toroidal angle completes a full $2\pi$ tour, depending on {\ttfamily use\+\_\+pol\+\_\+flux\+\_\+F} \DoxyCite{helander2014}{number}{1}.
\item For alpha style 2, this factor is just the step size in alpha.
\end{DoxyEnumerate}
\end{DoxyNote}
\begin{DoxySeeAlso}{See also}
See \doxylink{structx__vars_1_1x__2__type}{x\+\_\+vars.\+x\+\_\+2\+\_\+type}.
\end{DoxySeeAlso}
\begin{DoxyReturn}{Returns}
ierr 
\end{DoxyReturn}

\begin{DoxyParams}[1]{Parameters}
\doxymbox{\texttt{in}}  & {\em grid\+\_\+eq} & equilibrium grid \\
\hline
\doxymbox{\texttt{in}}  & {\em grid\+\_\+x} & perturbation grid \\
\hline
\doxymbox{\texttt{in}}  & {\em eq} & metric equilibrium \\
\hline
\doxymbox{\texttt{in}}  & {\em x} & tensorial perturbation variables \\
\hline
\doxymbox{\texttt{in,out}}  & {\em x\+\_\+int} & interpolated tensorial perturbation variables, containing all mode combinations \\
\hline
\doxymbox{\texttt{in}}  & {\em prev\+\_\+style} & style to treat X\+\_\+prev \\
\hline
\doxymbox{\texttt{in}}  & {\em lim\+\_\+sec\+\_\+x} & limits of {\ttfamily m\+\_\+X} (pol flux) or {\ttfamily n\+\_\+X} (tor flux) for both dimensions \\
\hline
\end{DoxyParams}


Definition at line \doxymbox{\hyperlink{X__ops_8f90_source_l03079}{3079}} of file \doxymbox{\hyperlink{X__ops_8f90_source}{X\+\_\+ops.\+f90}}.

Here is the call graph for this function:\+\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacex__ops_afbb67819a435e90b45b5986ab065d55c_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function:\+\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacex__ops_afbb67819a435e90b45b5986ab065d55c_icgraph}
\end{center}
\end{figure}
\Hypertarget{namespacex__ops_a1a90026bbbeddc25e82cfdd304df251f}\index{x\_ops@{x\_ops}!calc\_res\_surf@{calc\_res\_surf}}
\index{calc\_res\_surf@{calc\_res\_surf}!x\_ops@{x\_ops}}
\doxysubsubsection{\texorpdfstring{calc\_res\_surf()}{calc\_res\_surf()}}
{\footnotesize\ttfamily \label{namespacex__ops_a1a90026bbbeddc25e82cfdd304df251f} 
integer function, public x\+\_\+ops::\+calc\+\_\+res\+\_\+surf (\begin{DoxyParamCaption}\item[{type(\doxymbox{\hyperlink{structx__vars_1_1modes__type}{modes\+\_\+type}}), intent(in)}]{mds}{, }\item[{type(\doxymbox{\hyperlink{structgrid__vars_1_1grid__type}{grid\+\_\+type}}), intent(in)}]{grid\+\_\+eq}{, }\item[{type(\doxymbox{\hyperlink{structeq__vars_1_1eq__1__type}{eq\+\_\+1\+\_\+type}}), intent(in)}]{eq}{, }\item[{real(dp), dimension(:\+,:\+), intent(inout), allocatable}]{res\+\_\+surf}{, }\item[{logical, intent(in), optional}]{info}{, }\item[{real(dp), dimension(:\+), intent(inout), optional, allocatable}]{jq}{}\end{DoxyParamCaption})}



Calculates resonating flux surfaces for the perturbation modes. 

The output consists of mode number, resonating normal position and the fraction $\frac{m}{n}$ or $\frac{n}{m}$. for those modes for which a solution is found that is within the plasma range.

It contains three pieces of information:\+
\begin{DoxyItemize}
\item {\ttfamily (:\+,1)}:\+ the mode index
\item {\ttfamily (:\+,2)}:\+ the radial position in Flux coordinates
\item {\ttfamily (:\+,3)}:\+ the fraction $\frac{m}{n}$ or $\frac{n}{m}$
\end{DoxyItemize}

for every single mode in {\ttfamily sec} of {\ttfamily mds}, which can be tabulated in an arbitrary grid, not necessarily the equilibrium one.

Optionally, the total safety factor or rotational transform can be returned to the master.

Also, information can be displayed with info.

\begin{DoxyReturn}{Returns}
ierr 
\end{DoxyReturn}

\begin{DoxyParams}[1]{Parameters}
\doxymbox{\texttt{in}}  & {\em mds} & general modes variables \\
\hline
\doxymbox{\texttt{in}}  & {\em grid\+\_\+eq} & equilibrium grid\+\_\+eq \\
\hline
\doxymbox{\texttt{in}}  & {\em eq} & flux equilibrium \\
\hline
\doxymbox{\texttt{in,out}}  & {\em res\+\_\+surf} & resonant surface \\
\hline
\doxymbox{\texttt{in}}  & {\em info} & if info is displayed \\
\hline
\doxymbox{\texttt{in,out}}  & {\em jq} & either safety factor or rotational transform \\
\hline
\end{DoxyParams}


Definition at line \doxymbox{\hyperlink{X__ops_8f90_source_l01637}{1637}} of file \doxymbox{\hyperlink{X__ops_8f90_source}{X\+\_\+ops.\+f90}}.

Here is the call graph for this function:\+\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacex__ops_a1a90026bbbeddc25e82cfdd304df251f_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function:\+\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacex__ops_a1a90026bbbeddc25e82cfdd304df251f_icgraph}
\end{center}
\end{figure}
\Hypertarget{namespacex__ops_a7d9275e2d927d92548416f21b983b604}\index{x\_ops@{x\_ops}!check\_x\_modes@{check\_x\_modes}}
\index{check\_x\_modes@{check\_x\_modes}!x\_ops@{x\_ops}}
\doxysubsubsection{\texorpdfstring{check\_x\_modes()}{check\_x\_modes()}}
{\footnotesize\ttfamily \label{namespacex__ops_a7d9275e2d927d92548416f21b983b604} 
integer function, public x\+\_\+ops::\+check\+\_\+x\+\_\+modes (\begin{DoxyParamCaption}\item[{type(\doxymbox{\hyperlink{structgrid__vars_1_1grid__type}{grid\+\_\+type}}), intent(in)}]{grid\+\_\+eq}{, }\item[{type(\doxymbox{\hyperlink{structeq__vars_1_1eq__1__type}{eq\+\_\+1\+\_\+type}}), intent(in)}]{eq}{}\end{DoxyParamCaption})}



Checks whether the high-\/n approximation is valid:\+ 

This depends on the {\ttfamily X\+\_\+style:\+} 

For X\+\_\+style 1 (prescribed):\+ every mode should resonate at least somewhere in the whole normal range:\+
\begin{DoxyItemize}
\item $\frac{\left|nq-m\right|}{\left|n\right|} < T$ and $\frac{\left|nq-m\right|}{\left|m\right|} < T$ for poloidal flux
\item $\frac{\left|q-\iota m\right|}{\left|m\right|} < T$ and $\frac{\left|n-\iota m\right|}{\left|n\right|} < T$ for toroidal flux
\end{DoxyItemize}

where $T$ = {\ttfamily tol} \texorpdfstring{$<$}{<}\texorpdfstring{$<$}{<} 1.

This condition is determined by the sign of $q$ (or $\iota$) and given by:\+
\begin{DoxyItemize}
\item $\max\left(q_\text{min}-T,\frac{q_\text{min}}{1+T}\right) <
             \frac{m}{n} <
             \min\left(q_\text{max}+T,\frac{q_\text{max}}{1-T}\right)$, $q>0$
\item $\max\left(q_\text{min}-T,\frac{q_\text{min}}{1-T}\right) <
             \frac{m}{n} <
             \min\left(q_\text{max}+T,\frac{q_\text{max}}{1+T}\right)$, $q<0$
\end{DoxyItemize}

for poloidal flux.

For toroidal flux, $q$ should be replaced by $\iota$ and $\frac{m}{n}$ by $\frac{n}{m}$.

For {\ttfamily X\+\_\+style} 2 (fast):\+ the resonance has been taken care of, but it remains to be checked whether the number of modes is efficient.

\begin{DoxyReturn}{Returns}
ierr 
\end{DoxyReturn}

\begin{DoxyParams}[1]{Parameters}
\doxymbox{\texttt{in}}  & {\em grid\+\_\+eq} & equilibrium grid \\
\hline
\doxymbox{\texttt{in}}  & {\em eq} & flux equilibrium \\
\hline
\end{DoxyParams}


Definition at line \doxymbox{\hyperlink{X__ops_8f90_source_l01349}{1349}} of file \doxymbox{\hyperlink{X__ops_8f90_source}{X\+\_\+ops.\+f90}}.

Here is the call graph for this function:\+\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacex__ops_a7d9275e2d927d92548416f21b983b604_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function:\+\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacex__ops_a7d9275e2d927d92548416f21b983b604_icgraph}
\end{center}
\end{figure}
\Hypertarget{namespacex__ops_a677c88d85fe1bfbf3579a2421ce16f2f}\index{x\_ops@{x\_ops}!divide\_x\_jobs@{divide\_x\_jobs}}
\index{divide\_x\_jobs@{divide\_x\_jobs}!x\_ops@{x\_ops}}
\doxysubsubsection{\texorpdfstring{divide\_x\_jobs()}{divide\_x\_jobs()}}
{\footnotesize\ttfamily \label{namespacex__ops_a677c88d85fe1bfbf3579a2421ce16f2f} 
integer function, public x\+\_\+ops::\+divide\+\_\+x\+\_\+jobs (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{arr\+\_\+size}{}\end{DoxyParamCaption})}



Divides the perturbation jobs. 

This concerns the calculation of the magnetic integrals of blocks of tensorial perturbation variables. These are set up using the equilibrium and vectorial perturbation variables that are stored in memory, but only the integrated tensorial result is stored in memory, with negligible variables size.

The size of the (k,m) pairs to be calculated is determined by looking at what fits in memory when the equilibrium and vectorial perturbation variables are stored in memory first.

\begin{DoxyReturn}{Returns}
ierr 
\end{DoxyReturn}

\begin{DoxyParams}[1]{Parameters}
\doxymbox{\texttt{in}}  & {\em arr\+\_\+size} & array size (using loc\+\_\+n\+\_\+r) \\
\hline
\end{DoxyParams}


Definition at line \doxymbox{\hyperlink{X__ops_8f90_source_l03363}{3363}} of file \doxymbox{\hyperlink{X__ops_8f90_source}{X\+\_\+ops.\+f90}}.

Here is the call graph for this function:\+\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacex__ops_a677c88d85fe1bfbf3579a2421ce16f2f_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function:\+\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacex__ops_a677c88d85fe1bfbf3579a2421ce16f2f_icgraph}
\end{center}
\end{figure}
\Hypertarget{namespacex__ops_a73a80c582379669f8e07b09dd7456878}\index{x\_ops@{x\_ops}!init\_modes@{init\_modes}}
\index{init\_modes@{init\_modes}!x\_ops@{x\_ops}}
\doxysubsubsection{\texorpdfstring{init\_modes()}{init\_modes()}}
{\footnotesize\ttfamily \label{namespacex__ops_a73a80c582379669f8e07b09dd7456878} 
integer function, public x\+\_\+ops::\+init\+\_\+modes (\begin{DoxyParamCaption}\item[{type(\doxymbox{\hyperlink{structgrid__vars_1_1grid__type}{grid\+\_\+type}}), intent(in)}]{grid\+\_\+eq}{, }\item[{type(\doxymbox{\hyperlink{structeq__vars_1_1eq__1__type}{eq\+\_\+1\+\_\+type}}), intent(in)}]{eq}{}\end{DoxyParamCaption})}



Initializes some variables concerning the mode numbers. 

Setup minimum and maximum of mode numbers at every flux surface in equilibrium coordinates
\begin{DoxyItemize}
\item {\ttfamily min\+\_\+n\+\_\+X}, {\ttfamily max\+\_\+n\+\_\+X} 
\item {\ttfamily min\+\_\+m\+\_\+X}, {\ttfamily max\+\_\+m\+\_\+X},
\end{DoxyItemize}

It functions depending on the {\ttfamily X\+\_\+style} used:\+ 1 (prescribed) or 2 (fast). For the fast style, at every flux surface the range of modes is sought that resonates most:\+
\begin{DoxyItemize}
\item $m = nq \pm \frac{N}{2}$ for poloidal flux
\item $n = \iota m \pm \frac{N}{2}$ for toroidal flux
\end{DoxyItemize}

where $N$ = {\ttfamily n\+\_\+mod\+\_\+X}.

However, at the same time, both {\ttfamily m} and {\ttfamily n} have to be larger, in absolute value, than {\ttfamily min\+\_\+sec\+\_\+X}. Therefore, the range of width {\ttfamily n\+\_\+mod\+\_\+X} can be shifted upwards.

\begin{DoxyReturn}{Returns}
ierr 
\end{DoxyReturn}

\begin{DoxyParams}[1]{Parameters}
\doxymbox{\texttt{in}}  & {\em grid\+\_\+eq} & equilibrium grid \\
\hline
\doxymbox{\texttt{in}}  & {\em eq} & flux equilibrium \\
\hline
\end{DoxyParams}


Definition at line \doxymbox{\hyperlink{X__ops_8f90_source_l00918}{918}} of file \doxymbox{\hyperlink{X__ops_8f90_source}{X\+\_\+ops.\+f90}}.

Here is the call graph for this function:\+\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacex__ops_a73a80c582379669f8e07b09dd7456878_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function:\+\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacex__ops_a73a80c582379669f8e07b09dd7456878_icgraph}
\end{center}
\end{figure}
\Hypertarget{namespacex__ops_a749acd00c1dd08da16d9bbce94422656}\index{x\_ops@{x\_ops}!print\_debug\_x\_1@{print\_debug\_x\_1}}
\index{print\_debug\_x\_1@{print\_debug\_x\_1}!x\_ops@{x\_ops}}
\doxysubsubsection{\texorpdfstring{print\_debug\_x\_1()}{print\_debug\_x\_1()}}
{\footnotesize\ttfamily \label{namespacex__ops_a749acd00c1dd08da16d9bbce94422656} 
integer function, public x\+\_\+ops::\+print\+\_\+debug\+\_\+x\+\_\+1 (\begin{DoxyParamCaption}\item[{type(\doxymbox{\hyperlink{structx__vars_1_1modes__type}{modes\+\_\+type}}), intent(in)}]{mds}{, }\item[{type(\doxymbox{\hyperlink{structgrid__vars_1_1grid__type}{grid\+\_\+type}}), intent(in)}]{grid\+\_\+x}{, }\item[{type(\doxymbox{\hyperlink{structx__vars_1_1x__1__type}{x\+\_\+1\+\_\+type}}), intent(in)}]{x\+\_\+1}{}\end{DoxyParamCaption})}



Prints debug information for X\+\_\+1 driver. 


\begin{DoxyParams}[1]{Parameters}
\doxymbox{\texttt{in}}  & {\em mds} & general modes variables \\
\hline
\doxymbox{\texttt{in}}  & {\em grid\+\_\+x} & perturbation grid \\
\hline
\doxymbox{\texttt{in}}  & {\em x\+\_\+1} & vectorial X variables \\
\hline
\end{DoxyParams}


Definition at line \doxymbox{\hyperlink{X__ops_8f90_source_l03489}{3489}} of file \doxymbox{\hyperlink{X__ops_8f90_source}{X\+\_\+ops.\+f90}}.

Here is the call graph for this function:\+\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacex__ops_a749acd00c1dd08da16d9bbce94422656_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function:\+\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacex__ops_a749acd00c1dd08da16d9bbce94422656_icgraph}
\end{center}
\end{figure}
\Hypertarget{namespacex__ops_ad7b07e5851eb44994a384363c86f35d6}\index{x\_ops@{x\_ops}!print\_debug\_x\_2@{print\_debug\_x\_2}}
\index{print\_debug\_x\_2@{print\_debug\_x\_2}!x\_ops@{x\_ops}}
\doxysubsubsection{\texorpdfstring{print\_debug\_x\_2()}{print\_debug\_x\_2()}}
{\footnotesize\ttfamily \label{namespacex__ops_ad7b07e5851eb44994a384363c86f35d6} 
integer function, public x\+\_\+ops::\+print\+\_\+debug\+\_\+x\+\_\+2 (\begin{DoxyParamCaption}\item[{type(\doxymbox{\hyperlink{structx__vars_1_1modes__type}{modes\+\_\+type}}), intent(in)}]{mds}{, }\item[{type(\doxymbox{\hyperlink{structgrid__vars_1_1grid__type}{grid\+\_\+type}}), intent(in)}]{grid\+\_\+x}{, }\item[{type(\doxymbox{\hyperlink{structx__vars_1_1x__2__type}{x\+\_\+2\+\_\+type}}), intent(in)}]{x\+\_\+2\+\_\+int}{}\end{DoxyParamCaption})}



Prints debug information for X\+\_\+2 driver. 


\begin{DoxyParams}[1]{Parameters}
\doxymbox{\texttt{in}}  & {\em mds} & general modes variables \\
\hline
\doxymbox{\texttt{in}}  & {\em grid\+\_\+x} & perturbation grid \\
\hline
\doxymbox{\texttt{in}}  & {\em x\+\_\+2\+\_\+int} & tensorial X variables \\
\hline
\end{DoxyParams}


Definition at line \doxymbox{\hyperlink{X__ops_8f90_source_l03632}{3632}} of file \doxymbox{\hyperlink{X__ops_8f90_source}{X\+\_\+ops.\+f90}}.

Here is the call graph for this function:\+\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacex__ops_ad7b07e5851eb44994a384363c86f35d6_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function:\+\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacex__ops_ad7b07e5851eb44994a384363c86f35d6_icgraph}
\end{center}
\end{figure}
\Hypertarget{namespacex__ops_abdaf1308e13cede3a153e8c6cf35a637}\index{x\_ops@{x\_ops}!resonance\_plot@{resonance\_plot}}
\index{resonance\_plot@{resonance\_plot}!x\_ops@{x\_ops}}
\doxysubsubsection{\texorpdfstring{resonance\_plot()}{resonance\_plot()}}
{\footnotesize\ttfamily \label{namespacex__ops_abdaf1308e13cede3a153e8c6cf35a637} 
integer function, public x\+\_\+ops::\+resonance\+\_\+plot (\begin{DoxyParamCaption}\item[{type(\doxymbox{\hyperlink{structx__vars_1_1modes__type}{modes\+\_\+type}}), intent(in)}]{mds}{, }\item[{type(\doxymbox{\hyperlink{structgrid__vars_1_1grid__type}{grid\+\_\+type}}), intent(in)}]{grid\+\_\+eq}{, }\item[{type(\doxymbox{\hyperlink{structeq__vars_1_1eq__1__type}{eq\+\_\+1\+\_\+type}}), intent(in)}]{eq}{}\end{DoxyParamCaption})}



plot $q$-\/profile or $\iota$-\/profile in flux coordinates with $nq-m = 0$ or $n-\iota m = 0$ indicated if requested. 

The plot will be done in the grid in which {\ttfamily mds} is tabulated, which is not necessarily the equilibrium one.

\begin{DoxyReturn}{Returns}
ierr 
\end{DoxyReturn}

\begin{DoxyParams}[1]{Parameters}
\doxymbox{\texttt{in}}  & {\em mds} & general modes variables \\
\hline
\doxymbox{\texttt{in}}  & {\em grid\+\_\+eq} & equilibrium grid \\
\hline
\doxymbox{\texttt{in}}  & {\em eq} & flux equilibrium \\
\hline
\end{DoxyParams}


Definition at line \doxymbox{\hyperlink{X__ops_8f90_source_l01813}{1813}} of file \doxymbox{\hyperlink{X__ops_8f90_source}{X\+\_\+ops.\+f90}}.

Here is the call graph for this function:\+\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacex__ops_abdaf1308e13cede3a153e8c6cf35a637_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function:\+\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacex__ops_abdaf1308e13cede3a153e8c6cf35a637_icgraph}
\end{center}
\end{figure}
\Hypertarget{namespacex__ops_a640d64aeae8a574eb05f164c1bdad3bd}\index{x\_ops@{x\_ops}!setup\_modes@{setup\_modes}}
\index{setup\_modes@{setup\_modes}!x\_ops@{x\_ops}}
\doxysubsubsection{\texorpdfstring{setup\_modes()}{setup\_modes()}}
{\footnotesize\ttfamily \label{namespacex__ops_a640d64aeae8a574eb05f164c1bdad3bd} 
integer function, public x\+\_\+ops::\+setup\+\_\+modes (\begin{DoxyParamCaption}\item[{type(\doxymbox{\hyperlink{structx__vars_1_1modes__type}{modes\+\_\+type}}), intent(inout), target}]{mds}{, }\item[{type(\doxymbox{\hyperlink{structgrid__vars_1_1grid__type}{grid\+\_\+type}}), intent(in)}]{grid\+\_\+eq}{, }\item[{type(\doxymbox{\hyperlink{structgrid__vars_1_1grid__type}{grid\+\_\+type}}), intent(in)}]{grid}{, }\item[{character(len=\texorpdfstring{$\ast$}{*}), intent(in), optional}]{plot\+\_\+name}{}\end{DoxyParamCaption})}



Sets up some variables concerning the mode numbers. 

Apart from the mode numbers
\begin{DoxyItemize}
\item {\ttfamily n}, {\ttfamily m},
\end{DoxyItemize}

also the variables of the secondary modes
\begin{DoxyItemize}
\item sec,
\end{DoxyItemize}

are set up in the coordinates of the grid passed. The normal values of this grid are saved as well, in
\begin{DoxyItemize}
\item r\+\_\+F.
\end{DoxyItemize}

All variables are tabulated in the full normal grid. The mode indices, however, are chosen so that there is maximum overlap between different normal positions. This is trivial for {\ttfamily X\+\_\+style} 1 (prescribed), but for {\ttfamily X\+\_\+style} 2 (fast), this is best explained by an example:\+\hypertarget{namespacex__ops_autotoc_md8}{}\doxysubsubsection{\texorpdfstring{kd m1 m2 m3}{kd m1 m2 m3}}\label{namespacex__ops_autotoc_md8}
1 10 11 12 \texorpdfstring{$<$}{<}-\/ start 2 10 11 12 \texorpdfstring{$<$}{<}-\/ no change in limits 2 13 11 12 \texorpdfstring{$<$}{<}-\/ limits shift up by one 3 13 11 12 \texorpdfstring{$<$}{<}-\/ no change in limits 4 13 14 12 \texorpdfstring{$<$}{<}-\/ limits shift up by one 5 16 14 15 \texorpdfstring{$<$}{<}-\/ limits shift up by two 6 13 14 15 \texorpdfstring{$<$}{<}-\/ limits shift down by one

This procedure makes use of the global variables
\begin{DoxyItemize}
\item {\ttfamily min\+\_\+m\+\_\+X}, max\+\_\+m\+\_\+X, min\+\_\+n\+\_\+X, max\+\_\+m\+\_\+X
\end{DoxyItemize}

that have to be set up using init\+\_\+nm\+\_\+x().

Optionally, {\ttfamily n} and {\ttfamily m} can be plot.

\begin{DoxyReturn}{Returns}
ierr 
\end{DoxyReturn}

\begin{DoxyParams}[1]{Parameters}
\doxymbox{\texttt{in,out}}  & {\em mds} & modes variables \\
\hline
\doxymbox{\texttt{in}}  & {\em grid\+\_\+eq} & equilibrium grid \\
\hline
\doxymbox{\texttt{in}}  & {\em grid} & grid at which to calculate modes \\
\hline
\doxymbox{\texttt{in}}  & {\em plot\+\_\+name} & name to be used when plotting {\ttfamily n} and {\ttfamily m} \\
\hline
\end{DoxyParams}


Definition at line \doxymbox{\hyperlink{X__ops_8f90_source_l01059}{1059}} of file \doxymbox{\hyperlink{X__ops_8f90_source}{X\+\_\+ops.\+f90}}.

Here is the call graph for this function:\+\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacex__ops_a640d64aeae8a574eb05f164c1bdad3bd_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function:\+\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacex__ops_a640d64aeae8a574eb05f164c1bdad3bd_icgraph}
\end{center}
\end{figure}


\label{doc-var-members}
\Hypertarget{namespacex__ops_doc-var-members}
\doxysubsection{Variable Documentation}
\Hypertarget{namespacex__ops_a342c624ea5f9a15264c78767da34684c}\index{x\_ops@{x\_ops}!debug\_check\_x\_modes\_2@{debug\_check\_x\_modes\_2}}
\index{debug\_check\_x\_modes\_2@{debug\_check\_x\_modes\_2}!x\_ops@{x\_ops}}
\doxysubsubsection{\texorpdfstring{debug\_check\_x\_modes\_2}{debug\_check\_x\_modes\_2}}
{\footnotesize\ttfamily \label{namespacex__ops_a342c624ea5f9a15264c78767da34684c} 
logical, public x\+\_\+ops::\+debug\+\_\+check\+\_\+x\+\_\+modes\+\_\+2 = .false.}



plot debug information for check\+\_\+x\+\_\+modes\+\_\+2() 

\begin{DoxyNote}{Note}
Debug version only 
\end{DoxyNote}


Definition at line \doxymbox{\hyperlink{X__ops_8f90_source_l00026}{26}} of file \doxymbox{\hyperlink{X__ops_8f90_source}{X\+\_\+ops.\+f90}}.

