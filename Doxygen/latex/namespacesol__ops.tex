\hypertarget{namespacesol__ops}{}\section{sol\+\_\+ops Module Reference}
\label{namespacesol__ops}\index{sol\+\_\+ops@{sol\+\_\+ops}}


Operations on the solution vectors such as decompososing the energy, etc...  


\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine, public \hyperlink{namespacesol__ops_a0d4a798a56cfee9bced781d116852165}{plot\+\_\+sol\+\_\+vals} (sol, last\+\_\+unstable\+\_\+id)
\begin{DoxyCompactList}\small\item\em Plots Eigenvalues. \end{DoxyCompactList}\item 
integer function, public \hyperlink{namespacesol__ops_a13b3cf2fb6437a3c93256368fa91c267}{plot\+\_\+sol\+\_\+vec} (mds\+\_\+X, mds\+\_\+sol, grid\+\_\+eq, grid\+\_\+X, grid\+\_\+sol, eq\+\_\+1, eq\+\_\+2, X, sol, X\+YZ, X\+\_\+id, plot\+\_\+var)
\begin{DoxyCompactList}\small\item\em Plots Eigenvectors. \end{DoxyCompactList}\item 
integer function, public \hyperlink{namespacesol__ops_a5cec8571480fbc319e7987732fd5995c}{plot\+\_\+harmonics} (mds, grid\+\_\+sol, sol, X\+\_\+id, res\+\_\+surf)
\begin{DoxyCompactList}\small\item\em Plots the harmonics and their maximum in 2-\/D. \end{DoxyCompactList}\item 
integer function, public \hyperlink{namespacesol__ops_aee487ffbe5d0edff5e37a6500748941c}{decompose\+\_\+energy} (mds\+\_\+X, mds\+\_\+sol, grid\+\_\+eq, grid\+\_\+X, grid\+\_\+sol, eq\+\_\+1, eq\+\_\+2, X, sol, vac, X\+\_\+id, B\+\_\+aligned, X\+YZ, E\+\_\+pot\+\_\+int, E\+\_\+kin\+\_\+int)
\begin{DoxyCompactList}\small\item\em Decomposes the plasma potential and kinetic energy in its individual terms for an individual Eigenvalue. \end{DoxyCompactList}\item 
integer function \hyperlink{namespacesol__ops_ae094c2a5235324b4aadb53623978d191}{calc\+\_\+e} (mds\+\_\+X, mds\+\_\+sol, grid\+\_\+eq, grid\+\_\+X, grid\+\_\+sol, eq\+\_\+1, eq\+\_\+2, X, sol, vac, B\+\_\+aligned, X\+\_\+id, E\+\_\+pot, E\+\_\+kin, E\+\_\+pot\+\_\+int, E\+\_\+kin\+\_\+int)
\begin{DoxyCompactList}\small\item\em Calculate the energy terms in the energy decomposition. \end{DoxyCompactList}\item 
integer function, public \hyperlink{namespacesol__ops_a06eb95d55da45ff2a1f830a380e0cf80}{print\+\_\+output\+\_\+sol} (grid, sol, data\+\_\+name, rich\+\_\+lvl, remove\+\_\+previous\+\_\+arrs)
\begin{DoxyCompactList}\small\item\em Print solution quantities to an output file\+: \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
logical, public \hyperlink{namespacesol__ops_ae0df0d66ef4ea0155cfbeb23973c28ac}{debug\+\_\+plot\+\_\+sol\+\_\+vec} = .false.
\begin{DoxyCompactList}\small\item\em plot debug information for \hyperlink{namespacesol__ops_a13b3cf2fb6437a3c93256368fa91c267}{plot\+\_\+sol\+\_\+vec()} \end{DoxyCompactList}\item 
logical, public \hyperlink{namespacesol__ops_a4dc364bc6b70b805abdc3ed0ab2e5226}{debug\+\_\+calc\+\_\+e} = .false.
\begin{DoxyCompactList}\small\item\em plot debug information for calc\+\_\+\+E() \end{DoxyCompactList}\item 
logical, public \hyperlink{namespacesol__ops_a718171b8636e5e4ad98fd4e35ca5b71f}{debug\+\_\+x\+\_\+norm} = .false.
\begin{DoxyCompactList}\small\item\em plot debug information {\ttfamily X\+\_\+norm} \end{DoxyCompactList}\item 
logical, public \hyperlink{namespacesol__ops_acb6465b87495933920896a52b4298a4c}{debug\+\_\+du} = .false.
\begin{DoxyCompactList}\small\item\em plot debug information for calculation of {\ttfamily DU} \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Operations on the solution vectors such as decompososing the energy, etc... 

\subsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacesol__ops_ae094c2a5235324b4aadb53623978d191}\label{namespacesol__ops_ae094c2a5235324b4aadb53623978d191}} 
\index{sol\+\_\+ops@{sol\+\_\+ops}!calc\+\_\+e@{calc\+\_\+e}}
\index{calc\+\_\+e@{calc\+\_\+e}!sol\+\_\+ops@{sol\+\_\+ops}}
\subsubsection{\texorpdfstring{calc\+\_\+e()}{calc\_e()}}
{\footnotesize\ttfamily integer function sol\+\_\+ops\+::calc\+\_\+e (\begin{DoxyParamCaption}\item[{type(modes\+\_\+type), intent(in)}]{mds\+\_\+X,  }\item[{type(modes\+\_\+type), intent(in)}]{mds\+\_\+sol,  }\item[{type(\hyperlink{structgrid__vars_1_1grid__type}{grid\+\_\+type}), intent(in)}]{grid\+\_\+eq,  }\item[{type(\hyperlink{structgrid__vars_1_1grid__type}{grid\+\_\+type}), intent(in)}]{grid\+\_\+X,  }\item[{type(\hyperlink{structgrid__vars_1_1grid__type}{grid\+\_\+type}), intent(in)}]{grid\+\_\+sol,  }\item[{type(\hyperlink{structeq__vars_1_1eq__1__type}{eq\+\_\+1\+\_\+type}), intent(in)}]{eq\+\_\+1,  }\item[{type(\hyperlink{structeq__vars_1_1eq__2__type}{eq\+\_\+2\+\_\+type}), intent(in)}]{eq\+\_\+2,  }\item[{type(x\+\_\+1\+\_\+type), intent(in)}]{X,  }\item[{type(\hyperlink{structsol__vars_1_1sol__type}{sol\+\_\+type}), intent(in)}]{sol,  }\item[{type(\hyperlink{structvac__vars_1_1vac__type}{vac\+\_\+type}), intent(in)}]{vac,  }\item[{logical, intent(in)}]{B\+\_\+aligned,  }\item[{integer, intent(in)}]{X\+\_\+id,  }\item[{complex(dp), dimension(\+:,\+:,\+:,\+:), intent(inout), allocatable}]{E\+\_\+pot,  }\item[{complex(dp), dimension(\+:,\+:,\+:,\+:), intent(inout), allocatable}]{E\+\_\+kin,  }\item[{complex(dp), dimension(7), intent(inout)}]{E\+\_\+pot\+\_\+int,  }\item[{complex(dp), dimension(2), intent(inout)}]{E\+\_\+kin\+\_\+int }\end{DoxyParamCaption})}



Calculate the energy terms in the energy decomposition. 

\begin{DoxyNote}{Note}
see explanation of routine in \hyperlink{namespacesol__ops_aee487ffbe5d0edff5e37a6500748941c}{decompose\+\_\+energy()}.
\end{DoxyNote}
\begin{DoxyReturn}{Returns}
ierr
\end{DoxyReturn}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em mds\+\_\+x} & general modes variables in perturbation grid\\
\hline
\mbox{\tt in}  & {\em mds\+\_\+sol} & general modes variables in solution grid\\
\hline
\mbox{\tt in}  & {\em grid\+\_\+eq} & equilibrium grid\\
\hline
\mbox{\tt in}  & {\em grid\+\_\+x} & perturbation grid\\
\hline
\mbox{\tt in}  & {\em grid\+\_\+sol} & and solution grid\\
\hline
\mbox{\tt in}  & {\em eq\+\_\+1} & flux equilibrium\\
\hline
\mbox{\tt in}  & {\em eq\+\_\+2} & metric equilibrium\\
\hline
\mbox{\tt in}  & {\em x} & perturbation variables\\
\hline
\mbox{\tt in}  & {\em sol} & solution variables\\
\hline
\mbox{\tt in}  & {\em vac} & vacuum variables\\
\hline
\mbox{\tt in}  & {\em b\+\_\+aligned} & whether grid is field-\/aligned\\
\hline
\mbox{\tt in}  & {\em x\+\_\+id} & nr. of Eigenvalue\\
\hline
\mbox{\tt in,out}  & {\em e\+\_\+pot} & potential energy\\
\hline
\mbox{\tt in,out}  & {\em e\+\_\+kin} & kinetic energy\\
\hline
\mbox{\tt in,out}  & {\em e\+\_\+pot\+\_\+int} & integrated potential energy\\
\hline
\mbox{\tt in,out}  & {\em e\+\_\+kin\+\_\+int} & integrated kinetic energy \\
\hline
\end{DoxyParams}


Definition at line 1189 of file sol\+\_\+ops.\+f90.

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacesol__ops_ae094c2a5235324b4aadb53623978d191_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacesol__ops_ae094c2a5235324b4aadb53623978d191_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacesol__ops_aee487ffbe5d0edff5e37a6500748941c}\label{namespacesol__ops_aee487ffbe5d0edff5e37a6500748941c}} 
\index{sol\+\_\+ops@{sol\+\_\+ops}!decompose\+\_\+energy@{decompose\+\_\+energy}}
\index{decompose\+\_\+energy@{decompose\+\_\+energy}!sol\+\_\+ops@{sol\+\_\+ops}}
\subsubsection{\texorpdfstring{decompose\+\_\+energy()}{decompose\_energy()}}
{\footnotesize\ttfamily integer function, public sol\+\_\+ops\+::decompose\+\_\+energy (\begin{DoxyParamCaption}\item[{type(modes\+\_\+type), intent(in)}]{mds\+\_\+X,  }\item[{type(modes\+\_\+type), intent(in)}]{mds\+\_\+sol,  }\item[{type(\hyperlink{structgrid__vars_1_1grid__type}{grid\+\_\+type}), intent(in)}]{grid\+\_\+eq,  }\item[{type(\hyperlink{structgrid__vars_1_1grid__type}{grid\+\_\+type}), intent(in)}]{grid\+\_\+X,  }\item[{type(\hyperlink{structgrid__vars_1_1grid__type}{grid\+\_\+type}), intent(in)}]{grid\+\_\+sol,  }\item[{type(\hyperlink{structeq__vars_1_1eq__1__type}{eq\+\_\+1\+\_\+type}), intent(in)}]{eq\+\_\+1,  }\item[{type(\hyperlink{structeq__vars_1_1eq__2__type}{eq\+\_\+2\+\_\+type}), intent(in)}]{eq\+\_\+2,  }\item[{type(x\+\_\+1\+\_\+type), intent(in)}]{X,  }\item[{type(\hyperlink{structsol__vars_1_1sol__type}{sol\+\_\+type}), intent(in)}]{sol,  }\item[{type(\hyperlink{structvac__vars_1_1vac__type}{vac\+\_\+type}), intent(in)}]{vac,  }\item[{integer, intent(in)}]{X\+\_\+id,  }\item[{logical, intent(in)}]{B\+\_\+aligned,  }\item[{real(dp), dimension(\+:,\+:,\+:,\+:), intent(in), optional}]{X\+YZ,  }\item[{complex(dp), dimension(7), intent(inout), optional}]{E\+\_\+pot\+\_\+int,  }\item[{complex(dp), dimension(2), intent(inout), optional}]{E\+\_\+kin\+\_\+int }\end{DoxyParamCaption})}



Decomposes the plasma potential and kinetic energy in its individual terms for an individual Eigenvalue. 

Use is made of variables representing the potential and kinetic energy \cite{Weyens3D}.
\begin{DoxyItemize}
\item $E_\text{pot}$\+:
\begin{DoxyItemize}
\item normal line bending term\+: $\frac{1}{\mu_0} \frac{Q_n^2}{h^{22}}$,
\item geodesic line bending term\+: $\frac{1}{\mu_0} \mathcal{J}^2 \frac{h^{22}}{g_{33}} Q_g^2$,
\item normal ballooning term\+: $-2 p' X^2 \kappa_n$,
\item geodesic ballooning term\+: $-2 p' X U^* \kappa_g$,
\item normal kink term\+: $-\sigma X^*Q_g$,
\item geodesic kink term\+: $\sigma U^*Q_n$,
\end{DoxyItemize}
\item $E_\text{kin}$\+:
\begin{DoxyItemize}
\item normal kinetic term\+: $\rho \frac{X^2}{h^{22}}$,
\item geodesic kinetic term\+: $\rho \mathcal{J}^2 \frac{h^{22}}{g_{33}} U^2$.
\end{DoxyItemize}
\end{DoxyItemize}

The energy terms are calculated normally on the sol grid, interpolating the quantities defined on the eq grid, and angularly in the eq grid.

Optionally, the results can be plotted by providing X, Y and Z. By default, they are instead written to an output file.

Also, the fraction between potential and kinetic energy can be returned, compared with the eigenvalue.

\begin{DoxyReturn}{Returns}
ierr
\end{DoxyReturn}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em mds\+\_\+x} & general modes variables in pertubation grid\\
\hline
\mbox{\tt in}  & {\em mds\+\_\+sol} & general modes variables in solution grid\\
\hline
\mbox{\tt in}  & {\em grid\+\_\+eq} & equilibrium grid\\
\hline
\mbox{\tt in}  & {\em grid\+\_\+x} & perturbation grid\\
\hline
\mbox{\tt in}  & {\em grid\+\_\+sol} & solution grid\\
\hline
\mbox{\tt in}  & {\em eq\+\_\+1} & flux equilibrium\\
\hline
\mbox{\tt in}  & {\em eq\+\_\+2} & metric equilibrium\\
\hline
\mbox{\tt in}  & {\em x} & perturbation variables\\
\hline
\mbox{\tt in}  & {\em sol} & solution variables\\
\hline
\mbox{\tt in}  & {\em vac} & vacuum variables\\
\hline
\mbox{\tt in}  & {\em x\+\_\+id} & nr. of Eigenvalue\\
\hline
\mbox{\tt in}  & {\em b\+\_\+aligned} & whether grid is field-\/aligned\\
\hline
\mbox{\tt in}  & {\em xyz} & X, Y and Z for plotting\\
\hline
\mbox{\tt in,out}  & {\em e\+\_\+pot\+\_\+int} & integrated potential energy\\
\hline
\mbox{\tt in,out}  & {\em e\+\_\+kin\+\_\+int} & integrated kinetic energy \\
\hline
\end{DoxyParams}


Definition at line 975 of file sol\+\_\+ops.\+f90.

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacesol__ops_aee487ffbe5d0edff5e37a6500748941c_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacesol__ops_aee487ffbe5d0edff5e37a6500748941c_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacesol__ops_a5cec8571480fbc319e7987732fd5995c}\label{namespacesol__ops_a5cec8571480fbc319e7987732fd5995c}} 
\index{sol\+\_\+ops@{sol\+\_\+ops}!plot\+\_\+harmonics@{plot\+\_\+harmonics}}
\index{plot\+\_\+harmonics@{plot\+\_\+harmonics}!sol\+\_\+ops@{sol\+\_\+ops}}
\subsubsection{\texorpdfstring{plot\+\_\+harmonics()}{plot\_harmonics()}}
{\footnotesize\ttfamily integer function, public sol\+\_\+ops\+::plot\+\_\+harmonics (\begin{DoxyParamCaption}\item[{type(modes\+\_\+type), intent(in)}]{mds,  }\item[{type(\hyperlink{structgrid__vars_1_1grid__type}{grid\+\_\+type}), intent(in)}]{grid\+\_\+sol,  }\item[{type(\hyperlink{structsol__vars_1_1sol__type}{sol\+\_\+type}), intent(in)}]{sol,  }\item[{integer, intent(in)}]{X\+\_\+id,  }\item[{real(dp), dimension(\+:,\+:), intent(in)}]{res\+\_\+surf }\end{DoxyParamCaption})}



Plots the harmonics and their maximum in 2-\/D. 

\begin{DoxyReturn}{Returns}
ierr
\end{DoxyReturn}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em mds} & general modes variables in solution grid\\
\hline
\mbox{\tt in}  & {\em grid\+\_\+sol} & solution grid\\
\hline
\mbox{\tt in}  & {\em sol} & solution variables\\
\hline
\mbox{\tt in}  & {\em x\+\_\+id} & nr. of Eigenvalue (for output name)\\
\hline
\mbox{\tt in}  & {\em res\+\_\+surf} & resonant surfaces \\
\hline
\end{DoxyParams}


Definition at line 630 of file sol\+\_\+ops.\+f90.

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacesol__ops_a5cec8571480fbc319e7987732fd5995c_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacesol__ops_a5cec8571480fbc319e7987732fd5995c_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacesol__ops_a0d4a798a56cfee9bced781d116852165}\label{namespacesol__ops_a0d4a798a56cfee9bced781d116852165}} 
\index{sol\+\_\+ops@{sol\+\_\+ops}!plot\+\_\+sol\+\_\+vals@{plot\+\_\+sol\+\_\+vals}}
\index{plot\+\_\+sol\+\_\+vals@{plot\+\_\+sol\+\_\+vals}!sol\+\_\+ops@{sol\+\_\+ops}}
\subsubsection{\texorpdfstring{plot\+\_\+sol\+\_\+vals()}{plot\_sol\_vals()}}
{\footnotesize\ttfamily subroutine, public sol\+\_\+ops\+::plot\+\_\+sol\+\_\+vals (\begin{DoxyParamCaption}\item[{type(\hyperlink{structsol__vars_1_1sol__type}{sol\+\_\+type}), intent(in)}]{sol,  }\item[{integer, intent(in)}]{last\+\_\+unstable\+\_\+id }\end{DoxyParamCaption})}



Plots Eigenvalues. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em sol} & solution variables\\
\hline
\mbox{\tt in}  & {\em last\+\_\+unstable\+\_\+id} & index of last unstable EV \\
\hline
\end{DoxyParams}


Definition at line 37 of file sol\+\_\+ops.\+f90.

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacesol__ops_a0d4a798a56cfee9bced781d116852165_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacesol__ops_a0d4a798a56cfee9bced781d116852165_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacesol__ops_a13b3cf2fb6437a3c93256368fa91c267}\label{namespacesol__ops_a13b3cf2fb6437a3c93256368fa91c267}} 
\index{sol\+\_\+ops@{sol\+\_\+ops}!plot\+\_\+sol\+\_\+vec@{plot\+\_\+sol\+\_\+vec}}
\index{plot\+\_\+sol\+\_\+vec@{plot\+\_\+sol\+\_\+vec}!sol\+\_\+ops@{sol\+\_\+ops}}
\subsubsection{\texorpdfstring{plot\+\_\+sol\+\_\+vec()}{plot\_sol\_vec()}}
{\footnotesize\ttfamily integer function, public sol\+\_\+ops\+::plot\+\_\+sol\+\_\+vec (\begin{DoxyParamCaption}\item[{type(modes\+\_\+type), intent(in)}]{mds\+\_\+X,  }\item[{type(modes\+\_\+type), intent(in)}]{mds\+\_\+sol,  }\item[{type(\hyperlink{structgrid__vars_1_1grid__type}{grid\+\_\+type}), intent(in)}]{grid\+\_\+eq,  }\item[{type(\hyperlink{structgrid__vars_1_1grid__type}{grid\+\_\+type}), intent(in)}]{grid\+\_\+X,  }\item[{type(\hyperlink{structgrid__vars_1_1grid__type}{grid\+\_\+type}), intent(in)}]{grid\+\_\+sol,  }\item[{type(\hyperlink{structeq__vars_1_1eq__1__type}{eq\+\_\+1\+\_\+type}), intent(in)}]{eq\+\_\+1,  }\item[{type(\hyperlink{structeq__vars_1_1eq__2__type}{eq\+\_\+2\+\_\+type}), intent(in)}]{eq\+\_\+2,  }\item[{type(x\+\_\+1\+\_\+type), intent(in)}]{X,  }\item[{type(\hyperlink{structsol__vars_1_1sol__type}{sol\+\_\+type}), intent(in)}]{sol,  }\item[{real(dp), dimension(\+:,\+:,\+:,\+:), intent(in)}]{X\+YZ,  }\item[{integer, intent(in)}]{X\+\_\+id,  }\item[{logical, dimension(2), intent(in)}]{plot\+\_\+var }\end{DoxyParamCaption})}



Plots Eigenvectors. 

This is done using the angular part of the the provided equilibrium grid and the normal part of the provided solution grid.

The perturbtion grid is assumed to have the same angular coordinates as the equilibrium grid, and the normal coordinates correspond to either the equilibrium grid ({\ttfamily X\+\_\+grid\+\_\+style} 1), the solution grid ({\ttfamily X\+\_\+grid\+\_\+style} 2) or the enriched equilibrium grid ({\ttfamily X\+\_\+grid\+\_\+style} 3).

The output grid, furthermore, has the angular part corresponding to the equilibrium grid, and the normal part to the solution grid.

\begin{DoxyNote}{Note}
The normalization factors are taken into account and the output is transformed back to unnormalized values\+: \[\begin{aligned} \vec{\xi} &\sim \frac{X_0}{R_0 B_0} \ , \\ \vec{Q} &\sim \frac{X_0}{R_0^2} \ , \\ \end{aligned}\]
\end{DoxyNote}
which translates to \[\begin{aligned} X &\sim X_0 \ , \\ U &\sim \frac{X_0}{R_0^2 B_0} \ , \\ Qn &\sim \frac{X_0 B_0}{R_0} \ , \\ Qg &\sim \frac{X_0}{R_0^3} \ , \end{aligned}\] where $X_0$ is not determined but is common to all factors.

\begin{DoxyReturn}{Returns}
ierr
\end{DoxyReturn}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em mds\+\_\+x} & general modes variables in perturbation grid\\
\hline
\mbox{\tt in}  & {\em mds\+\_\+sol} & general modes variables in solution grid\\
\hline
\mbox{\tt in}  & {\em grid\+\_\+eq} & equilibrium grid\\
\hline
\mbox{\tt in}  & {\em grid\+\_\+x} & perturbation grid\\
\hline
\mbox{\tt in}  & {\em grid\+\_\+sol} & solution grid\\
\hline
\mbox{\tt in}  & {\em eq\+\_\+1} & flux equilibrium\\
\hline
\mbox{\tt in}  & {\em eq\+\_\+2} & metric equilibrium\\
\hline
\mbox{\tt in}  & {\em x} & perturbation variables\\
\hline
\mbox{\tt in}  & {\em sol} & solution variables\\
\hline
\mbox{\tt in}  & {\em xyz} & X, Y and Z of extended eq\+\_\+grid\\
\hline
\mbox{\tt in}  & {\em x\+\_\+id} & nr. of Eigenvalue (for output name)\\
\hline
\mbox{\tt in}  & {\em plot\+\_\+var} & whether variables are plotted (1\+: plasma perturbation, 2\+: magnetic perturbation) \\
\hline
\end{DoxyParams}


Definition at line 116 of file sol\+\_\+ops.\+f90.

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacesol__ops_a13b3cf2fb6437a3c93256368fa91c267_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacesol__ops_a13b3cf2fb6437a3c93256368fa91c267_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacesol__ops_a06eb95d55da45ff2a1f830a380e0cf80}\label{namespacesol__ops_a06eb95d55da45ff2a1f830a380e0cf80}} 
\index{sol\+\_\+ops@{sol\+\_\+ops}!print\+\_\+output\+\_\+sol@{print\+\_\+output\+\_\+sol}}
\index{print\+\_\+output\+\_\+sol@{print\+\_\+output\+\_\+sol}!sol\+\_\+ops@{sol\+\_\+ops}}
\subsubsection{\texorpdfstring{print\+\_\+output\+\_\+sol()}{print\_output\_sol()}}
{\footnotesize\ttfamily integer function, public sol\+\_\+ops\+::print\+\_\+output\+\_\+sol (\begin{DoxyParamCaption}\item[{type(\hyperlink{structgrid__vars_1_1grid__type}{grid\+\_\+type}), intent(in)}]{grid,  }\item[{type(\hyperlink{structsol__vars_1_1sol__type}{sol\+\_\+type}), intent(in)}]{sol,  }\item[{character(len=$\ast$), intent(in)}]{data\+\_\+name,  }\item[{integer, intent(in), optional}]{rich\+\_\+lvl,  }\item[{logical, intent(in), optional}]{remove\+\_\+previous\+\_\+arrs }\end{DoxyParamCaption})}



Print solution quantities to an output file\+: 


\begin{DoxyItemize}
\item sol\+:
\begin{DoxyItemize}
\item {\ttfamily val} 
\item {\ttfamily vec} 
\end{DoxyItemize}
\end{DoxyItemize}

If {\ttfamily rich\+\_\+lvl} is provided, {\ttfamily \char`\"{}\+\_\+\mbox{[}\+R\+\_\+rich\+\_\+lvl\mbox{]}\char`\"{}} is appended to the data name if it is {\ttfamily $>$0}.

\begin{DoxyReturn}{Returns}
ierr
\end{DoxyReturn}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em grid} & solution grid variables\\
\hline
\mbox{\tt in}  & {\em sol} & solution variables\\
\hline
\mbox{\tt in}  & {\em data\+\_\+name} & name under which to store\\
\hline
\mbox{\tt in}  & {\em rich\+\_\+lvl} & Richardson level to print\\
\hline
\mbox{\tt in}  & {\em remove\+\_\+previous\+\_\+arrs} & remove previous variables if present \\
\hline
\end{DoxyParams}


Definition at line 1550 of file sol\+\_\+ops.\+f90.

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacesol__ops_a06eb95d55da45ff2a1f830a380e0cf80_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacesol__ops_a06eb95d55da45ff2a1f830a380e0cf80_icgraph}
\end{center}
\end{figure}


\subsection{Variable Documentation}
\mbox{\Hypertarget{namespacesol__ops_a4dc364bc6b70b805abdc3ed0ab2e5226}\label{namespacesol__ops_a4dc364bc6b70b805abdc3ed0ab2e5226}} 
\index{sol\+\_\+ops@{sol\+\_\+ops}!debug\+\_\+calc\+\_\+e@{debug\+\_\+calc\+\_\+e}}
\index{debug\+\_\+calc\+\_\+e@{debug\+\_\+calc\+\_\+e}!sol\+\_\+ops@{sol\+\_\+ops}}
\subsubsection{\texorpdfstring{debug\+\_\+calc\+\_\+e}{debug\_calc\_e}}
{\footnotesize\ttfamily logical, public sol\+\_\+ops\+::debug\+\_\+calc\+\_\+e = .false.}



plot debug information for calc\+\_\+\+E() 

\begin{DoxyNote}{Note}
Debug version only 
\end{DoxyNote}


Definition at line 29 of file sol\+\_\+ops.\+f90.

\mbox{\Hypertarget{namespacesol__ops_acb6465b87495933920896a52b4298a4c}\label{namespacesol__ops_acb6465b87495933920896a52b4298a4c}} 
\index{sol\+\_\+ops@{sol\+\_\+ops}!debug\+\_\+du@{debug\+\_\+du}}
\index{debug\+\_\+du@{debug\+\_\+du}!sol\+\_\+ops@{sol\+\_\+ops}}
\subsubsection{\texorpdfstring{debug\+\_\+du}{debug\_du}}
{\footnotesize\ttfamily logical, public sol\+\_\+ops\+::debug\+\_\+du = .false.}



plot debug information for calculation of {\ttfamily DU} 

\begin{DoxyNote}{Note}
Debug version only 
\end{DoxyNote}


Definition at line 31 of file sol\+\_\+ops.\+f90.

\mbox{\Hypertarget{namespacesol__ops_ae0df0d66ef4ea0155cfbeb23973c28ac}\label{namespacesol__ops_ae0df0d66ef4ea0155cfbeb23973c28ac}} 
\index{sol\+\_\+ops@{sol\+\_\+ops}!debug\+\_\+plot\+\_\+sol\+\_\+vec@{debug\+\_\+plot\+\_\+sol\+\_\+vec}}
\index{debug\+\_\+plot\+\_\+sol\+\_\+vec@{debug\+\_\+plot\+\_\+sol\+\_\+vec}!sol\+\_\+ops@{sol\+\_\+ops}}
\subsubsection{\texorpdfstring{debug\+\_\+plot\+\_\+sol\+\_\+vec}{debug\_plot\_sol\_vec}}
{\footnotesize\ttfamily logical, public sol\+\_\+ops\+::debug\+\_\+plot\+\_\+sol\+\_\+vec = .false.}



plot debug information for \hyperlink{namespacesol__ops_a13b3cf2fb6437a3c93256368fa91c267}{plot\+\_\+sol\+\_\+vec()} 

\begin{DoxyNote}{Note}
Debug version only 
\end{DoxyNote}


Definition at line 27 of file sol\+\_\+ops.\+f90.

\mbox{\Hypertarget{namespacesol__ops_a718171b8636e5e4ad98fd4e35ca5b71f}\label{namespacesol__ops_a718171b8636e5e4ad98fd4e35ca5b71f}} 
\index{sol\+\_\+ops@{sol\+\_\+ops}!debug\+\_\+x\+\_\+norm@{debug\+\_\+x\+\_\+norm}}
\index{debug\+\_\+x\+\_\+norm@{debug\+\_\+x\+\_\+norm}!sol\+\_\+ops@{sol\+\_\+ops}}
\subsubsection{\texorpdfstring{debug\+\_\+x\+\_\+norm}{debug\_x\_norm}}
{\footnotesize\ttfamily logical, public sol\+\_\+ops\+::debug\+\_\+x\+\_\+norm = .false.}



plot debug information {\ttfamily X\+\_\+norm} 

\begin{DoxyNote}{Note}
Debug version only 
\end{DoxyNote}


Definition at line 30 of file sol\+\_\+ops.\+f90.

