\doxysection{VMEC\+\_\+ops.\+f90}
\hypertarget{VMEC__ops_8f90_source}{}\label{VMEC__ops_8f90_source}\index{/Users/toonweyens/Code/PB3D/Modules/VMEC\_ops.f90@{/Users/toonweyens/Code/PB3D/Modules/VMEC\_ops.f90}}
\doxymbox{\hyperlink{VMEC__ops_8f90}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00001}00001\ \textcolor{comment}{!-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/!}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00002}00002\ \textcolor{comment}{!>\ Operations\ that\ concern\ the\ output\ of\ VMEC.}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00003}00003\ \textcolor{comment}{!-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/!}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00004}\doxymbox{\hyperlink{namespacevmec__ops}{00004}}\ \textcolor{keyword}{module}\ \doxymbox{\hyperlink{namespacevmec__ops}{vmec\_ops}}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00005}00005\ \textcolor{preprocessor}{\#include\ <PB3D\_macros.h>}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00006}00006\ \textcolor{preprocessor}{}\ \ \ \ \textcolor{keywordtype}{use\ }\doxymbox{\hyperlink{namespacestr__utilities}{str\_utilities}}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00007}00007\ \ \ \ \ \textcolor{keywordtype}{use\ }\doxymbox{\hyperlink{namespaceoutput__ops}{output\_ops}}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00008}00008\ \ \ \ \ \textcolor{keywordtype}{use\ }\doxymbox{\hyperlink{namespacemessages}{messages}}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00009}00009\ \ \ \ \ \textcolor{keywordtype}{use\ }\doxymbox{\hyperlink{namespacenum__vars}{num\_vars}},\ \textcolor{keywordtype}{only}:\ \&}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00010}00010\ \ \ \ \ \ \ \ \ \&\doxymbox{\hyperlink{namespacenum__vars_a03802aa2bd86439d7a9370836fabf3f2}{dp}},\ \doxymbox{\hyperlink{namespacenum__vars_a3ff2bb983ee80a6735277d6789e6ce7c}{max\_str\_ln}},\ \doxymbox{\hyperlink{namespacenum__vars_a26f47310576a3414135b3d3fcc079709}{pi}}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00011}00011\ \ \ \ \ \textcolor{keywordtype}{use\ }read\_wout\_mod,\ \textcolor{keywordtype}{only}:\ read\_wout\_file,\ read\_wout\_deallocate,\ \&\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{!\ from\ LIBSTELL}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00012}00012\ \ \ \ \ \ \ \ \ \&n\_r\_vmec\ =>\ ns,\ \&\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{!\ n\_r}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00013}00013\ \ \ \ \ \ \ \ \ \&xn,\ xm,\ \&\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{!\ xn,\ xm}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00014}00014\ \ \ \ \ \ \ \ \ \&lrfp,\ \&\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{!\ whether\ or\ not\ the\ poloidal\ flux\ is\ used\ as\ radial\ variable}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00015}00015\ \ \ \ \ \ \ \ \ \&phi,\ phipf,\ \&\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{!\ toroidal\ flux\ (FM),\ norm.\ deriv.\ of\ toroidal\ flux\ (FM)}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00016}00016\ \ \ \ \ \ \ \ \ \&iotaf,\ \&\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{!\ rot.\ transf.\ (tor.\ flux)\ or\ saf.\ fac.\ (pol.\ flux)\ (FM)}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00017}00017\ \ \ \ \ \ \ \ \ \&presf,\ \&\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{!\ pressure\ (FM)}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00018}00018\ \ \ \ \ \ \ \ \ \&bsubumns,\ bsubumnc,\ bsubvmns,\ bsubvmnc,\ bsubsmns,\ bsubsmnc,\ \&\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{!\ B\_theta\ (HM),\ B\_zeta\ (HM),\ B\_r\ (FM)}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00019}00019\ \ \ \ \ \ \ \ \ \&jcuru,\ jcurv,\ \&\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{!\ poloidal\ (FM)\ and\ toroidal\ (FM)\ current}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00020}00020\ \ \ \ \ \ \ \ \ \&bmns,\ bmnc,\ \&\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{!\ magnitude\ of\ B\ (HM)}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00021}00021\ \ \ \ \ \ \ \ \ \&lmns,\ lmnc,\ rmns,\ rmnc,\ zmns,\ zmnc,\ \&\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{!\ lambda\ (HM),\ R\ (FM),\ Z(FM)}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00022}00022\ \ \ \ \ \ \ \ \ \&gmnc,\ gmns\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{!\ Jacobian\ in\ VMEC\ coordinates}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00023}00023\ \ \ \ \ \textcolor{keywordtype}{use\ }\doxymbox{\hyperlink{namespacevmec__vars}{vmec\_vars}}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00024}00024\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00025}00025\ \ \ \ \ \textcolor{keywordtype}{implicit\ none}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00026}00026\ \ \ \ \ \textcolor{keywordtype}{private}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00027}00027\ \ \ \ \ \textcolor{keywordtype}{public}\ \doxymbox{\hyperlink{namespacevmec__ops_a3df3b64d29e4242be9116a7a04275103}{read\_vmec}},\ \doxymbox{\hyperlink{namespacevmec__ops_a95f04a642fd732a538aef30052a12863}{normalize\_vmec}}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00028}00028\ }
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00029}00029\ \textcolor{keyword}{contains}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00030}00030\ \textcolor{comment}{\ \ \ \ !>\ Reads\ the\ VMEC\ equilibrium\ data.}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00031}00031\ \textcolor{comment}{\ \ \ \ !!}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00032}00032\ \textcolor{comment}{\ \ \ \ !!\ \(\backslash\)return\ ierr}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00033}\doxymbox{\hyperlink{namespacevmec__ops_a3df3b64d29e4242be9116a7a04275103}{00033}}\ \ \ \ \ \textcolor{keyword}{integer\ }\textcolor{keyword}{function\ }\doxymbox{\hyperlink{namespacevmec__ops_a3df3b64d29e4242be9116a7a04275103}{read\_vmec}}(n\_r\_in,use\_pol\_flux\_V)\ \textcolor{keyword}{result}(ierr)}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00034}00034\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{use\ }\doxymbox{\hyperlink{namespacenum__utilities}{num\_utilities}},\ \textcolor{keywordtype}{only}:\ \doxymbox{\hyperlink{interfacenum__utilities_1_1calc__int}{calc\_int}},\ \doxymbox{\hyperlink{interfacenum__utilities_1_1spline}{spline}}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00035}00035\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{use\ }\doxymbox{\hyperlink{namespacenum__vars}{num\_vars}},\ \textcolor{keywordtype}{only}:\ \doxymbox{\hyperlink{namespacenum__vars_a3cc0fc4b1538f7203be1604cb4f7c9bc}{eq\_name}},\ \doxymbox{\hyperlink{namespacenum__vars_a78f5aeea9d9c2f41e388bfcef9021e64}{max\_deriv}},\ \doxymbox{\hyperlink{namespacenum__vars_a9554337420be2ea367f2a6bc71bb654f}{norm\_disc\_prec\_eq}}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00036}00036\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00037}00037\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{character(*)},\ \textcolor{keywordtype}{parameter}\ ::\ rout\_name\ =\ \textcolor{stringliteral}{'read\_VMEC'}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00038}00038\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00039}00039\ \ \ \ \ \ \ \ \ \textcolor{comment}{!\ input\ /\ output}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00040}00040\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{integer},\ \textcolor{keywordtype}{intent(inout)}\ ::\ n\_r\_in\textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ !<\ nr.\ of\ normal\ points\ in\ input\ grid}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00041}00041\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{logical},\ \textcolor{keywordtype}{intent(inout)}\ ::\ use\_pol\_flux\_v\textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ !<\ .true.\ if\ VMEC\ equilibrium\ is\ based\ on\ poloidal\ flux}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00042}00042\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00043}00043\ \ \ \ \ \ \ \ \ \textcolor{comment}{!\ local\ variables}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00044}00044\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{integer}\ ::\ id,\ kd\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{!\ counters}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00045}00045\ \textcolor{keywordtype}{\ \ \ \ \ \ \ \ real}(\doxymbox{\hyperlink{namespacenum__vars_a03802aa2bd86439d7a9370836fabf3f2}{dp}}),\ \textcolor{keywordtype}{allocatable}\ ::\ r\_v(:)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{!\ normal\ coordinate}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00046}00046\ \textcolor{keywordtype}{\ \ \ \ \ \ \ \ real}(\doxymbox{\hyperlink{namespacenum__vars_a03802aa2bd86439d7a9370836fabf3f2}{dp}}),\ \textcolor{keywordtype}{allocatable}\ ::\ l\_c\_h(:,:,:)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{!\ temporary\ HM\ variable}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00047}00047\ \textcolor{keywordtype}{\ \ \ \ \ \ \ \ real}(\doxymbox{\hyperlink{namespacenum__vars_a03802aa2bd86439d7a9370836fabf3f2}{dp}}),\ \textcolor{keywordtype}{allocatable}\ ::\ l\_s\_h(:,:,:)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{!\ temporary\ HM\ variable}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00048}00048\ \textcolor{keywordtype}{\ \ \ \ \ \ \ \ real}(\doxymbox{\hyperlink{namespacenum__vars_a03802aa2bd86439d7a9370836fabf3f2}{dp}}),\ \textcolor{keywordtype}{allocatable}\ ::\ jac\_c\_h(:,:,:)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{!\ temporary\ HM\ variable}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00049}00049\ \textcolor{keywordtype}{\ \ \ \ \ \ \ \ real}(\doxymbox{\hyperlink{namespacenum__vars_a03802aa2bd86439d7a9370836fabf3f2}{dp}}),\ \textcolor{keywordtype}{allocatable}\ ::\ jac\_s\_h(:,:,:)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{!\ temporary\ HM\ variable}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00050}00050\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{character(len=max\_str\_ln)}\ ::\ err\_msg\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{!\ error\ message}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00051}00051\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{character(len=8)}\ ::\ flux\_name\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{!\ either\ poloidal\ or\ toroidal}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00052}00052\ \textcolor{keywordtype}{\ \ \ \ \ \ \ \ real}(\doxymbox{\hyperlink{namespacenum__vars_a03802aa2bd86439d7a9370836fabf3f2}{dp}}),\ \textcolor{keywordtype}{allocatable}\ ::\ b\_v\_sub\_c\_m(:,:,:),\ b\_v\_sub\_s\_m(:,:,:)\ \ \ \ \ \ \ \ \ \textcolor{comment}{!\ Coeff.\ of\ B\_i\ in\ (co)sine\ series\ (r,theta,phi)\ (FM,\ HM,\ HM)}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00053}00053\ \textcolor{preprocessor}{\#if\ ldebug}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00054}00054\ \textcolor{preprocessor}{}\textcolor{keywordtype}{\ \ \ \ \ \ \ \ real}(\doxymbox{\hyperlink{namespacenum__vars_a03802aa2bd86439d7a9370836fabf3f2}{dp}}),\ \textcolor{keywordtype}{allocatable}\ ::\ b\_v\_c\_h(:,:),\ b\_v\_s\_h(:,:)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{!\ Coeff.\ of\ magnitude\ of\ B\ (HM)}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00055}00055\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00056}00056\ \textcolor{preprocessor}{}\ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00057}00057\ \ \ \ \ \ \ \ \ \textcolor{comment}{!\ initialize\ ierr}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00058}00058\ \ \ \ \ \ \ \ \ ierr\ =\ 0}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00059}00059\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00060}00060\ \ \ \ \ \ \ \ \ \textcolor{keyword}{call\ }\doxymbox{\hyperlink{namespacemessages_aa4a8d01563e92558e8a0875b075ec54c}{writo}}(\textcolor{stringliteral}{'Reading\ data\ from\ VMEC\ output\ "{}'}\ \&}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00061}00061\ \ \ \ \ \ \ \ \ \ \ \ \ \&//\ trim(\doxymbox{\hyperlink{namespacenum__vars_a3cc0fc4b1538f7203be1604cb4f7c9bc}{eq\_name}})\ //\ \textcolor{stringliteral}{'"{}'})}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00062}00062\ \ \ \ \ \ \ \ \ \textcolor{keyword}{call\ }\doxymbox{\hyperlink{namespacemessages_a6e6bfb084063e4cc91ee86e542043302}{lvl\_ud}}(1)}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00063}00063\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00064}00064\ \ \ \ \ \ \ \ \ \textcolor{comment}{!\ read\ VMEC\ output\ using\ LIBSTELL}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00065}00065\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (scan(\doxymbox{\hyperlink{namespacenum__vars_a3cc0fc4b1538f7203be1604cb4f7c9bc}{eq\_name}},\ \textcolor{stringliteral}{"{}."{}})\ .ne.\ scan(\doxymbox{\hyperlink{namespacenum__vars_a3cc0fc4b1538f7203be1604cb4f7c9bc}{eq\_name}},\ \textcolor{stringliteral}{"{}."{}},\ .true.))\ \&}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00066}00066\ \ \ \ \ \ \ \ \ \ \ \ \ \&\textcolor{keyword}{call\ }\doxymbox{\hyperlink{namespacemessages_aa4a8d01563e92558e8a0875b075ec54c}{writo}}(\textcolor{stringliteral}{'There\ seems\ to\ be\ a\ dot\ "{}."{}\ \ in\ "{}'}//trim(\doxymbox{\hyperlink{namespacenum__vars_a3cc0fc4b1538f7203be1604cb4f7c9bc}{eq\_name}})//\&}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00067}00067\ \ \ \ \ \ \ \ \ \ \ \ \ \&\textcolor{stringliteral}{'"{}.\ This\ can\ create\ problems.'},\ alert=.true.)}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00068}00068\ \ \ \ \ \ \ \ \ \textcolor{keyword}{call\ }read\_wout\_file(\doxymbox{\hyperlink{namespacenum__vars_a3cc0fc4b1538f7203be1604cb4f7c9bc}{eq\_name}},ierr)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{!\ read\ the\ VMEC\ file}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00069}00069\ \ \ \ \ \ \ \ \ chckerr(\textcolor{stringliteral}{'Failed\ to\ read\ the\ VMEC\ file'})}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00070}00070\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00071}00071\ \ \ \ \ \ \ \ \ \textcolor{comment}{!\ set\ some\ variables}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00072}00072\ \ \ \ \ \ \ \ \ n\_r\_in\ =\ n\_r\_vmec}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00073}00073\ \ \ \ \ \ \ \ \ \textcolor{keyword}{allocate}(\doxymbox{\hyperlink{namespacevmec__vars_ac246a5937702b1ac4c7f9bd92d286766}{flux\_t\_v}}(n\_r\_in,0:\doxymbox{\hyperlink{namespacenum__vars_a78f5aeea9d9c2f41e388bfcef9021e64}{max\_deriv}}+1))}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00074}00074\ \ \ \ \ \ \ \ \ \textcolor{keyword}{allocate}(\doxymbox{\hyperlink{namespacevmec__vars_aeac5e1262f419b7ae674586f576dc928}{flux\_p\_v}}(n\_r\_in,0:\doxymbox{\hyperlink{namespacenum__vars_a78f5aeea9d9c2f41e388bfcef9021e64}{max\_deriv}}+1))}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00075}00075\ \ \ \ \ \ \ \ \ \textcolor{keyword}{allocate}(\doxymbox{\hyperlink{namespacevmec__vars_a676475bc7e07d96fc91c2773c8d2c84a}{rot\_t\_v}}(n\_r\_in,0:\doxymbox{\hyperlink{namespacenum__vars_a78f5aeea9d9c2f41e388bfcef9021e64}{max\_deriv}}+1))}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00076}00076\ \ \ \ \ \ \ \ \ \textcolor{keyword}{allocate}(\doxymbox{\hyperlink{namespacevmec__vars_a08f3862b0bb940623a416a056f03b092}{q\_saf\_v}}(n\_r\_in,0:\doxymbox{\hyperlink{namespacenum__vars_a78f5aeea9d9c2f41e388bfcef9021e64}{max\_deriv}}+1))}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00077}00077\ \ \ \ \ \ \ \ \ \textcolor{keyword}{allocate}(\doxymbox{\hyperlink{namespacevmec__vars_a958baf9fece8a4a001b6d8d767b48179}{pres\_v}}(n\_r\_in,0:\doxymbox{\hyperlink{namespacenum__vars_a78f5aeea9d9c2f41e388bfcef9021e64}{max\_deriv}}+1))}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00078}00078\ \ \ \ \ \ \ \ \ use\_pol\_flux\_v\ =\ lrfp}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00079}00079\ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{namespacevmec__vars_ac246a5937702b1ac4c7f9bd92d286766}{flux\_t\_v}}(:,0)\ =\ phi}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00080}00080\ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{namespacevmec__vars_ac246a5937702b1ac4c7f9bd92d286766}{flux\_t\_v}}(:,1)\ =\ phipf}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00081}00081\ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{namespacevmec__vars_aeac5e1262f419b7ae674586f576dc928}{flux\_p\_v}}(:,1)\ =\ iotaf*phipf}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00082}00082\ \ \ \ \ \ \ \ \ ierr\ =\ \doxymbox{\hyperlink{interfacenum__utilities_1_1calc__int}{calc\_int}}(\doxymbox{\hyperlink{namespacevmec__vars_aeac5e1262f419b7ae674586f576dc928}{flux\_p\_v}}(:,1),1.0\_dp/(n\_r\_in-\/1.0\_dp),\doxymbox{\hyperlink{namespacevmec__vars_aeac5e1262f419b7ae674586f576dc928}{flux\_p\_v}}(:,0))}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00083}00083\ \ \ \ \ \ \ \ \ chckerr(\textcolor{stringliteral}{''})}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00084}00084\ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{namespacevmec__vars_a958baf9fece8a4a001b6d8d767b48179}{pres\_v}}(:,0)\ =\ presf}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00085}00085\ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{namespacevmec__vars_a676475bc7e07d96fc91c2773c8d2c84a}{rot\_t\_v}}(:,0)\ =\ iotaf}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00086}00086\ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{namespacevmec__vars_a08f3862b0bb940623a416a056f03b092}{q\_saf\_v}}(:,0)\ =\ 1.\_dp/iotaf}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00087}00087\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (use\_pol\_flux\_v)\ \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00088}00088\ \ \ \ \ \ \ \ \ \ \ \ \ flux\_name\ =\ \textcolor{stringliteral}{'poloidal'}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00089}00089\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00090}00090\ \ \ \ \ \ \ \ \ \ \ \ \ flux\_name\ =\ \textcolor{stringliteral}{'toroidal'}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00091}00091\ \textcolor{keywordflow}{\ \ \ \ \ \ \ \ end\ if}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00092}00092\ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{namespacevmec__vars_a71e1a738f0e423fe6c284f8ea636008e}{b\_0\_v}}\ =\ sum(1.5*bmnc(:,2)-\/0.5\_dp*bmnc(:,3))\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{!\ convert\ to\ full\ mesh}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00093}00093\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00094}00094\ \ \ \ \ \ \ \ \ \textcolor{keyword}{call\ }\doxymbox{\hyperlink{namespacemessages_aa4a8d01563e92558e8a0875b075ec54c}{writo}}(\textcolor{stringliteral}{'VMEC\ version\ is\ '}\ //\ trim(\doxymbox{\hyperlink{namespacestr__utilities_a92ac6c0af1979df094de1caddd28ade0}{r2str}}(vmec\_version)))}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00095}00095\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (is\_freeb\_v)\ \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00096}00096\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{call\ }\doxymbox{\hyperlink{namespacemessages_aa4a8d01563e92558e8a0875b075ec54c}{writo}}(\textcolor{stringliteral}{'Free\ boundary\ VMEC'})}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00097}00097\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00098}00098\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{call\ }\doxymbox{\hyperlink{namespacemessages_aa4a8d01563e92558e8a0875b075ec54c}{writo}}(\textcolor{stringliteral}{'Fixed\ boundary\ VMEC'})}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00099}00099\ \textcolor{keywordflow}{\ \ \ \ \ \ \ \ end\ if}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00100}00100\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (is\_asym\_v)\ \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00101}00101\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{call\ }\doxymbox{\hyperlink{namespacemessages_aa4a8d01563e92558e8a0875b075ec54c}{writo}}(\textcolor{stringliteral}{'No\ stellarator\ symmetry'})}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00102}00102\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00103}00103\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{call\ }\doxymbox{\hyperlink{namespacemessages_aa4a8d01563e92558e8a0875b075ec54c}{writo}}(\textcolor{stringliteral}{'Stellarator\ symmetry'})}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00104}00104\ \textcolor{keywordflow}{\ \ \ \ \ \ \ \ end\ if}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00105}00105\ \ \ \ \ \ \ \ \ \textcolor{keyword}{call\ }\doxymbox{\hyperlink{namespacemessages_aa4a8d01563e92558e8a0875b075ec54c}{writo}}(\textcolor{stringliteral}{'VMEC\ has\ '}//trim(\doxymbox{\hyperlink{namespacestr__utilities_a0b97e51770725a3e98ed393d26681414}{i2str}}(mpol\_v))//\textcolor{stringliteral}{'\ poloidal\ and\ '}\&}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00106}00106\ \ \ \ \ \ \ \ \ \ \ \ \ \&//trim(\doxymbox{\hyperlink{namespacestr__utilities_a0b97e51770725a3e98ed393d26681414}{i2str}}(ntor\_v))//\textcolor{stringliteral}{'\ toroidal\ modes,'})}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00107}00107\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ntor\_v.gt.0)\ \textcolor{keyword}{call\ }\doxymbox{\hyperlink{namespacemessages_aa4a8d01563e92558e8a0875b075ec54c}{writo}}(\textcolor{stringliteral}{'(basic\ toroidal\ field\ period\ NFP\ =\ '}//\&}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00108}00108\ \ \ \ \ \ \ \ \ \ \ \ \ \&trim(\doxymbox{\hyperlink{namespacestr__utilities_a0b97e51770725a3e98ed393d26681414}{i2str}}(nfp\_v))//\textcolor{stringliteral}{')'})}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00109}00109\ \ \ \ \ \ \ \ \ \textcolor{keyword}{call\ }\doxymbox{\hyperlink{namespacemessages_aa4a8d01563e92558e8a0875b075ec54c}{writo}}(\textcolor{stringliteral}{'defined\ on\ '}//trim(\doxymbox{\hyperlink{namespacestr__utilities_a0b97e51770725a3e98ed393d26681414}{i2str}}(n\_r\_in))//\textcolor{stringliteral}{'\ '}//flux\_name//\&}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00110}00110\ \ \ \ \ \ \ \ \ \ \ \ \ \&\textcolor{stringliteral}{'\ flux\ surfaces'})}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00111}00111\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00112}00112\ \ \ \ \ \ \ \ \ \textcolor{keyword}{call\ }\doxymbox{\hyperlink{namespacemessages_aa4a8d01563e92558e8a0875b075ec54c}{writo}}(\textcolor{stringliteral}{'Running\ tests'})}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00113}00113\ \ \ \ \ \ \ \ \ \textcolor{keyword}{call\ }\doxymbox{\hyperlink{namespacemessages_a6e6bfb084063e4cc91ee86e542043302}{lvl\_ud}}(1)}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00114}00114\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (mnmax\_v.ne.((ntor\_v+1)+(2*ntor\_v+1)*(mpol\_v-\/1)))\ \textcolor{keywordflow}{then}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{!\ for\ mpol\_V\ =\ 0,\ only\ ntor\_V+1\ values\ needed}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00115}00115\ \ \ \ \ \ \ \ \ \ \ \ \ err\_msg\ =\ \textcolor{stringliteral}{'Inconsistency\ in\ ntor\_V,\ mpol\_V\ and\ mnmax\_V'}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00116}00116\ \ \ \ \ \ \ \ \ \ \ \ \ ierr\ =\ 1}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00117}00117\ \ \ \ \ \ \ \ \ \ \ \ \ chckerr(err\_msg)}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00118}00118\ \textcolor{keywordflow}{\ \ \ \ \ \ \ \ end\ if}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00119}00119\ \ \ \ \ \ \ \ \ \textcolor{keyword}{call\ }\doxymbox{\hyperlink{namespacemessages_a6e6bfb084063e4cc91ee86e542043302}{lvl\_ud}}(-\/1)}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00120}00120\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00121}00121\ \ \ \ \ \ \ \ \ \textcolor{keyword}{call\ }\doxymbox{\hyperlink{namespacemessages_aa4a8d01563e92558e8a0875b075ec54c}{writo}}(\textcolor{stringliteral}{'Updating\ variables'})}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00122}00122\ \ \ \ \ \ \ \ \ \textcolor{keyword}{allocate}(\doxymbox{\hyperlink{namespacevmec__vars_a4b9a64bc60d45f2b10e03f624ade3e82}{mn\_v}}(mnmax\_v,2))}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00123}00123\ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{namespacevmec__vars_a4b9a64bc60d45f2b10e03f624ade3e82}{mn\_v}}(:,1)\ =\ nint(xm(1:mnmax\_v))}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00124}00124\ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{namespacevmec__vars_a4b9a64bc60d45f2b10e03f624ade3e82}{mn\_v}}(:,2)\ =\ nint(xn(1:mnmax\_v))}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00125}00125\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00126}00126\ \ \ \ \ \ \ \ \ \textcolor{keyword}{call\ }\doxymbox{\hyperlink{namespacemessages_a6e6bfb084063e4cc91ee86e542043302}{lvl\_ud}}(-\/1)}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00127}00127\ \ \ \ \ \ \ \ \ \textcolor{keyword}{call\ }\doxymbox{\hyperlink{namespacemessages_aa4a8d01563e92558e8a0875b075ec54c}{writo}}(\textcolor{stringliteral}{'Data\ from\ VMEC\ output\ successfully\ read'})}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00128}00128\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00129}00129\ \ \ \ \ \ \ \ \ \textcolor{keyword}{call\ }\doxymbox{\hyperlink{namespacemessages_aa4a8d01563e92558e8a0875b075ec54c}{writo}}(\textcolor{stringliteral}{'Saving\ VMEC\ output\ to\ PB3D'})}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00130}00130\ \ \ \ \ \ \ \ \ \textcolor{keyword}{call\ }\doxymbox{\hyperlink{namespacemessages_a6e6bfb084063e4cc91ee86e542043302}{lvl\_ud}}(1)}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00131}00131\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00132}00132\ \ \ \ \ \ \ \ \ \textcolor{comment}{!\ Allocate\ the\ Fourier\ coefficients}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00133}00133\ \ \ \ \ \ \ \ \ \textcolor{keyword}{allocate}(\doxymbox{\hyperlink{namespacevmec__vars_a8307a4a411dadf5b9be24f8aafac5f39}{r\_v\_c}}(mnmax\_v,n\_r\_in,0:\doxymbox{\hyperlink{namespacenum__vars_a78f5aeea9d9c2f41e388bfcef9021e64}{max\_deriv}}+1))}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00134}00134\ \ \ \ \ \ \ \ \ \textcolor{keyword}{allocate}(\doxymbox{\hyperlink{namespacevmec__vars_ac6cdafd632e37856533c42e8ab34a680}{r\_v\_s}}(mnmax\_v,n\_r\_in,0:\doxymbox{\hyperlink{namespacenum__vars_a78f5aeea9d9c2f41e388bfcef9021e64}{max\_deriv}}+1))}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00135}00135\ \ \ \ \ \ \ \ \ \textcolor{keyword}{allocate}(\doxymbox{\hyperlink{namespacevmec__vars_a66130a0eb0bc39ae0294f008f283efcd}{z\_v\_c}}(mnmax\_v,n\_r\_in,0:\doxymbox{\hyperlink{namespacenum__vars_a78f5aeea9d9c2f41e388bfcef9021e64}{max\_deriv}}+1))}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00136}00136\ \ \ \ \ \ \ \ \ \textcolor{keyword}{allocate}(\doxymbox{\hyperlink{namespacevmec__vars_ac6a5f1ccefd4c0337189c09166558bb1}{z\_v\_s}}(mnmax\_v,n\_r\_in,0:\doxymbox{\hyperlink{namespacenum__vars_a78f5aeea9d9c2f41e388bfcef9021e64}{max\_deriv}}+1))}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00137}00137\ \ \ \ \ \ \ \ \ \textcolor{keyword}{allocate}(\doxymbox{\hyperlink{namespacevmec__vars_acf90dcedfaae39a8a6778fbf75a90a40}{l\_v\_c}}(mnmax\_v,n\_r\_in,0:\doxymbox{\hyperlink{namespacenum__vars_a78f5aeea9d9c2f41e388bfcef9021e64}{max\_deriv}}+1))}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00138}00138\ \ \ \ \ \ \ \ \ \textcolor{keyword}{allocate}(\doxymbox{\hyperlink{namespacevmec__vars_a5d1de7879021fa8c1d8c10bbef01f9c7}{l\_v\_s}}(mnmax\_v,n\_r\_in,0:\doxymbox{\hyperlink{namespacenum__vars_a78f5aeea9d9c2f41e388bfcef9021e64}{max\_deriv}}+1))}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00139}00139\ \ \ \ \ \ \ \ \ \textcolor{keyword}{allocate}(\doxymbox{\hyperlink{namespacevmec__vars_a1cc9293ec589081fb212b88f4e5592f0}{jac\_v\_c}}(mnmax\_v,n\_r\_in,0:\doxymbox{\hyperlink{namespacenum__vars_a78f5aeea9d9c2f41e388bfcef9021e64}{max\_deriv}}))}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00140}00140\ \ \ \ \ \ \ \ \ \textcolor{keyword}{allocate}(\doxymbox{\hyperlink{namespacevmec__vars_a82168b3717cf13d2d8a50f5cfc19fded}{jac\_v\_s}}(mnmax\_v,n\_r\_in,0:\doxymbox{\hyperlink{namespacenum__vars_a78f5aeea9d9c2f41e388bfcef9021e64}{max\_deriv}}))}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00141}00141\ \ \ \ \ \ \ \ \ \textcolor{keyword}{allocate}(l\_c\_h(mnmax\_v,n\_r\_in,0:0))}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00142}00142\ \ \ \ \ \ \ \ \ \textcolor{keyword}{allocate}(l\_s\_h(mnmax\_v,n\_r\_in,0:0))}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00143}00143\ \ \ \ \ \ \ \ \ \textcolor{keyword}{allocate}(jac\_c\_h(mnmax\_v,n\_r\_in,0:0))}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00144}00144\ \ \ \ \ \ \ \ \ \textcolor{keyword}{allocate}(jac\_s\_h(mnmax\_v,n\_r\_in,0:0))}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00145}00145\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00146}00146\ \ \ \ \ \ \ \ \ \textcolor{comment}{!\ factors\ R\_V\_c,s;\ Z\_V\_c,s\ and\ L\_C,s\ and\ HM\ varieties}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00147}00147\ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{namespacevmec__vars_a8307a4a411dadf5b9be24f8aafac5f39}{r\_v\_c}}(:,:,0)\ =\ rmnc(1:mnmax\_v,:)}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00148}00148\ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{namespacevmec__vars_ac6a5f1ccefd4c0337189c09166558bb1}{z\_v\_s}}(:,:,0)\ =\ zmns(1:mnmax\_v,:)}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00149}00149\ \ \ \ \ \ \ \ \ l\_s\_h(:,:,0)\ =\ lmns(1:mnmax\_v,:)}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00150}00150\ \ \ \ \ \ \ \ \ jac\_c\_h(:,:,0)\ =\ gmnc(1:mnmax\_v,:)}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00151}00151\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (is\_asym\_v)\ \textcolor{keywordflow}{then}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{!\ following\ only\ needed\ in\ asymmetric\ situations}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00152}00152\ \ \ \ \ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{namespacevmec__vars_ac6cdafd632e37856533c42e8ab34a680}{r\_v\_s}}(:,:,0)\ =\ rmns(1:mnmax\_v,:)}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00153}00153\ \ \ \ \ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{namespacevmec__vars_a66130a0eb0bc39ae0294f008f283efcd}{z\_v\_c}}(:,:,0)\ =\ zmnc(1:mnmax\_v,:)}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00154}00154\ \ \ \ \ \ \ \ \ \ \ \ \ l\_c\_h(:,:,0)\ =\ lmnc(1:mnmax\_v,:)}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00155}00155\ \ \ \ \ \ \ \ \ \ \ \ \ jac\_s\_h(:,:,0)\ =\ gmns(1:mnmax\_v,:)}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00156}00156\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00157}00157\ \ \ \ \ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{namespacevmec__vars_ac6cdafd632e37856533c42e8ab34a680}{r\_v\_s}}\ =\ 0.\_dp}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00158}00158\ \ \ \ \ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{namespacevmec__vars_a66130a0eb0bc39ae0294f008f283efcd}{z\_v\_c}}\ =\ 0.\_dp}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00159}00159\ \ \ \ \ \ \ \ \ \ \ \ \ l\_c\_h\ =\ 0.\_dp}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00160}00160\ \ \ \ \ \ \ \ \ \ \ \ \ jac\_s\_h\ =\ 0.\_dp}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00161}00161\ \textcolor{keywordflow}{\ \ \ \ \ \ \ \ end\ if}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00162}00162\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00163}00163\ \ \ \ \ \ \ \ \ \textcolor{comment}{!\ calculate\ data\ for\ normal\ derivatives\ \ with\ the\ toroidal\ (or\ poloidal)}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00164}00164\ \ \ \ \ \ \ \ \ \textcolor{comment}{!\ flux,\ normalized\ wrt.\ to\ the\ \ maximum\ flux,\ equidistantly,\ so\ the\ step}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00165}00165\ \ \ \ \ \ \ \ \ \textcolor{comment}{!\ size\ is\ 1/(n\_r\_in-\/1).}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00166}00166\ \ \ \ \ \ \ \ \ \textcolor{keyword}{allocate}(r\_v(n\_r\_in))}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00167}00167\ \ \ \ \ \ \ \ \ r\_v\ =\ [((kd-\/1.\_dp)/(n\_r\_in-\/1),kd=1,n\_r\_in)]}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00168}00168\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00169}00169\ \ \ \ \ \ \ \ \ \textcolor{comment}{!\ up\ to\ order\ 2,\ full\ mesh}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00170}00170\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{do}\ kd\ =\ 1,2}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00171}00171\ \ \ \ \ \ \ \ \ \ \ \ \ ierr\ =\ \doxymbox{\hyperlink{interfacenum__utilities_1_1spline}{spline}}(r\_v,\doxymbox{\hyperlink{namespacevmec__vars_a08f3862b0bb940623a416a056f03b092}{q\_saf\_v}}(:,0),r\_v,\doxymbox{\hyperlink{namespacevmec__vars_a08f3862b0bb940623a416a056f03b092}{q\_saf\_v}}(:,kd),\&}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00172}00172\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&ord=\doxymbox{\hyperlink{namespacenum__vars_a9554337420be2ea367f2a6bc71bb654f}{norm\_disc\_prec\_eq}},deriv=kd)}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00173}00173\ \ \ \ \ \ \ \ \ \ \ \ \ chckerr(\textcolor{stringliteral}{''})}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00174}00174\ \ \ \ \ \ \ \ \ \ \ \ \ ierr\ =\ \doxymbox{\hyperlink{interfacenum__utilities_1_1spline}{spline}}(r\_v,\doxymbox{\hyperlink{namespacevmec__vars_a676475bc7e07d96fc91c2773c8d2c84a}{rot\_t\_v}}(:,0),r\_v,\doxymbox{\hyperlink{namespacevmec__vars_a676475bc7e07d96fc91c2773c8d2c84a}{rot\_t\_v}}(:,kd),\&}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00175}00175\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&ord=\doxymbox{\hyperlink{namespacenum__vars_a9554337420be2ea367f2a6bc71bb654f}{norm\_disc\_prec\_eq}},deriv=kd)}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00176}00176\ \ \ \ \ \ \ \ \ \ \ \ \ chckerr(\textcolor{stringliteral}{''})}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00177}00177\ \ \ \ \ \ \ \ \ \ \ \ \ ierr\ =\ \doxymbox{\hyperlink{interfacenum__utilities_1_1spline}{spline}}(r\_v,\doxymbox{\hyperlink{namespacevmec__vars_a958baf9fece8a4a001b6d8d767b48179}{pres\_v}}(:,0),r\_v,\doxymbox{\hyperlink{namespacevmec__vars_a958baf9fece8a4a001b6d8d767b48179}{pres\_v}}(:,kd),\&}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00178}00178\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&ord=\doxymbox{\hyperlink{namespacenum__vars_a9554337420be2ea367f2a6bc71bb654f}{norm\_disc\_prec\_eq}},deriv=kd)}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00179}00179\ \ \ \ \ \ \ \ \ \ \ \ \ chckerr(\textcolor{stringliteral}{''})}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00180}00180\ \ \ \ \ \ \ \ \ \ \ \ \ ierr\ =\ \doxymbox{\hyperlink{interfacenum__utilities_1_1spline}{spline}}(r\_v,\doxymbox{\hyperlink{namespacevmec__vars_ac246a5937702b1ac4c7f9bd92d286766}{flux\_t\_v}}(:,0),r\_v,\doxymbox{\hyperlink{namespacevmec__vars_ac246a5937702b1ac4c7f9bd92d286766}{flux\_t\_v}}(:,kd),\&}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00181}00181\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&ord=\doxymbox{\hyperlink{namespacenum__vars_a9554337420be2ea367f2a6bc71bb654f}{norm\_disc\_prec\_eq}},deriv=kd)}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00182}00182\ \ \ \ \ \ \ \ \ \ \ \ \ chckerr(\textcolor{stringliteral}{''})}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00183}00183\ \ \ \ \ \ \ \ \ \ \ \ \ ierr\ =\ \doxymbox{\hyperlink{interfacenum__utilities_1_1spline}{spline}}(r\_v,\doxymbox{\hyperlink{namespacevmec__vars_aeac5e1262f419b7ae674586f576dc928}{flux\_p\_v}}(:,0),r\_v,\doxymbox{\hyperlink{namespacevmec__vars_aeac5e1262f419b7ae674586f576dc928}{flux\_p\_v}}(:,kd),\&}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00184}00184\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&ord=\doxymbox{\hyperlink{namespacenum__vars_a9554337420be2ea367f2a6bc71bb654f}{norm\_disc\_prec\_eq}},deriv=kd)}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00185}00185\ \ \ \ \ \ \ \ \ \ \ \ \ chckerr(\textcolor{stringliteral}{''})}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00186}00186\ \textcolor{keywordflow}{\ \ \ \ \ \ \ \ end\ do}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00187}00187\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00188}00188\ \ \ \ \ \ \ \ \ \textcolor{comment}{!\ up\ to\ order\ 2,\ half\ mesh:\ also\ extrapolate}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00189}00189\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{do}\ kd\ =\ 0,2}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00190}00190\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{do}\ id\ =\ 1,mnmax\_v}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00191}00191\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ierr\ =\ \doxymbox{\hyperlink{interfacenum__utilities_1_1spline}{spline}}(-\/0.5\_dp/n\_r\_in+r\_v(2:n\_r\_in),\&}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00192}00192\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&jac\_c\_h(id,2:n\_r\_in,0),r\_v,\doxymbox{\hyperlink{namespacevmec__vars_a1cc9293ec589081fb212b88f4e5592f0}{jac\_v\_c}}(id,:,kd),\&}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00193}00193\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&ord=\doxymbox{\hyperlink{namespacenum__vars_a9554337420be2ea367f2a6bc71bb654f}{norm\_disc\_prec\_eq}},deriv=kd,extrap=.true.)}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00194}00194\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ chckerr(\textcolor{stringliteral}{''})}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00195}00195\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (is\_asym\_v)\ \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00196}00196\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ierr\ =\ \doxymbox{\hyperlink{interfacenum__utilities_1_1spline}{spline}}(-\/0.5\_dp/n\_r\_in+r\_v(2:n\_r\_in),\&}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00197}00197\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&jac\_s\_h(id,2:n\_r\_in,0),r\_v,\doxymbox{\hyperlink{namespacevmec__vars_a82168b3717cf13d2d8a50f5cfc19fded}{jac\_v\_s}}(id,:,kd),\&}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00198}00198\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&ord=\doxymbox{\hyperlink{namespacenum__vars_a9554337420be2ea367f2a6bc71bb654f}{norm\_disc\_prec\_eq}},deriv=kd,extrap=.true.)}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00199}00199\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ chckerr(\textcolor{stringliteral}{''})}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00200}00200\ \textcolor{keywordflow}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ end\ if}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00201}00201\ \textcolor{keywordflow}{\ \ \ \ \ \ \ \ \ \ \ \ end\ do}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00202}00202\ \textcolor{keywordflow}{\ \ \ \ \ \ \ \ end\ do}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00203}00203\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00204}00204\ \ \ \ \ \ \ \ \ \textcolor{comment}{!\ up\ to\ order\ 2,\ full\ mesh}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00205}00205\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{do}\ kd\ =\ 1,3}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00206}00206\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{do}\ id\ =\ 1,mnmax\_v}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00207}00207\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{!\ full\ mesh}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00208}00208\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ierr\ =\ \doxymbox{\hyperlink{interfacenum__utilities_1_1spline}{spline}}(r\_v,\doxymbox{\hyperlink{namespacevmec__vars_a8307a4a411dadf5b9be24f8aafac5f39}{r\_v\_c}}(id,:,0),r\_v,\doxymbox{\hyperlink{namespacevmec__vars_a8307a4a411dadf5b9be24f8aafac5f39}{r\_v\_c}}(id,:,kd),\&}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00209}00209\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&ord=\doxymbox{\hyperlink{namespacenum__vars_a9554337420be2ea367f2a6bc71bb654f}{norm\_disc\_prec\_eq}},deriv=kd)}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00210}00210\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ chckerr(\textcolor{stringliteral}{''})}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00211}00211\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ierr\ =\ \doxymbox{\hyperlink{interfacenum__utilities_1_1spline}{spline}}(r\_v,\doxymbox{\hyperlink{namespacevmec__vars_ac6a5f1ccefd4c0337189c09166558bb1}{z\_v\_s}}(id,:,0),r\_v,\doxymbox{\hyperlink{namespacevmec__vars_ac6a5f1ccefd4c0337189c09166558bb1}{z\_v\_s}}(id,:,kd),\&}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00212}00212\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&ord=\doxymbox{\hyperlink{namespacenum__vars_a9554337420be2ea367f2a6bc71bb654f}{norm\_disc\_prec\_eq}},deriv=kd)}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00213}00213\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ chckerr(\textcolor{stringliteral}{''})}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00214}00214\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (is\_asym\_v)\ \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00215}00215\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ierr\ =\ \doxymbox{\hyperlink{interfacenum__utilities_1_1spline}{spline}}(r\_v,\doxymbox{\hyperlink{namespacevmec__vars_ac6cdafd632e37856533c42e8ab34a680}{r\_v\_s}}(id,:,0),r\_v,\doxymbox{\hyperlink{namespacevmec__vars_ac6cdafd632e37856533c42e8ab34a680}{r\_v\_s}}(id,:,kd),\&}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00216}00216\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&ord=\doxymbox{\hyperlink{namespacenum__vars_a9554337420be2ea367f2a6bc71bb654f}{norm\_disc\_prec\_eq}},deriv=kd)}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00217}00217\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ chckerr(\textcolor{stringliteral}{''})}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00218}00218\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ierr\ =\ \doxymbox{\hyperlink{interfacenum__utilities_1_1spline}{spline}}(r\_v,\doxymbox{\hyperlink{namespacevmec__vars_a66130a0eb0bc39ae0294f008f283efcd}{z\_v\_c}}(id,:,0),r\_v,\doxymbox{\hyperlink{namespacevmec__vars_a66130a0eb0bc39ae0294f008f283efcd}{z\_v\_c}}(id,:,kd),\&}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00219}00219\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&ord=\doxymbox{\hyperlink{namespacenum__vars_a9554337420be2ea367f2a6bc71bb654f}{norm\_disc\_prec\_eq}},deriv=kd)}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00220}00220\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ chckerr(\textcolor{stringliteral}{''})}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00221}00221\ \textcolor{keywordflow}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ end\ if}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00222}00222\ \textcolor{keywordflow}{\ \ \ \ \ \ \ \ \ \ \ \ end\ do}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00223}00223\ \textcolor{keywordflow}{\ \ \ \ \ \ \ \ end\ do}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00224}00224\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00225}00225\ \ \ \ \ \ \ \ \ \textcolor{comment}{!\ up\ to\ order\ 2,\ half\ mesh:\ also\ extrapolate}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00226}00226\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{do}\ kd\ =\ 0,3}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00227}00227\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{do}\ id\ =\ 1,mnmax\_v}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00228}00228\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ierr\ =\ \doxymbox{\hyperlink{interfacenum__utilities_1_1spline}{spline}}(-\/0.5\_dp/n\_r\_in+r\_v(2:n\_r\_in),\&}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00229}00229\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&l\_s\_h(id,2:n\_r\_in,0),r\_v,\doxymbox{\hyperlink{namespacevmec__vars_a5d1de7879021fa8c1d8c10bbef01f9c7}{l\_v\_s}}(id,:,kd),\&}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00230}00230\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&ord=\doxymbox{\hyperlink{namespacenum__vars_a9554337420be2ea367f2a6bc71bb654f}{norm\_disc\_prec\_eq}},deriv=kd,extrap=.true.)}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00231}00231\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ chckerr(\textcolor{stringliteral}{''})}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00232}00232\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (is\_asym\_v)\ \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00233}00233\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ierr\ =\ \doxymbox{\hyperlink{interfacenum__utilities_1_1spline}{spline}}(-\/0.5\_dp/n\_r\_in+r\_v(2:n\_r\_in),\&}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00234}00234\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&l\_c\_h(id,2:n\_r\_in,0),r\_v,\doxymbox{\hyperlink{namespacevmec__vars_acf90dcedfaae39a8a6778fbf75a90a40}{l\_v\_c}}(id,:,kd),\&}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00235}00235\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&ord=\doxymbox{\hyperlink{namespacenum__vars_a9554337420be2ea367f2a6bc71bb654f}{norm\_disc\_prec\_eq}},deriv=kd,extrap=.true.)}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00236}00236\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ chckerr(\textcolor{stringliteral}{''})}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00237}00237\ \textcolor{keywordflow}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ end\ if}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00238}00238\ \textcolor{keywordflow}{\ \ \ \ \ \ \ \ \ \ \ \ end\ do}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00239}00239\ \textcolor{keywordflow}{\ \ \ \ \ \ \ \ end\ do}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00240}00240\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00241}00241\ \ \ \ \ \ \ \ \ \textcolor{comment}{!\ These\ are\ only\ necessary\ if\ the\ compiler\ searches\ for\ uninitialized}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00242}00242\ \ \ \ \ \ \ \ \ \textcolor{comment}{!\ memory}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00243}00243\ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{namespacevmec__vars_ac246a5937702b1ac4c7f9bd92d286766}{flux\_t\_v}}(:,3:)\ =\ 0.\_dp}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00244}00244\ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{namespacevmec__vars_aeac5e1262f419b7ae674586f576dc928}{flux\_p\_v}}(:,3:)\ =\ 0.\_dp}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00245}00245\ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{namespacevmec__vars_a08f3862b0bb940623a416a056f03b092}{q\_saf\_v}}(:,3:)\ =\ 0.\_dp}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00246}00246\ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{namespacevmec__vars_a676475bc7e07d96fc91c2773c8d2c84a}{rot\_t\_v}}(:,3:)\ =\ 0.\_dp}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00247}00247\ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{namespacevmec__vars_a958baf9fece8a4a001b6d8d767b48179}{pres\_v}}(:,3:)\ =\ 0.\_dp}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00248}00248\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00249}00249\ \ \ \ \ \ \ \ \ \textcolor{comment}{!\ allocate\ helper\ variables}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00250}00250\ \ \ \ \ \ \ \ \ \textcolor{keyword}{allocate}(b\_v\_sub\_c\_m(mnmax\_v,n\_r\_in,3));\ b\_v\_sub\_c\_m\ =\ 0.\_dp}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00251}00251\ \ \ \ \ \ \ \ \ \textcolor{keyword}{allocate}(b\_v\_sub\_s\_m(mnmax\_v,n\_r\_in,3));\ b\_v\_sub\_s\_m\ =\ 0.\_dp}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00252}00252\ \textcolor{preprocessor}{\#if\ ldebug}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00253}00253\ \textcolor{preprocessor}{}\ \ \ \ \ \ \ \ \textcolor{keyword}{allocate}(b\_v\_c\_h(mnmax\_v,n\_r\_in));\ b\_v\_c\_h\ =\ 0.\_dp}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00254}00254\ \ \ \ \ \ \ \ \ \textcolor{keyword}{allocate}(b\_v\_s\_h(mnmax\_v,n\_r\_in));\ b\_v\_s\_h\ =\ 0.\_dp}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00255}00255\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00256}00256\ \textcolor{preprocessor}{}\ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00257}00257\ \ \ \ \ \ \ \ \ \textcolor{comment}{!\ store\ in\ helper\ variables}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00258}00258\ \ \ \ \ \ \ \ \ b\_v\_sub\_s\_m(:,:,1)\ =\ bsubsmns(1:mnmax\_v,:)}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00259}00259\ \ \ \ \ \ \ \ \ b\_v\_sub\_c\_m(:,:,2)\ =\ bsubumnc(1:mnmax\_v,:)}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00260}00260\ \ \ \ \ \ \ \ \ b\_v\_sub\_c\_m(:,:,3)\ =\ bsubvmnc(1:mnmax\_v,:)}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00261}00261\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (is\_asym\_v)\ \textcolor{keywordflow}{then}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{!\ following\ only\ needed\ in\ asymmetric\ situations}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00262}00262\ \ \ \ \ \ \ \ \ \ \ \ \ b\_v\_sub\_c\_m(:,:,1)\ =\ bsubsmnc(1:mnmax\_v,:)}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00263}00263\ \ \ \ \ \ \ \ \ \ \ \ \ b\_v\_sub\_s\_m(:,:,2)\ =\ bsubumns(1:mnmax\_v,:)}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00264}00264\ \ \ \ \ \ \ \ \ \ \ \ \ b\_v\_sub\_s\_m(:,:,3)\ =\ bsubvmns(1:mnmax\_v,:)}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00265}00265\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00266}00266\ \ \ \ \ \ \ \ \ \ \ \ \ b\_v\_sub\_c\_m(:,:,1)\ =\ 0.\_dp}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00267}00267\ \ \ \ \ \ \ \ \ \ \ \ \ b\_v\_sub\_s\_m(:,:,2)\ =\ 0.\_dp}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00268}00268\ \ \ \ \ \ \ \ \ \ \ \ \ b\_v\_sub\_s\_m(:,:,3)\ =\ 0.\_dp}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00269}00269\ \textcolor{keywordflow}{\ \ \ \ \ \ \ \ end\ if}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00270}00270\ \textcolor{preprocessor}{\#if\ ldebug}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00271}00271\ \textcolor{preprocessor}{}\ \ \ \ \ \ \ \ b\_v\_c\_h(:,:)\ =\ bmnc(1:mnmax\_v,:)}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00272}00272\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (is\_asym\_v)\ \textcolor{keywordflow}{then}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{!\ following\ only\ needed\ in\ asymmetric\ situations}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00273}00273\ \ \ \ \ \ \ \ \ \ \ \ \ b\_v\_s\_h(:,:)\ =\ bmns(1:mnmax\_v,:)}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00274}00274\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00275}00275\ \ \ \ \ \ \ \ \ \ \ \ \ b\_v\_s\_h(:,:)\ =\ 0.\_dp}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00276}00276\ \textcolor{keywordflow}{\ \ \ \ \ \ \ \ end\ if}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00277}00277\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00278}00278\ \textcolor{preprocessor}{}\ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00279}00279\ \ \ \ \ \ \ \ \ \textcolor{comment}{!\ allocate\ FM\ variables}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00280}00280\ \ \ \ \ \ \ \ \ \textcolor{keyword}{allocate}(\doxymbox{\hyperlink{namespacevmec__vars_a2e07a2b5bd2384e16e8af8ca4f5b50d6}{b\_v\_sub\_c}}(mnmax\_v,n\_r\_in,3))}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00281}00281\ \ \ \ \ \ \ \ \ \textcolor{keyword}{allocate}(\doxymbox{\hyperlink{namespacevmec__vars_aac5e249f0f14cf1e542f881d1777b730}{b\_v\_sub\_s}}(mnmax\_v,n\_r\_in,3))}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00282}00282\ \textcolor{preprocessor}{\#if\ ldebug}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00283}00283\ \textcolor{preprocessor}{}\ \ \ \ \ \ \ \ \textcolor{keyword}{allocate}(\doxymbox{\hyperlink{namespacevmec__vars_ad6833cc726863147b8fed188d3a28f5d}{b\_v\_c}}(mnmax\_v,n\_r\_in))}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00284}00284\ \ \ \ \ \ \ \ \ \textcolor{keyword}{allocate}(\doxymbox{\hyperlink{namespacevmec__vars_ab2aa43fe35401e8f2b7ffb2facad7109}{b\_v\_s}}(mnmax\_v,n\_r\_in))}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00285}00285\ \ \ \ \ \ \ \ \ \textcolor{keyword}{allocate}(\doxymbox{\hyperlink{namespacevmec__vars_aa822a336e5823876fea884b07857389c}{j\_v\_sup\_int}}(n\_r\_in,2))}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00286}00286\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00287}00287\ \textcolor{preprocessor}{}\ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00288}00288\ \ \ \ \ \ \ \ \ \textcolor{comment}{!\ half\ mesh:\ extrapolate}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00289}00289\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{do}\ id\ =\ 1,mnmax\_v}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00290}00290\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{do}\ kd\ =\ 2,3}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00291}00291\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ierr\ =\ \doxymbox{\hyperlink{interfacenum__utilities_1_1spline}{spline}}(-\/0.5\_dp/n\_r\_in+r\_v(2:n\_r\_in),\&}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00292}00292\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&b\_v\_sub\_c\_m(id,2:n\_r\_in,kd),r\_v,\doxymbox{\hyperlink{namespacevmec__vars_a2e07a2b5bd2384e16e8af8ca4f5b50d6}{b\_v\_sub\_c}}(id,:,kd),\&}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00293}00293\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&ord=\doxymbox{\hyperlink{namespacenum__vars_a9554337420be2ea367f2a6bc71bb654f}{norm\_disc\_prec\_eq}},deriv=0,extrap=.true.)}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00294}00294\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ chckerr(\textcolor{stringliteral}{''})}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00295}00295\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ierr\ =\ \doxymbox{\hyperlink{interfacenum__utilities_1_1spline}{spline}}(-\/0.5\_dp/n\_r\_in+r\_v(2:n\_r\_in),\&}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00296}00296\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&b\_v\_sub\_s\_m(id,2:n\_r\_in,kd),r\_v,\doxymbox{\hyperlink{namespacevmec__vars_aac5e249f0f14cf1e542f881d1777b730}{b\_v\_sub\_s}}(id,:,kd),\&}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00297}00297\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&ord=\doxymbox{\hyperlink{namespacenum__vars_a9554337420be2ea367f2a6bc71bb654f}{norm\_disc\_prec\_eq}},deriv=0,extrap=.true.)}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00298}00298\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ chckerr(\textcolor{stringliteral}{''})}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00299}00299\ \textcolor{keywordflow}{\ \ \ \ \ \ \ \ \ \ \ \ end\ do}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00300}00300\ \textcolor{keywordflow}{\ \ \ \ \ \ \ \ end\ do}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00301}00301\ \textcolor{preprocessor}{\#if\ ldebug}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00302}00302\ \textcolor{preprocessor}{}\ \ \ \ \ \ \ \ \textcolor{keywordflow}{do}\ id\ =\ 1,mnmax\_v}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00303}00303\ \ \ \ \ \ \ \ \ \ \ \ \ ierr\ =\ \doxymbox{\hyperlink{interfacenum__utilities_1_1spline}{spline}}(-\/0.5\_dp/n\_r\_in+r\_v(2:n\_r\_in),\&}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00304}00304\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&b\_v\_c\_h(id,2:n\_r\_in),r\_v,\doxymbox{\hyperlink{namespacevmec__vars_ad6833cc726863147b8fed188d3a28f5d}{b\_v\_c}}(id,:),\&}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00305}00305\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&ord=\doxymbox{\hyperlink{namespacenum__vars_a9554337420be2ea367f2a6bc71bb654f}{norm\_disc\_prec\_eq}},deriv=0,extrap=.true.)}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00306}00306\ \ \ \ \ \ \ \ \ \ \ \ \ chckerr(\textcolor{stringliteral}{''})}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00307}00307\ \ \ \ \ \ \ \ \ \ \ \ \ ierr\ =\ \doxymbox{\hyperlink{interfacenum__utilities_1_1spline}{spline}}(-\/0.5\_dp/n\_r\_in+r\_v(2:n\_r\_in),\&}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00308}00308\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&b\_v\_s\_h(id,2:n\_r\_in),r\_v,\doxymbox{\hyperlink{namespacevmec__vars_ab2aa43fe35401e8f2b7ffb2facad7109}{b\_v\_s}}(id,:),\&}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00309}00309\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&ord=\doxymbox{\hyperlink{namespacenum__vars_a9554337420be2ea367f2a6bc71bb654f}{norm\_disc\_prec\_eq}},deriv=0,extrap=.true.)}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00310}00310\ \ \ \ \ \ \ \ \ \ \ \ \ chckerr(\textcolor{stringliteral}{''})}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00311}00311\ \textcolor{keywordflow}{\ \ \ \ \ \ \ \ end\ do}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00312}00312\ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{namespacevmec__vars_aa822a336e5823876fea884b07857389c}{j\_v\_sup\_int}}(:,1)\ =\ jcuru}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00313}00313\ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{namespacevmec__vars_aa822a336e5823876fea884b07857389c}{j\_v\_sup\_int}}(:,2)\ =\ jcurv}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00314}00314\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00315}00315\ \textcolor{preprocessor}{}\ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00316}00316\ \ \ \ \ \ \ \ \ \textcolor{comment}{!\ deallocate\ repacked\ variables}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00317}00317\ \ \ \ \ \ \ \ \ \textcolor{keyword}{call\ }read\_wout\_deallocate()}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00318}00318\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00319}00319\ \ \ \ \ \ \ \ \ \textcolor{keyword}{call\ }\doxymbox{\hyperlink{namespacemessages_a6e6bfb084063e4cc91ee86e542043302}{lvl\_ud}}(-\/1)}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00320}00320\ \ \ \ \ \ \ \ \ \textcolor{keyword}{call\ }\doxymbox{\hyperlink{namespacemessages_aa4a8d01563e92558e8a0875b075ec54c}{writo}}(\textcolor{stringliteral}{'Conversion\ complete'})}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00321}00321\ \ \ \ \ \textcolor{keyword}{end\ function\ }\doxymbox{\hyperlink{namespacevmec__ops_a3df3b64d29e4242be9116a7a04275103}{read\_vmec}}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00322}00322\ \ \ \ \ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00323}00323\ \textcolor{comment}{\ \ \ \ !>\ Normalizes\ VMEC\ input.}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00324}00324\ \textcolor{comment}{\ \ \ \ !!}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00325}00325\ \textcolor{comment}{\ \ \ \ !!\ \(\backslash\)note\ \ The\ \ normal\ \ VMEC\ \ coordinate\ \ runs\ from\ \ 0\ \ to\ \ 1,\ \ whatever\ \ the}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00326}00326\ \textcolor{comment}{\ \ \ \ !!\ normalization.}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00327}\doxymbox{\hyperlink{namespacevmec__ops_a95f04a642fd732a538aef30052a12863}{00327}}\ \ \ \ \ \textcolor{keyword}{subroutine\ }\doxymbox{\hyperlink{namespacevmec__ops_a95f04a642fd732a538aef30052a12863}{normalize\_vmec}}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00328}00328\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{use\ }\doxymbox{\hyperlink{namespaceeq__vars}{eq\_vars}},\ \textcolor{keywordtype}{only}:\ \doxymbox{\hyperlink{namespaceeq__vars_abce8bbe23c333a591a2ee5cef9512de9}{pres\_0}},\ \doxymbox{\hyperlink{namespaceeq__vars_a2bb2594492faa83869c3eaf8cabe521e}{psi\_0}},\ \doxymbox{\hyperlink{namespaceeq__vars_a0c1f124ab3260a0f6937df9189a18184}{r\_0}},\ \doxymbox{\hyperlink{namespaceeq__vars_acdd2464f2282359a818e4159b502e84b}{b\_0}}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00329}00329\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00330}00330\ \ \ \ \ \ \ \ \ \textcolor{comment}{!\ scale\ the\ VMEC\ quantities}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00331}00331\ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{namespacevmec__vars_a958baf9fece8a4a001b6d8d767b48179}{pres\_v}}\ =\ \doxymbox{\hyperlink{namespacevmec__vars_a958baf9fece8a4a001b6d8d767b48179}{pres\_v}}/\doxymbox{\hyperlink{namespaceeq__vars_abce8bbe23c333a591a2ee5cef9512de9}{pres\_0}}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00332}00332\ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{namespacevmec__vars_ac246a5937702b1ac4c7f9bd92d286766}{flux\_t\_v}}\ =\ \doxymbox{\hyperlink{namespacevmec__vars_ac246a5937702b1ac4c7f9bd92d286766}{flux\_t\_v}}/\doxymbox{\hyperlink{namespaceeq__vars_a2bb2594492faa83869c3eaf8cabe521e}{psi\_0}}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00333}00333\ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{namespacevmec__vars_aeac5e1262f419b7ae674586f576dc928}{flux\_p\_v}}\ =\ \doxymbox{\hyperlink{namespacevmec__vars_aeac5e1262f419b7ae674586f576dc928}{flux\_p\_v}}/\doxymbox{\hyperlink{namespaceeq__vars_a2bb2594492faa83869c3eaf8cabe521e}{psi\_0}}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00334}00334\ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{namespacevmec__vars_a8307a4a411dadf5b9be24f8aafac5f39}{r\_v\_c}}\ =\ \doxymbox{\hyperlink{namespacevmec__vars_a8307a4a411dadf5b9be24f8aafac5f39}{r\_v\_c}}/\doxymbox{\hyperlink{namespaceeq__vars_a0c1f124ab3260a0f6937df9189a18184}{r\_0}}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00335}00335\ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{namespacevmec__vars_ac6cdafd632e37856533c42e8ab34a680}{r\_v\_s}}\ =\ \doxymbox{\hyperlink{namespacevmec__vars_ac6cdafd632e37856533c42e8ab34a680}{r\_v\_s}}/\doxymbox{\hyperlink{namespaceeq__vars_a0c1f124ab3260a0f6937df9189a18184}{r\_0}}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00336}00336\ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{namespacevmec__vars_a66130a0eb0bc39ae0294f008f283efcd}{z\_v\_c}}\ =\ \doxymbox{\hyperlink{namespacevmec__vars_a66130a0eb0bc39ae0294f008f283efcd}{z\_v\_c}}/\doxymbox{\hyperlink{namespaceeq__vars_a0c1f124ab3260a0f6937df9189a18184}{r\_0}}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00337}00337\ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{namespacevmec__vars_ac6a5f1ccefd4c0337189c09166558bb1}{z\_v\_s}}\ =\ \doxymbox{\hyperlink{namespacevmec__vars_ac6a5f1ccefd4c0337189c09166558bb1}{z\_v\_s}}/\doxymbox{\hyperlink{namespaceeq__vars_a0c1f124ab3260a0f6937df9189a18184}{r\_0}}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00338}00338\ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{namespacevmec__vars_acf90dcedfaae39a8a6778fbf75a90a40}{l\_v\_c}}\ =\ \doxymbox{\hyperlink{namespacevmec__vars_acf90dcedfaae39a8a6778fbf75a90a40}{l\_v\_c}}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00339}00339\ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{namespacevmec__vars_a5d1de7879021fa8c1d8c10bbef01f9c7}{l\_v\_s}}\ =\ \doxymbox{\hyperlink{namespacevmec__vars_a5d1de7879021fa8c1d8c10bbef01f9c7}{l\_v\_s}}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00340}00340\ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{namespacevmec__vars_a1cc9293ec589081fb212b88f4e5592f0}{jac\_v\_c}}\ =\ \doxymbox{\hyperlink{namespacevmec__vars_a1cc9293ec589081fb212b88f4e5592f0}{jac\_v\_c}}/(\doxymbox{\hyperlink{namespaceeq__vars_a0c1f124ab3260a0f6937df9189a18184}{r\_0}}**3)}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00341}00341\ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{namespacevmec__vars_a82168b3717cf13d2d8a50f5cfc19fded}{jac\_v\_s}}\ =\ \doxymbox{\hyperlink{namespacevmec__vars_a82168b3717cf13d2d8a50f5cfc19fded}{jac\_v\_s}}/(\doxymbox{\hyperlink{namespaceeq__vars_a0c1f124ab3260a0f6937df9189a18184}{r\_0}}**3)}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00342}00342\ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{namespacevmec__vars_aac5e249f0f14cf1e542f881d1777b730}{b\_v\_sub\_s}}\ =\ \doxymbox{\hyperlink{namespacevmec__vars_aac5e249f0f14cf1e542f881d1777b730}{b\_v\_sub\_s}}/(\doxymbox{\hyperlink{namespaceeq__vars_a0c1f124ab3260a0f6937df9189a18184}{r\_0}}*\doxymbox{\hyperlink{namespaceeq__vars_acdd2464f2282359a818e4159b502e84b}{b\_0}})}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00343}00343\ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{namespacevmec__vars_a2e07a2b5bd2384e16e8af8ca4f5b50d6}{b\_v\_sub\_c}}\ =\ \doxymbox{\hyperlink{namespacevmec__vars_a2e07a2b5bd2384e16e8af8ca4f5b50d6}{b\_v\_sub\_c}}/(\doxymbox{\hyperlink{namespaceeq__vars_a0c1f124ab3260a0f6937df9189a18184}{r\_0}}*\doxymbox{\hyperlink{namespaceeq__vars_acdd2464f2282359a818e4159b502e84b}{b\_0}})}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00344}00344\ \textcolor{preprocessor}{\#if\ ldebug}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00345}00345\ \textcolor{preprocessor}{}\ \ \ \ \ \ \ \ \doxymbox{\hyperlink{namespacevmec__vars_ad6833cc726863147b8fed188d3a28f5d}{b\_v\_c}}\ =\ \doxymbox{\hyperlink{namespacevmec__vars_ad6833cc726863147b8fed188d3a28f5d}{b\_v\_c}}/\doxymbox{\hyperlink{namespaceeq__vars_acdd2464f2282359a818e4159b502e84b}{b\_0}}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00346}00346\ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{namespacevmec__vars_ab2aa43fe35401e8f2b7ffb2facad7109}{b\_v\_s}}\ =\ \doxymbox{\hyperlink{namespacevmec__vars_ab2aa43fe35401e8f2b7ffb2facad7109}{b\_v\_s}}/\doxymbox{\hyperlink{namespaceeq__vars_acdd2464f2282359a818e4159b502e84b}{b\_0}}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00347}00347\ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{namespacevmec__vars_aa822a336e5823876fea884b07857389c}{j\_v\_sup\_int}}\ =\ \doxymbox{\hyperlink{namespacevmec__vars_aa822a336e5823876fea884b07857389c}{j\_v\_sup\_int}}*\doxymbox{\hyperlink{namespaceeq__vars_a2bb2594492faa83869c3eaf8cabe521e}{psi\_0}}/\doxymbox{\hyperlink{namespaceeq__vars_abce8bbe23c333a591a2ee5cef9512de9}{pres\_0}}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00348}00348\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00349}00349\ \textcolor{preprocessor}{}\ \ \ \ \textcolor{keyword}{end\ subroutine\ }\doxymbox{\hyperlink{namespacevmec__ops_a95f04a642fd732a538aef30052a12863}{normalize\_vmec}}}
\DoxyCodeLine{\Hypertarget{VMEC__ops_8f90_source_l00350}00350\ \textcolor{keyword}{end\ module\ }\doxymbox{\hyperlink{namespacevmec__ops}{vmec\_ops}}}

\end{DoxyCode}
