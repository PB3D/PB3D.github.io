\doxysection{rich\+\_\+vars.\+f90}
\hypertarget{rich__vars_8f90_source}{}\label{rich__vars_8f90_source}\index{/Users/toonweyens/Code/PB3D/Modules/rich\_vars.f90@{/Users/toonweyens/Code/PB3D/Modules/rich\_vars.f90}}
\doxymbox{\hyperlink{rich__vars_8f90}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{rich__vars_8f90_source_l00001}00001\ \textcolor{comment}{!-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/!}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{rich__vars_8f90_source_l00002}00002\ \textcolor{comment}{!>\ Variables\ concerning\ Richardson\ extrapolation.}}
\DoxyCodeLine{\Hypertarget{rich__vars_8f90_source_l00003}00003\ \textcolor{comment}{!-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/!}}
\DoxyCodeLine{\Hypertarget{rich__vars_8f90_source_l00004}\doxymbox{\hyperlink{namespacerich__vars}{00004}}\ \textcolor{keyword}{module}\ \doxymbox{\hyperlink{namespacerich__vars}{rich\_vars}}}
\DoxyCodeLine{\Hypertarget{rich__vars_8f90_source_l00005}00005\ \textcolor{preprocessor}{\#include\ <PB3D\_macros.h>}}
\DoxyCodeLine{\Hypertarget{rich__vars_8f90_source_l00006}00006\ \textcolor{preprocessor}{}\ \ \ \ \textcolor{keywordtype}{use\ }\doxymbox{\hyperlink{namespacestr__utilities}{str\_utilities}}}
\DoxyCodeLine{\Hypertarget{rich__vars_8f90_source_l00007}00007\ \ \ \ \ \textcolor{keywordtype}{use\ }\doxymbox{\hyperlink{namespaceoutput__ops}{output\_ops}}}
\DoxyCodeLine{\Hypertarget{rich__vars_8f90_source_l00008}00008\ \ \ \ \ \textcolor{keywordtype}{use\ }\doxymbox{\hyperlink{namespacemessages}{messages}}}
\DoxyCodeLine{\Hypertarget{rich__vars_8f90_source_l00009}00009\ \ \ \ \ \textcolor{keywordtype}{use\ }\doxymbox{\hyperlink{namespacenum__vars}{num\_vars}},\ \textcolor{keywordtype}{only}:\ \doxymbox{\hyperlink{namespacenum__vars_a03802aa2bd86439d7a9370836fabf3f2}{dp}},\ \doxymbox{\hyperlink{namespacenum__vars_a26f47310576a3414135b3d3fcc079709}{pi}},\ \doxymbox{\hyperlink{namespacenum__vars_a3ff2bb983ee80a6735277d6789e6ce7c}{max\_str\_ln}},\ \doxymbox{\hyperlink{namespacenum__vars_afbd4cb9a4ef9e8a277aecfc41b09aa1d}{max\_it\_rich}},\ \doxymbox{\hyperlink{namespacenum__vars_aa0091a935b9502afef09a87c0f590e9d}{tol\_rich}}}
\DoxyCodeLine{\Hypertarget{rich__vars_8f90_source_l00010}00010\ }
\DoxyCodeLine{\Hypertarget{rich__vars_8f90_source_l00011}00011\ \ \ \ \ \textcolor{keywordtype}{implicit\ none}}
\DoxyCodeLine{\Hypertarget{rich__vars_8f90_source_l00012}00012\ \ \ \ \ \textcolor{keywordtype}{private}}
\DoxyCodeLine{\Hypertarget{rich__vars_8f90_source_l00013}00013\ \ \ \ \ \textcolor{keywordtype}{public}\ \doxymbox{\hyperlink{namespacerich__vars_a4f54d3fc0ac510fc073220794ee4fa37}{rich\_info}},\ \&}
\DoxyCodeLine{\Hypertarget{rich__vars_8f90_source_l00014}00014\ \ \ \ \ \ \ \ \ \&\doxymbox{\hyperlink{namespacerich__vars_a1b7734ba9ce6cc153b22387e638093c0}{rich\_lvl}},\ \doxymbox{\hyperlink{namespacerich__vars_a167fe55b5d9c1a4566729da683466947}{no\_guess}},\ \doxymbox{\hyperlink{namespacerich__vars_aedc7171560db899c515d1610d99582c9}{use\_guess}},\ \doxymbox{\hyperlink{namespacerich__vars_a7a32b8d53450cf925042cd5ddc7e23e6}{n\_par\_x}},\ \doxymbox{\hyperlink{namespacerich__vars_a07841cccca6e6ee59aeb4e0661558eda}{min\_n\_par\_x}},\ \doxymbox{\hyperlink{namespacerich__vars_adf63efd509bbcda4f77fd7e88c766081}{rich\_conv}},\ \&}
\DoxyCodeLine{\Hypertarget{rich__vars_8f90_source_l00015}00015\ \ \ \ \ \ \ \ \ \&\doxymbox{\hyperlink{namespacerich__vars_ae1d3c7deb4c8becd036a63367fca5e20}{sol\_val\_rich}},\ \doxymbox{\hyperlink{namespacerich__vars_a7f584d9b84f3e3e230b45ce4b8e0e9b1}{x\_axis\_rich}},\ \doxymbox{\hyperlink{namespacerich__vars_afac4d06d60829484cfb7d4964964945b}{max\_rel\_err}},\ \doxymbox{\hyperlink{namespacerich__vars_af3df7361e33058bc83fe43a803173d89}{loc\_max\_rel\_err}},\ \&}
\DoxyCodeLine{\Hypertarget{rich__vars_8f90_source_l00016}00016\ \ \ \ \ \ \ \ \ \&\doxymbox{\hyperlink{namespacerich__vars_a94e61b5125377ab3e984334998f5ebae}{req\_min\_n\_par\_x}}}
\DoxyCodeLine{\Hypertarget{rich__vars_8f90_source_l00017}00017\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{rich__vars_8f90_source_l00018}00018\ \ \ \ \ \textcolor{comment}{!\ global\ variables}}
\DoxyCodeLine{\Hypertarget{rich__vars_8f90_source_l00019}\doxymbox{\hyperlink{namespacerich__vars_a1b7734ba9ce6cc153b22387e638093c0}{00019}}\ \ \ \ \ \textcolor{keywordtype}{integer}\ ::\ \doxymbox{\hyperlink{namespacerich__vars_a1b7734ba9ce6cc153b22387e638093c0}{rich\_lvl}}\textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ !<\ current\ level\ of\ Richardson\ extrapolation}}
\DoxyCodeLine{\Hypertarget{rich__vars_8f90_source_l00020}\doxymbox{\hyperlink{namespacerich__vars_a7a32b8d53450cf925042cd5ddc7e23e6}{00020}}\ \ \ \ \ \textcolor{keywordtype}{integer}\ ::\ \doxymbox{\hyperlink{namespacerich__vars_a7a32b8d53450cf925042cd5ddc7e23e6}{n\_par\_x}}\textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ !<\ nr.\ of\ parallel\ points\ in\ field-\/aligned\ grid}}
\DoxyCodeLine{\Hypertarget{rich__vars_8f90_source_l00021}\doxymbox{\hyperlink{namespacerich__vars_a94e61b5125377ab3e984334998f5ebae}{00021}}\ \ \ \ \ \textcolor{keywordtype}{integer},\ \textcolor{keywordtype}{parameter}\ ::\ \doxymbox{\hyperlink{namespacerich__vars_a94e61b5125377ab3e984334998f5ebae}{req\_min\_n\_par\_x}}\ =\ 20\textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ !<\ required\ minimum\ \(\backslash\)c\ n\_par\_X}}
\DoxyCodeLine{\Hypertarget{rich__vars_8f90_source_l00022}\doxymbox{\hyperlink{namespacerich__vars_a07841cccca6e6ee59aeb4e0661558eda}{00022}}\ \ \ \ \ \textcolor{keywordtype}{integer}\ ::\ \doxymbox{\hyperlink{namespacerich__vars_a07841cccca6e6ee59aeb4e0661558eda}{min\_n\_par\_x}}\textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ !<\ min.\ of\ \(\backslash\)c\ n\_par\_X\ (e.g.\ first\ value\ in\ Richardson\ loop)}}
\DoxyCodeLine{\Hypertarget{rich__vars_8f90_source_l00023}\doxymbox{\hyperlink{namespacerich__vars_aedc7171560db899c515d1610d99582c9}{00023}}\ \ \ \ \ \textcolor{keywordtype}{logical}\ ::\ \doxymbox{\hyperlink{namespacerich__vars_aedc7171560db899c515d1610d99582c9}{use\_guess}}\textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ !<\ whether\ a\ guess\ is\ formed\ from\ previous\ level\ of\ Richardson}}
\DoxyCodeLine{\Hypertarget{rich__vars_8f90_source_l00024}\doxymbox{\hyperlink{namespacerich__vars_a167fe55b5d9c1a4566729da683466947}{00024}}\ \ \ \ \ \textcolor{keywordtype}{logical}\ ::\ \doxymbox{\hyperlink{namespacerich__vars_a167fe55b5d9c1a4566729da683466947}{no\_guess}}\textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ !<\ disable\ guessing\ Eigenfunction\ from\ previous\ level\ of\ Richardson}}
\DoxyCodeLine{\Hypertarget{rich__vars_8f90_source_l00025}\doxymbox{\hyperlink{namespacerich__vars_adf63efd509bbcda4f77fd7e88c766081}{00025}}\ \ \ \ \ \textcolor{keywordtype}{logical}\ ::\ \doxymbox{\hyperlink{namespacerich__vars_adf63efd509bbcda4f77fd7e88c766081}{rich\_conv}}\textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ !<\ if\ Richarson\ extrapolation\ has\ converged}}
\DoxyCodeLine{\Hypertarget{rich__vars_8f90_source_l00026}\doxymbox{\hyperlink{namespacerich__vars_ae1d3c7deb4c8becd036a63367fca5e20}{00026}}\ \ \ \ \ \textcolor{keywordtype}{complex(dp)},\ \textcolor{keywordtype}{allocatable}\ ::\ \doxymbox{\hyperlink{namespacerich__vars_ae1d3c7deb4c8becd036a63367fca5e20}{sol\_val\_rich}}(:,:,:)\textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ !<\ Richardson\ array\ of\ eigenvalues}}
\DoxyCodeLine{\Hypertarget{rich__vars_8f90_source_l00027}\doxymbox{\hyperlink{namespacerich__vars_a7f584d9b84f3e3e230b45ce4b8e0e9b1}{00027}}\ \textcolor{keywordtype}{\ \ \ \ real}(\doxymbox{\hyperlink{namespacenum__vars_a03802aa2bd86439d7a9370836fabf3f2}{dp}}),\ \textcolor{keywordtype}{allocatable}\ ::\ \doxymbox{\hyperlink{namespacerich__vars_a7f584d9b84f3e3e230b45ce4b8e0e9b1}{x\_axis\_rich}}(:,:)\textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ !<\ x\ axis\ for\ plot\ of\ Eigenvalues\ with\ Richardson\ level}}
\DoxyCodeLine{\Hypertarget{rich__vars_8f90_source_l00028}\doxymbox{\hyperlink{namespacerich__vars_afac4d06d60829484cfb7d4964964945b}{00028}}\ \textcolor{keywordtype}{\ \ \ \ real}(\doxymbox{\hyperlink{namespacenum__vars_a03802aa2bd86439d7a9370836fabf3f2}{dp}}),\ \textcolor{keywordtype}{allocatable}\ ::\ \doxymbox{\hyperlink{namespacerich__vars_afac4d06d60829484cfb7d4964964945b}{max\_rel\_err}}(:)\textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ !<\ maximum\ relative\ error\ for\ all\ Richardson\ levels}}
\DoxyCodeLine{\Hypertarget{rich__vars_8f90_source_l00029}\doxymbox{\hyperlink{namespacerich__vars_af3df7361e33058bc83fe43a803173d89}{00029}}\ \ \ \ \ \textcolor{keywordtype}{integer},\ \textcolor{keywordtype}{allocatable}\ ::\ \doxymbox{\hyperlink{namespacerich__vars_af3df7361e33058bc83fe43a803173d89}{loc\_max\_rel\_err}}(:,:)\textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ !<\ location\ of\ maximum\ of\ relative\ error}}
\DoxyCodeLine{\Hypertarget{rich__vars_8f90_source_l00030}00030\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{rich__vars_8f90_source_l00031}00031\ \textcolor{keyword}{contains}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{rich__vars_8f90_source_l00032}00032\ \textcolor{comment}{\ \ \ \ !>\ Returns\ string\ with\ \ possible\ extension\ with\ Richardson\ \ level\ or\ nothing}}
\DoxyCodeLine{\Hypertarget{rich__vars_8f90_source_l00033}00033\ \textcolor{comment}{\ \ \ \ !!\ if\ only\ one\ level\ and\ one\ parallel\ job.}}
\DoxyCodeLine{\Hypertarget{rich__vars_8f90_source_l00034}\doxymbox{\hyperlink{namespacerich__vars_a4f54d3fc0ac510fc073220794ee4fa37}{00034}}\ \ \ \ \ \textcolor{keywordtype}{elemental}\ \textcolor{keyword}{character(len=max\_str\_ln)\ }\textcolor{keyword}{function\ }\doxymbox{\hyperlink{namespacerich__vars_a4f54d3fc0ac510fc073220794ee4fa37}{rich\_info}}()}
\DoxyCodeLine{\Hypertarget{rich__vars_8f90_source_l00035}00035\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\doxymbox{\hyperlink{namespacenum__vars_afbd4cb9a4ef9e8a277aecfc41b09aa1d}{max\_it\_rich}}.gt.1)\ \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{rich__vars_8f90_source_l00036}00036\ \ \ \ \ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{namespacerich__vars_a4f54d3fc0ac510fc073220794ee4fa37}{rich\_info}}\ =\ \textcolor{stringliteral}{'\ for\ Richardson\ level\ '}//trim(\doxymbox{\hyperlink{namespacestr__utilities_a0b97e51770725a3e98ed393d26681414}{i2str}}(\doxymbox{\hyperlink{namespacerich__vars_a1b7734ba9ce6cc153b22387e638093c0}{rich\_lvl}}))}
\DoxyCodeLine{\Hypertarget{rich__vars_8f90_source_l00037}00037\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{rich__vars_8f90_source_l00038}00038\ \ \ \ \ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{namespacerich__vars_a4f54d3fc0ac510fc073220794ee4fa37}{rich\_info}}\ =\ \textcolor{stringliteral}{''}}
\DoxyCodeLine{\Hypertarget{rich__vars_8f90_source_l00039}00039\ \textcolor{keywordflow}{\ \ \ \ \ \ \ \ end\ if}}
\DoxyCodeLine{\Hypertarget{rich__vars_8f90_source_l00040}00040\ \ \ \ \ \textcolor{keyword}{end\ function\ }\doxymbox{\hyperlink{namespacerich__vars_a4f54d3fc0ac510fc073220794ee4fa37}{rich\_info}}}
\DoxyCodeLine{\Hypertarget{rich__vars_8f90_source_l00041}00041\ \textcolor{keyword}{end\ module\ }\doxymbox{\hyperlink{namespacerich__vars}{rich\_vars}}}

\end{DoxyCode}
