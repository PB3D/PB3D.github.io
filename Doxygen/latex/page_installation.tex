\chapter{Installation }
\hypertarget{page_installation}{}\label{page_installation}\index{Installation@{Installation}}
\hypertarget{page_installation_installation_introduction}{}\doxysection{\texorpdfstring{Introduction}{Introduction}}\label{page_installation_installation_introduction}
PB3D is written in Fortran, and makes use of multiple numerical libraries:\+
\begin{DoxyItemize}
\item \href{http://www.netlib.org/lapack/}{\texttt{blas /\+ lapack}}
\begin{DoxyItemize}
\item for basic linear algebra
\end{DoxyItemize}
\item \href{http://www.netlib.org/scalapack/}{\texttt{pblas /\+ blacs /\+ scalapack}}
\begin{DoxyItemize}
\item for parallelized basic linear algebra
\end{DoxyItemize}
\item \href{https://www.hdfgroup.org/HDF5/}{\texttt{HDF5}}
\begin{DoxyItemize}
\item for storage files
\item works in parallel
\end{DoxyItemize}
\item \href{https://www.unidata.ucar.edu/software/netcdf/}{\texttt{Net\+CDF}}
\begin{DoxyItemize}
\item to read input of VMEC
\item sequential
\end{DoxyItemize}
\item \href{https://www.mcs.anl.gov/petsc/}{\texttt{PETSc}} /\+ \href{http://slepc.upv.es/}{\texttt{SLEPc}}
\begin{DoxyItemize}
\item for linear algebra of large, sparse matrices
\item can reach $\sim \mathcal{O} (n)$ complexity
\item Minimal installation instructions:\+
\begin{DoxyEnumerate}
\item Configure PETSc using {\ttfamily ./\+configure PETSC\+\_\+\+ARCH=complex COPTFLAGS=-\/O3 CXXOPTFLAGS=-\/O3 FOPTFLAGS=-\/O3 \textbackslash{}\textbackslash{}endiskip}~\newline
 {\ttfamily -\/-\/with-\/scalar-\/type=complex \textbackslash{}\textbackslash{}endiskip}~\newline
 {\ttfamily -\/-\/download-\/metis \textbackslash{}\textbackslash{}endiskip}~\newline
 {\ttfamily -\/-\/download-\/mumps \textbackslash{}\textbackslash{}endiskip}~\newline
 {\ttfamily -\/-\/download-\/parmetis \textbackslash{}\textbackslash{}endiskip}~\newline
 {\ttfamily -\/-\/with-\/scalapack-\/lib="{}-\/L\+[SCALAPACKDIR]\+/\+lib -\/lscalapack"{} \textbackslash{}\textbackslash{}endiskip}~\newline
 {\ttfamily -\/-\/with-\/valgrind-\/dir=/\+usr \textbackslash{}\textbackslash{}endiskip}~\newline
 {\ttfamily -\/-\/with-\/debugging=no \textbackslash{}\textbackslash{}endiskip}~\newline
 {\ttfamily -\/-\/with-\/fortran-\/kernels=1}~\newline
 (If you want debug, remove {\ttfamily -\/-\/with-\/debugging=no}, {\ttfamily -\/-\/with-\/fortran-\/kernels=1}, COPTSFLAGS, CXXOPTFLAGS and FOPTFLAGS, and change PETSC\+\_\+\+ARCH to {\ttfamily debug-\/complex}.)~\newline
 (If you use a different HDF5, add {\ttfamily -\/-\/with-\/hdf5-\/dir=\+[HDF5\+DIR]\+}.)
\item follow instructions to do makes and tests.
\item Set global variables {\ttfamily export SLEPC\+\_\+\+DIR=\+[SLEPC DIR]\+}, {\ttfamily export PETSC\+\_\+\+DIR=\+[PETSC\+\_\+\+DIR]\+} and {\ttfamily export PETSC\+\_\+\+ARCH=\+[debug-\/]\+complex} (depending on whether it is debug or not).
\item Configure SLEPc using {\ttfamily ./\+configure}
\item follow instructions to do makes and tests
\end{DoxyEnumerate}
\end{DoxyItemize}
\item \href{http://portal.nersc.gov/project/sparse/strumpack/}{\texttt{Strum\+Pack}}
\begin{DoxyItemize}
\item for linear algebra of structured matrices \DoxyCite{ambikasaran2013}{number}{1}
\item the vacuum potential energy perturbation calculations use such matrices as they are generated with a $1/r$ kernel.
\item can reach $\sim \mathcal{O} (n \log(n))$ complexity
\item we use the dense version of the package, which for Fortran is 1.\+1.\+1.
\item Minimal installation instructions:\+
\begin{DoxyEnumerate}
\item \href{http://portal.nersc.gov/project/sparse/strumpack/STRUMPACK-Dense-1.1.1.tar.gz}{\texttt{Download}}, untar and go to root folder.
\item Go to examples, copy {\ttfamily Makefile.\+gnu} to {\ttfamily Makefile.\+inc} and adapt:\+
\begin{DoxyEnumerate}
\item for example, it might be necessary to add {\ttfamily -\/lblacs} before {\ttfamily -\/lscalapack}
\item if you use intel, have a look at the \href{https://software.intel.com/en-us/articles/intel-mkl-link-line-advisor}{\texttt{link line advisor}}, and update the {\ttfamily LIB}
\item possibly, you might have to set the {\ttfamily CC} and {\ttfamily FC} compiler commands to, for example, {\ttfamily mpicc} respectively {\ttfamily mpiifort}
\end{DoxyEnumerate}
\item Create directories {\ttfamily lib} and {\ttfamily inc}.
\item Run {\ttfamily make f90\+\_\+example}
\item Make a library of {\ttfamily Strumpack\+Dense\+Package.\+o} using {\ttfamily ar -\/rcs libstrumpack.\+a \texorpdfstring{$\ast$}{*}.o} in src.
\item In inc, create a symlink {\ttfamily libstrumpack.\+a} to {\ttfamily libstrumpack.\+a} in src.
\item In lib, create a symlink {\ttfamily strumpackdensepackage.\+mod} to {\ttfamily strumpackdensepackage.\+mod} in examples.
\end{DoxyEnumerate}
\end{DoxyItemize}
\item \href{https://bitbucket.org/lazerson_princeton/stellopt/wiki/Home}{\texttt{libstell}}
\begin{DoxyItemize}
\item part of Stellopt suite, which contains VMEC
\item provides routines to read VMEC output data
\end{DoxyItemize}
\item \href{https://w3.pppl.gov/ntcc/PSPLINE/}{\texttt{pspline}}
\begin{DoxyItemize}
\item Princeton Spline and Hermite Cubic Interpolation Routines
\item Minimal installation instructions:\+
\begin{DoxyEnumerate}
\item Export {\ttfamily FFLAGS} en {\ttfamily CFLAGS} if you want to optimize:\+
\begin{DoxyItemize}
\item copy {\ttfamily share/\+\+Make.\+overwrite.\+sample} to {\ttfamily share/\+\+Make.\+overwrite}
\item Run the gmake below and note the flags, then edit these and put them in {\ttfamily share/\+\+Make.\+overwrite}
\item if GCC:\+
\begin{DoxyItemize}
\item {\ttfamily FFLAGS = -\/c -\/O3 -\/m64 -\/fno-\/range-\/check -\/fdollar-\/ok -\/cpp ; export FFLAGS}
\item {\ttfamily CFLAGS = -\/c -\/O3 -\/m64 ; export CFLAGS}
\item {\ttfamily CXXFLAGS = -\/c -\/O3 -\/m64 ; export CXXFLAGS}
\end{DoxyItemize}
\item if Intel:\+
\begin{DoxyItemize}
\item {\ttfamily FFLAGS = -\/c -\/O3 -\/nowarn -\/ftz -\/auto-\/scalar -\/traceback -\/align dcommons}
\item {\ttfamily MPI\+\_\+\+FFLAGS = -\/c -\/O3 -\/nowarn -\/ftz -\/traceback -\/align dcommons -\/auto-\/scalar} (possibly add FC=mpiifort, {\ttfamily CXX=mpicpc}, {\ttfamily CC=mpiicc} if on a cluster)
\end{DoxyItemize}
\end{DoxyItemize}
\item Compile with {\ttfamily gmake NETCDF\+\_\+\+DIR= FORTRAN\+\_\+\+VARIANT=\+[VARIANT]\+} with {\ttfamily \+[VARIANT]\+} either {\ttfamily GCC} or {\ttfamily Intel} (add {\ttfamily DEBUG=1} and remove the FLAGS if debug wanted). Possibly also add {\ttfamily OBJ=\$\+[COMP\+\_\+\+DIR]\+} if on a cluster, with {\ttfamily \+[COMP\+\_\+\+DIR]\+} the directory where to put the resulting library.
\item Run tests from {\ttfamily README\+\_\+\+Pspline}.
\end{DoxyEnumerate}
\end{DoxyItemize}
\end{DoxyItemize}

They should probably be installed in this order. On linux distributions such as Ubuntu, they may be available as packages.

Furthermore, PB3D comes bundled with some other, smaller libraries:\+
\begin{DoxyItemize}
\item \href{http://www.netlib.org/fftpack/}{\texttt{fftpack}}
\begin{DoxyItemize}
\item to calculate the fast Fourier transform
\end{DoxyItemize}
\item \href{http://foul.sourceforge.net/}{\texttt{foul}}
\begin{DoxyItemize}
\item the Fortran Output Library
\end{DoxyItemize}
\end{DoxyItemize}

These do not have to be installed separately.\hypertarget{page_installation_installation_compilation}{}\doxysection{\texorpdfstring{Compilation}{Compilation}}\label{page_installation_installation_compilation}
When all dependencies are satisfied, the program is then compiled in the standard way:\+
\begin{DoxyItemize}
\item Including the headers of all the libraries in the compilation of the object files:\+
\begin{DoxyItemize}
\item This is done using {\ttfamily -\/I\+[path\+\_\+to\+\_\+library]\+}.
\item Make sure you add the {\ttfamily -\/o} option to create only object files.
\end{DoxyItemize}
\item Linking with the actual libraries
\begin{DoxyItemize}
\item This is done using {\ttfamily -\/L\+[path\+\_\+to\+\_\+library]\+ -\/l\+[library\+\_\+name]\+}.
\end{DoxyItemize}
\end{DoxyItemize}\hypertarget{page_installation_installation_makefile}{}\doxysection{\texorpdfstring{Makefile Example}{Makefile Example}}\label{page_installation_installation_makefile}

\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{00001\ \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\DoxyCodeLine{00002\ \#}
\DoxyCodeLine{00003\ \#\ \ \ Example\ makefile\ for\ the\ program\ PB3D\ (Peeling\ Ballooning\ in\ 3D)}
\DoxyCodeLine{00004\ \#\ \ \ \(\backslash\)author\ Author:\ Toon\ Weyens}
\DoxyCodeLine{00005\ \#}
\DoxyCodeLine{00006\ \#\ \ \ Don't\ forget\ to\ set\ the\ directories:}
\DoxyCodeLine{00007\ \#\ \ \ \ \ \ \ -\/\ LIBSTELL\_DIR}
\DoxyCodeLine{00008\ \#\ \ \ \ \ \ \ -\/\ HDF5\_DIR}
\DoxyCodeLine{00009\ \#\ \ \ \ \ \ \ -\/\ NETCDFF\_DIR\ (note:\ Fortran\ library)}
\DoxyCodeLine{00010\ \#\ \ \ \ \ \ \ -\/\ PETSC\_DIR}
\DoxyCodeLine{00011\ \#\ \ \ \ \ \ \ -\/\ SLEPC\_DIR}
\DoxyCodeLine{00012\ \#\ \ \ \ \ \ \ -\/\ STRUMPACK\_DIR}
\DoxyCodeLine{00013\ \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00015\ \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\DoxyCodeLine{00016\ \#\ \ \ Include}
\DoxyCodeLine{00017\ \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\DoxyCodeLine{00018\ \#\#\ [PETSc\ and\ SLEPc\ trick]}
\DoxyCodeLine{00019\ include\ \ \$(PETSC\_DIR)/lib/petsc/conf/variables}
\DoxyCodeLine{00020\ include\ \ \$(SLEPC\_DIR)/lib/slepc/conf/slepc\_variables}
\DoxyCodeLine{00021\ \#\#\ [PETSc\ and\ SLEPc\ trick]}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ \#\#\ [PETSc\ and\ SLEPc\ trick\ inc]}
\DoxyCodeLine{00024\ INCLUDE\ =\ \$(PETSC\_FC\_INCLUDES)\ \$(SLEPC\_INCLUDE)}
\DoxyCodeLine{00025\ \#\#\ [PETSc\ and\ SLEPc\ trick\ inc]}
\DoxyCodeLine{00026\ \#\#\ [Libstell\ special]}
\DoxyCodeLine{00027\ INCLUDE\ +=\ -\/I\$(LIBSTELL\_DIR)/libstell\_dir}
\DoxyCodeLine{00028\ \#\#\ [Libstell\ special]}
\DoxyCodeLine{00029\ INCLUDE\ +=\ -\/I\$(STRUMPACK\_DIR)/include}
\DoxyCodeLine{00030\ \#\#\ [PB3D\ include]}
\DoxyCodeLine{00031\ INCLUDE\ +=\ -\/I\$(PB3D\_DIR)/include}
\DoxyCodeLine{00032\ \#\#\ [PB3D\ include]}
\DoxyCodeLine{00033\ INCLUDE\ +=\ -\/I/usr/include/hdf5/openmpi}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00035\ \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\DoxyCodeLine{00036\ \#\ \ \ Link}
\DoxyCodeLine{00037\ \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\DoxyCodeLine{00038\ \#\#\ [PB3D\ libraries]}
\DoxyCodeLine{00039\ LIB\_INTERNAL\ =\ libdfftpack.a\ libfoul.a\ libbspline.a}
\DoxyCodeLine{00040\ \#\#\ [PB3D\ libraries]}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00042\ LINK\ :=\ \$(LIB\_INTERNAL)}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00044\ \#\#\ [PETSc\ and\ SLEPc\ trick\ lib]}
\DoxyCodeLine{00045\ LINK\ +=\ \$(PETSC\_LIB)}
\DoxyCodeLine{00046\ LINK\ +=\ \$(SLEPC\_LIB)}
\DoxyCodeLine{00047\ \#\#\ [PETSc\ and\ SLEPc\ trick\ lib]}
\DoxyCodeLine{00048\ LINK\ +=\ \$(LIBSTELL\_DIR)/libstell.a}
\DoxyCodeLine{00049\ LINK\ +=\ -\/L\$(STRUMPACK\_DIR)/lib\ -\/lstrumpack}
\DoxyCodeLine{00050\ LINK\ +=\ -\/L\$(HDF5\_DIR)\ -\/lhdf5\_fortran\ -\/lhdf5}
\DoxyCodeLine{00051\ LINK\ +=\ -\/L\$(NETCDFF\_DIR)/lib\ -\/lnetcdff}
\DoxyCodeLine{00052\ LINK\ +=\ -\/Wl,-\/R\$(NETCDFF\_DIR)/lib}
\DoxyCodeLine{00053\ LINK\ +=\ -\/lscalapack\ -\/lblacs\ -\/lblas\ -\/lm}
\DoxyCodeLine{00054\ LINK\ +=\ -\/lstdc++\ -\/lmpi\_cxx}
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00056\ }
\DoxyCodeLine{00057\ \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\DoxyCodeLine{00058\ \#\ \ \ Compiler}
\DoxyCodeLine{00059\ \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\DoxyCodeLine{00060\ COMPILER=mpifort}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00062\ }
\DoxyCodeLine{00063\ \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\DoxyCodeLine{00064\ \#\ \ \ Linker}
\DoxyCodeLine{00065\ \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\DoxyCodeLine{00066\ LINKER=mpifort}
\DoxyCodeLine{00067\ }
\DoxyCodeLine{00068\ }
\DoxyCodeLine{00069\ \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\DoxyCodeLine{00070\ \#\ \ \ Compiler\ flags}
\DoxyCodeLine{00071\ \#\ \ \ options\ (used\ with\ -\/D[name]):}
\DoxyCodeLine{00072\ \#\ \ \ \ \ \ \ ldebug:\ debug}
\DoxyCodeLine{00073\ \#\ \ \ \ \ \ \ lIB:\ infiniband}
\DoxyCodeLine{00074\ \#\ \ \ \ \ \ \ lwith\_gnu:\ use\ GNU\ compiler\ [default]}
\DoxyCodeLine{00075\ \#\ \ \ \ \ \ \ lwith\_intel:\ use\ INTEL\ compiler,\ (checked\ for\ version\ 12.0.2)}
\DoxyCodeLine{00076\ \#\ \ \ note:\ INTEL\ warning\ 6536\ is\ suppressed,\ which\ informs\ about\ extra\ "{}USE"{}.}
\DoxyCodeLine{00077\ \#\ \ \ note:\ INTEL\ warning\ 6843\ is\ suppressed,\ which\ informs\ about\ empty}
\DoxyCodeLine{00078\ \#\ \ \ \ \ \ \ intent(out)\ variables}
\DoxyCodeLine{00079\ \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\DoxyCodeLine{00080\ COMP\_FLAGS\ =\ -\/finit-\/real=snan\ -\/g\ -\/Og\ -\/Wall\ -\/Wextra\ -\/pedantic\ \(\backslash\)}
\DoxyCodeLine{00081\ \ \ \ \ -\/fimplicit-\/none\ -\/fbacktrace\ -\/fno-\/omit-\/frame-\/pointer\ \(\backslash\)}
\DoxyCodeLine{00082\ \ \ \ \ -\/fcheck=all\ -\/cpp\ -\/Dldebug\#\ debug,\ profiling\ with\ gprof2dot,\ GCC}
\DoxyCodeLine{00083\ \#COMP\_FLAGS\ =\ -\/O3\ -\/fbacktrace\ -\/g\ -\/fimplicit-\/none\ -\/fno-\/omit-\/frame-\/pointer\ \(\backslash\)}
\DoxyCodeLine{00084\ \ \ \ \ \#-\/cpp\#\ optimized,\ GCC}
\DoxyCodeLine{00085\ }
\DoxyCodeLine{00086\ \#COMP\_FLAGS\ =\ -\/O0\ -\/DlIB\ -\/Dldebug\ -\/g\ -\/heap-\/arrays\ 100\ -\/recursive\ \(\backslash\)}
\DoxyCodeLine{00087\ \ \ \ \ \#-\/ftrapuv\ -\/check\ bounds\ -\/check\ uninit\ -\/traceback\ -\/implicitnone\ \(\backslash\)}
\DoxyCodeLine{00088\ \ \ \ \ \#-\/fno-\/omit-\/frame-\/pointer\ -\/cpp\ -\/Dlwith\_intel\ -\/diag-\/disable\ 6536\ \(\backslash\)}
\DoxyCodeLine{00089\ \ \ \ \ \#-\/diag-\/disable\ 6843\#\ debug,\ profiling\ with\ gprof2dot,\ INTEL}
\DoxyCodeLine{00090\ \#COMP\_FLAGS\ =\ -\/O3\ -\/DlIB\ -\/traceback\ -\/g\ -\/heap-\/arrays\ 100\ -\/recursive\ \(\backslash\)}
\DoxyCodeLine{00091\ \ \ \ \ \#-\/implicitnone\ -\/fno-\/omit-\/frame-\/pointer\ -\/cpp\ -\/Dlwith\_intel\ \(\backslash\)}
\DoxyCodeLine{00092\ \ \ \ \ \#-\/diag-\/disable\ 6536\ -\/diag-\/disable\ 6843\#\ optimized,\ INTEL}
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00094\ COMP\_FLAGS\_EX=\ -\/O2\ -\/w}
\DoxyCodeLine{00095\ }
\DoxyCodeLine{00096\ COMP\_FLAGS\_F=\ -\/O2\ -\/funroll-\/loops\ -\/fexpensive-\/optimizations}
\DoxyCodeLine{00097\ }
\DoxyCodeLine{00098\ }
\DoxyCodeLine{00099\ \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\DoxyCodeLine{00100\ \#\ \ \ Link\ flags}
\DoxyCodeLine{00101\ \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\DoxyCodeLine{00102\ LINK\_FLAGS\ =\ -\/fPIC\ -\/finit-\/real=snan\#\ debug}
\DoxyCodeLine{00103\ \#LINK\_FLAGS\ =\ -\/fPIC\#\ optimized}
\DoxyCodeLine{00104\ }
\DoxyCodeLine{00105\ }
\DoxyCodeLine{00106\ \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\DoxyCodeLine{00107\ \#\ \ \ Prepare}
\DoxyCodeLine{00108\ \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\DoxyCodeLine{00109\ \#\ Add\ "{}Modules"{}\ and\ "{}Libraries"{}\ to\ the\ search\ path\ for\ the\ prerequisites}
\DoxyCodeLine{00110\ VPATH\ =\ Modules:Libraries}
\DoxyCodeLine{00111\ }
\DoxyCodeLine{00112\ \#\ Contains\ list\ of\ source\ files\ (.o)\ and\ dependencies}
\DoxyCodeLine{00113\ DEPLIST\ =\ PB3D.dep}
\DoxyCodeLine{00114\ OBJLIST\ =\ ObjectList\#\ defines\ "{}ObjectFiles"{}}
\DoxyCodeLine{00115\ }
\DoxyCodeLine{00116\ \#\ Includes\ source\ files\ and\ dependency\ list}
\DoxyCodeLine{00117\ include\ \$(DEPLIST)\#\ Dependencies\ of\ all\ the\ objects}
\DoxyCodeLine{00118\ include\ \$(OBJLIST)\#\ Names\ of\ all\ the\ objects}
\DoxyCodeLine{00119\ }
\DoxyCodeLine{00120\ }
\DoxyCodeLine{00121\ \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\DoxyCodeLine{00122\ \#\ \ \ Rules}
\DoxyCodeLine{00123\ \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\DoxyCodeLine{00124\ all:\ \ \ \ PB3D\ POST}
\DoxyCodeLine{00125\ }
\DoxyCodeLine{00126\ PB3D:\ \ \ \$(ObjectFiles)\ \$(LIB\_INTERNAL)\ PB3D.o}
\DoxyCodeLine{00127\ \ \ \ \ \$(LINKER)\ -\/o\ \$@\ \$(ObjectFiles)\ PB3D.o\ \$(LINK)\ \$(LINK\_FLAGS)}
\DoxyCodeLine{00128\ }
\DoxyCodeLine{00129\ POST:\ \ \ \$(ObjectFiles)\ \$(LIB\_INTERNAL)\ POST.o}
\DoxyCodeLine{00130\ \ \ \ \ \$(LINKER)\ -\/o\ \$@\ \$(ObjectFiles)\ POST.o\ \$(LINK)\ \$(LINK\_FLAGS)}
\DoxyCodeLine{00131\ }
\DoxyCodeLine{00132\ libdfftpack.a:\ \ dfft.o}
\DoxyCodeLine{00133\ \ \ \ \ ar\ -\/rcs\ libdfftpack.a\ dfft.o}
\DoxyCodeLine{00134\ }
\DoxyCodeLine{00135\ libfoul.a:\ \ foul.o}
\DoxyCodeLine{00136\ \ \ \ \ ar\ -\/rcs\ libfoul.a\ foul.o}
\DoxyCodeLine{00137\ }
\DoxyCodeLine{00138\ libbspline.a:\ \ \ bspline\_sub\_module.o}
\DoxyCodeLine{00139\ \ \ \ \ ar\ -\/rcs\ libbspline.a\ bspline\_sub\_module.o}
\DoxyCodeLine{00140\ }
\DoxyCodeLine{00141\ \%.o:\ \%.f90}
\DoxyCodeLine{00142\ \ \ \ \ \$(COMPILER)\ \$(INCLUDE)\ \$(COMP\_FLAGS)\ -\/c\ \$<}
\DoxyCodeLine{00143\ }
\DoxyCodeLine{00144\ \%.o:\ \%.f}
\DoxyCodeLine{00145\ \ \ \ \ \$(COMPILER)\ \$(COMP\_FLAGS\_F)\ -\/c\ \$<}
\DoxyCodeLine{00146\ }
\DoxyCodeLine{00147\ dfft.o:\ dfft.f}
\DoxyCodeLine{00148\ \ \ \ \ \$(COMPILER)\ \$(COMP\_FLAGS\_EX)\ -\/c\ \$<}
\DoxyCodeLine{00149\ }
\DoxyCodeLine{00150\ foul.o:\ foul.f90}
\DoxyCodeLine{00151\ \ \ \ \ \$(COMPILER)\ \$(COMP\_FLAGS\_EX)\ -\/c\ \$<}
\DoxyCodeLine{00152\ }
\DoxyCodeLine{00153\ bspline\_sub\_module.o:\ bspline\_sub\_module.f90}
\DoxyCodeLine{00154\ \ \ \ \ \$(COMPILER)\ \$(COMP\_FLAGS\_EX)\ -\/c\ \$<}
\DoxyCodeLine{00155\ }
\DoxyCodeLine{00156\ clean:}
\DoxyCodeLine{00157\ \ \ \ \ @rm\ -\/f\ *.o\ *.a\ *.mod\ *\string~\ fort.*\ }
\DoxyCodeLine{00158\ }
\DoxyCodeLine{00159\ clean\_all:}
\DoxyCodeLine{00160\ \ \ \ \ @rm\ -\/f\ *.o\ *.mod\ *\string~\ fort.*\ PB3D\ POST}

\end{DoxyCodeInclude}


\begin{DoxyNote}{Note}

\begin{DoxyEnumerate}
\item PETSc and SLEPc don\textquotesingle{}t like to be included in another makefile. The trick is to include two files:\+ 
\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{00019\ include\ \ \$(PETSC\_DIR)/lib/petsc/conf/variables}
\DoxyCodeLine{00020\ include\ \ \$(SLEPC\_DIR)/lib/slepc/conf/slepc\_variables}

\end{DoxyCodeInclude}
 which will load the variables {\ttfamily PETSC\+\_\+\+FC\+\_\+\+INCLUDES} and {\ttfamily SLEPC\+\_\+\+INCLUDE}, used in 
\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{00024\ INCLUDE\ =\ \$(PETSC\_FC\_INCLUDES)\ \$(SLEPC\_INCLUDE)}

\end{DoxyCodeInclude}
 as well as the variables {\ttfamily PETSC\+\_\+\+LIB} and {\ttfamily SLEPC\+\_\+\+LIB}, used in 
\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{00045\ LINK\ +=\ \$(PETSC\_LIB)}
\DoxyCodeLine{00046\ LINK\ +=\ \$(SLEPC\_LIB)}

\end{DoxyCodeInclude}

\item There are versions of libstell that do not use the standard convention. In this case you have to look for the {\ttfamily \texorpdfstring{$\ast$}{*}.mod} files. In the example makefile this is done with 
\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{00027\ INCLUDE\ +=\ -\/I\$(LIBSTELL\_DIR)/libstell\_dir}

\end{DoxyCodeInclude}
 instead of the standard {\ttfamily inc} directory.
\item In 
\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{00031\ INCLUDE\ +=\ -\/I\$(PB3D\_DIR)/include}

\end{DoxyCodeInclude}
 there are includefiles that contain macros and wrappers specifically for PB3D.
\item In 
\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{00039\ LIB\_INTERNAL\ =\ libdfftpack.a\ libfoul.a\ libbspline.a}

\end{DoxyCodeInclude}
 linking is done with external libraries that are bundled with PB3D. 
\end{DoxyEnumerate}
\end{DoxyNote}
