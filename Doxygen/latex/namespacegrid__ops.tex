\doxysection{grid\+\_\+ops Module Reference}
\hypertarget{namespacegrid__ops}{}\label{namespacegrid__ops}\index{grid\_ops@{grid\_ops}}


Operations that have to do with the grids and different coordinate systems.  


\doxysubsubsection*{Functions/\+\+Subroutines}
\begin{DoxyCompactItemize}
\item 
integer function, public \doxymbox{\hyperlink{namespacegrid__ops_a7dd21871a4e65190fe6235eb2af4b6c2}{calc\+\_\+norm\+\_\+range}} (style, in\+\_\+limits, eq\+\_\+limits, x\+\_\+limits, sol\+\_\+limits, r\+\_\+f\+\_\+eq, r\+\_\+f\+\_\+x, r\+\_\+f\+\_\+sol, jq)
\begin{DoxyCompactList}\small\item\em Calculates normal range for the input grid, the equilibrium grid and/\+or the solution grid. \end{DoxyCompactList}\item 
integer function, public \doxymbox{\hyperlink{namespacegrid__ops_af63366847d1caa64a7d329672292fd34}{setup\+\_\+grid\+\_\+eq}} (grid\+\_\+eq, eq\+\_\+limits)
\begin{DoxyCompactList}\small\item\em Sets up the equilibrium grid. \end{DoxyCompactList}\item 
integer function, public \doxymbox{\hyperlink{namespacegrid__ops_addd35a4585f818ae0a7d94ee2156f1bd}{setup\+\_\+grid\+\_\+eq\+\_\+b}} (grid\+\_\+eq, grid\+\_\+eq\+\_\+b, eq, only\+\_\+half\+\_\+grid)
\begin{DoxyCompactList}\small\item\em Sets up the field-\/aligned equilibrium grid. \end{DoxyCompactList}\item 
integer function, public \doxymbox{\hyperlink{namespacegrid__ops_affff458bc90352a94138e63b4a0feebe}{setup\+\_\+grid\+\_\+x}} (grid\+\_\+eq, grid\+\_\+x, r\+\_\+f\+\_\+x, x\+\_\+limits)
\begin{DoxyCompactList}\small\item\em Sets up the general perturbation grid, in which the perturbation variables are calculated. \end{DoxyCompactList}\item 
integer function, public \doxymbox{\hyperlink{namespacegrid__ops_acb93d3ad89ab0efeff8c1b31ff77cec1}{setup\+\_\+grid\+\_\+sol}} (grid\+\_\+eq, grid\+\_\+x, grid\+\_\+sol, r\+\_\+f\+\_\+sol, sol\+\_\+limits)
\begin{DoxyCompactList}\small\item\em Sets up the general solution grid, in which the solution variables are calculated. \end{DoxyCompactList}\item 
integer function, public \doxymbox{\hyperlink{namespacegrid__ops_a06107dbdfd1dd62e372cc29ab0255bad}{calc\+\_\+ang\+\_\+grid\+\_\+eq\+\_\+b}} (grid\+\_\+eq, eq, only\+\_\+half\+\_\+grid)
\begin{DoxyCompactList}\small\item\em Calculate equilibrium grid that follows magnetic field lines. \end{DoxyCompactList}\item 
integer function, public \doxymbox{\hyperlink{namespacegrid__ops_ab10ef5b486ee3861df2da4e53bc22630}{redistribute\+\_\+output\+\_\+grid}} (grid, grid\+\_\+out, no\+\_\+outer\+\_\+trim)
\begin{DoxyCompactList}\small\item\em Redistribute a grid to match the normal distribution of solution grid. \end{DoxyCompactList}\item 
integer function, public \doxymbox{\hyperlink{namespacegrid__ops_addd76b7b3be0b51e0863ae0cdfef41e6}{magn\+\_\+grid\+\_\+plot}} (grid)
\begin{DoxyCompactList}\small\item\em Plots the grid in real 3-\/D space. \end{DoxyCompactList}\item 
integer function, public \doxymbox{\hyperlink{namespacegrid__ops_a4827e794d37334c0cad9bb2016e64d46}{print\+\_\+output\+\_\+grid}} (grid, grid\+\_\+name, data\+\_\+name, rich\+\_\+lvl, par\+\_\+div, remove\+\_\+previous\+\_\+arrs)
\begin{DoxyCompactList}\small\item\em Print grid variables to an output file. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
logical, public \doxymbox{\hyperlink{namespacegrid__ops_ad043ab1b07b2d251bb7596b8c8d2f960}{debug\+\_\+calc\+\_\+ang\+\_\+grid\+\_\+eq\+\_\+b}} = .false.
\begin{DoxyCompactList}\small\item\em plot debug information for \doxylink{namespacegrid__ops_a06107dbdfd1dd62e372cc29ab0255bad}{calc\+\_\+ang\+\_\+grid\+\_\+eq\+\_\+b()} \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Operations that have to do with the grids and different coordinate systems. 

\label{doc-func-members}
\Hypertarget{namespacegrid__ops_doc-func-members}
\doxysubsection{Function/\+\+Subroutine Documentation}
\Hypertarget{namespacegrid__ops_a06107dbdfd1dd62e372cc29ab0255bad}\index{grid\_ops@{grid\_ops}!calc\_ang\_grid\_eq\_b@{calc\_ang\_grid\_eq\_b}}
\index{calc\_ang\_grid\_eq\_b@{calc\_ang\_grid\_eq\_b}!grid\_ops@{grid\_ops}}
\doxysubsubsection{\texorpdfstring{calc\_ang\_grid\_eq\_b()}{calc\_ang\_grid\_eq\_b()}}
{\footnotesize\ttfamily \label{namespacegrid__ops_a06107dbdfd1dd62e372cc29ab0255bad} 
integer function, public grid\+\_\+ops::\+calc\+\_\+ang\+\_\+grid\+\_\+eq\+\_\+b (\begin{DoxyParamCaption}\item[{type(\doxymbox{\hyperlink{structgrid__vars_1_1grid__type}{grid\+\_\+type}}), intent(inout)}]{grid\+\_\+eq}{, }\item[{type(\doxymbox{\hyperlink{structeq__vars_1_1eq__1__type}{eq\+\_\+1\+\_\+type}}), intent(in), target}]{eq}{, }\item[{logical, intent(in), optional}]{only\+\_\+half\+\_\+grid}{}\end{DoxyParamCaption})}



Calculate equilibrium grid that follows magnetic field lines. 

This grid is different from the equilibrium grid from setup\+\_\+grid\+\_\+eq for HELENA, as the latter is the output grid from HELENA, which is situated in a single poloidal cross-\/section, as opposed to a really field-\/aligne grid.

For VMEC, this is not used as the grid is field-\/aligned from the start.

\begin{DoxyNote}{Note}

\begin{DoxyEnumerate}
\item The end-\/points are included for the grids in the parallel direction. This is to facilitate working with the trapezoidal rule or Simpson\textquotesingle{}s 3/\+8 rule for integration. This is {\bfseries{NOT}} valid in general!
\item by setting the flag {\ttfamily only\+\_\+half\+\_\+grid}, only the even points of the parallel grid are calculated, which is useful for higher Richardson levels with VMEC so that only new angular points are calculated and the old ones reused.
\end{DoxyEnumerate}
\end{DoxyNote}
\begin{DoxyReturn}{Returns}
ierr 
\end{DoxyReturn}

\begin{DoxyParams}[1]{Parameters}
\doxymbox{\texttt{in,out}}  & {\em grid\+\_\+eq} & equilibrium grid of which to calculate angular part \\
\hline
\doxymbox{\texttt{in}}  & {\em eq} & flux equilibrium variables \\
\hline
\doxymbox{\texttt{in}}  & {\em only\+\_\+half\+\_\+grid} & calculate only half grid with even points \\
\hline
\end{DoxyParams}


Definition at line \doxymbox{\hyperlink{grid__ops_8f90_source_l00797}{797}} of file \doxymbox{\hyperlink{grid__ops_8f90_source}{grid\+\_\+ops.\+f90}}.

Here is the call graph for this function:\+\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacegrid__ops_a06107dbdfd1dd62e372cc29ab0255bad_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function:\+\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacegrid__ops_a06107dbdfd1dd62e372cc29ab0255bad_icgraph}
\end{center}
\end{figure}
\Hypertarget{namespacegrid__ops_a7dd21871a4e65190fe6235eb2af4b6c2}\index{grid\_ops@{grid\_ops}!calc\_norm\_range@{calc\_norm\_range}}
\index{calc\_norm\_range@{calc\_norm\_range}!grid\_ops@{grid\_ops}}
\doxysubsubsection{\texorpdfstring{calc\_norm\_range()}{calc\_norm\_range()}}
{\footnotesize\ttfamily \label{namespacegrid__ops_a7dd21871a4e65190fe6235eb2af4b6c2} 
integer function, public grid\+\_\+ops::\+calc\+\_\+norm\+\_\+range (\begin{DoxyParamCaption}\item[{character(len=\texorpdfstring{$\ast$}{*}), intent(in)}]{style}{, }\item[{integer, dimension(2), intent(inout), optional}]{in\+\_\+limits}{, }\item[{integer, dimension(2), intent(inout), optional}]{eq\+\_\+limits}{, }\item[{integer, dimension(2), intent(inout), optional}]{x\+\_\+limits}{, }\item[{integer, dimension(2), intent(inout), optional}]{sol\+\_\+limits}{, }\item[{real(dp), dimension(:\+), intent(inout), optional}]{r\+\_\+f\+\_\+eq}{, }\item[{real(dp), dimension(:\+), intent(inout), optional, allocatable}]{r\+\_\+f\+\_\+x}{, }\item[{real(dp), dimension(:\+), intent(inout), optional}]{r\+\_\+f\+\_\+sol}{, }\item[{real(dp), dimension(:\+), intent(in), optional}]{jq}{}\end{DoxyParamCaption})}



Calculates normal range for the input grid, the equilibrium grid and/\+or the solution grid. 

General workings, depending on {\ttfamily X\+\_\+grid\+\_\+style:\+} 


\begin{DoxyTable}{3}{}{}{1}
\SetCell{c,bg=\tableheadbgcolor,font=\bfseries}1 (equilibrium)  &\SetCell{c,bg=\tableheadbgcolor,font=\bfseries}2 (solution )  &\SetCell{c,bg=\tableheadbgcolor,font=\bfseries}3 (enriched)  \\
calc\+\_\+eq()  &calc\+\_\+eq()  &calc\+\_\+eq()  \\
&redistribute to sol  &add points to optimize  \\
&interpolate to sol  &interpolate to X  \\
calc\+\_\+x()  &calc\+\_\+x()  &calc\+\_\+x()  \\
redistribute to sol  &copy to sol  &redistribute to sol  \\
interpolate to sol  &&interpolate to sol  \\
\end{DoxyTable}


\begin{DoxyReturn}{Returns}
ierr 
\end{DoxyReturn}

\begin{DoxyParams}[1]{Parameters}
\doxymbox{\texttt{in}}  & {\em style} & style of calculation (PB3D:\+ in, eq, X or sol; POST) \\
\hline
\doxymbox{\texttt{in,out}}  & {\em in\+\_\+limits} & min. and max. index of in grid \\
\hline
\doxymbox{\texttt{in,out}}  & {\em eq\+\_\+limits} & min. and max. index of eq grid for this process \\
\hline
\doxymbox{\texttt{in,out}}  & {\em x\+\_\+limits} & min. and max. index of X grid for this process \\
\hline
\doxymbox{\texttt{in,out}}  & {\em sol\+\_\+limits} & min. and max. index of sol grid for this process \\
\hline
\doxymbox{\texttt{in,out}}  & {\em r\+\_\+f\+\_\+eq} & equilibrium r\+\_\+F \\
\hline
\doxymbox{\texttt{in,out}}  & {\em r\+\_\+f\+\_\+x} & perturbation r\+\_\+F \\
\hline
\doxymbox{\texttt{in,out}}  & {\em r\+\_\+f\+\_\+sol} & solution r\+\_\+F \\
\hline
\doxymbox{\texttt{in}}  & {\em jq} & q\+\_\+saf (pol. flux) or rot\+\_\+t (tor. flux) in total Flux variables \\
\hline
\end{DoxyParams}


Definition at line \doxymbox{\hyperlink{grid__ops_8f90_source_l00044}{44}} of file \doxymbox{\hyperlink{grid__ops_8f90_source}{grid\+\_\+ops.\+f90}}.

Here is the call graph for this function:\+\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacegrid__ops_a7dd21871a4e65190fe6235eb2af4b6c2_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function:\+\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacegrid__ops_a7dd21871a4e65190fe6235eb2af4b6c2_icgraph}
\end{center}
\end{figure}
\Hypertarget{namespacegrid__ops_addd76b7b3be0b51e0863ae0cdfef41e6}\index{grid\_ops@{grid\_ops}!magn\_grid\_plot@{magn\_grid\_plot}}
\index{magn\_grid\_plot@{magn\_grid\_plot}!grid\_ops@{grid\_ops}}
\doxysubsubsection{\texorpdfstring{magn\_grid\_plot()}{magn\_grid\_plot()}}
{\footnotesize\ttfamily \label{namespacegrid__ops_addd76b7b3be0b51e0863ae0cdfef41e6} 
integer function, public grid\+\_\+ops::\+magn\+\_\+grid\+\_\+plot (\begin{DoxyParamCaption}\item[{type(\doxymbox{\hyperlink{structgrid__vars_1_1grid__type}{grid\+\_\+type}}), intent(in)}]{grid}{}\end{DoxyParamCaption})}



Plots the grid in real 3-\/D space. 

This creates an animation that can be used by Para\+View or Vis\+It.

The equilibrium grid should contain the fieldline-\/oriented angles with {\ttfamily ang\+\_\+1} the parallel angle and {\ttfamily ang\+\_\+2} the field line label.

\begin{DoxySeeAlso}{See also}
See \doxylink{structgrid__vars_1_1grid__type}{grid\+\_\+vars.\+grid\+\_\+type} for a discussion on {\ttfamily ang\+\_\+1} and {\ttfamily ang\+\_\+2}.
\end{DoxySeeAlso}
\begin{DoxyNote}{Note}

\begin{DoxyEnumerate}
\item This procedure does not use {\ttfamily n\+\_\+theta\+\_\+plot} and {\ttfamily n\+\_\+zeta\+\_\+plot} from \doxylink{namespacenum__vars}{num\+\_\+vars}, but instead temporarily overwrites them with its own, since it is suposed to be 3-\/D also in the axisymmetric case.
\item The implementation is currently very slow.
\end{DoxyEnumerate}
\end{DoxyNote}
\begin{DoxyReturn}{Returns}
ierr 
\end{DoxyReturn}

\begin{DoxyParams}[1]{Parameters}
\doxymbox{\texttt{in}}  & {\em grid} & fieldline-\/oriented equilibrium grid \\
\hline
\end{DoxyParams}


Definition at line \doxymbox{\hyperlink{grid__ops_8f90_source_l01114}{1114}} of file \doxymbox{\hyperlink{grid__ops_8f90_source}{grid\+\_\+ops.\+f90}}.

Here is the call graph for this function:\+\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacegrid__ops_addd76b7b3be0b51e0863ae0cdfef41e6_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function:\+\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacegrid__ops_addd76b7b3be0b51e0863ae0cdfef41e6_icgraph}
\end{center}
\end{figure}
\Hypertarget{namespacegrid__ops_a4827e794d37334c0cad9bb2016e64d46}\index{grid\_ops@{grid\_ops}!print\_output\_grid@{print\_output\_grid}}
\index{print\_output\_grid@{print\_output\_grid}!grid\_ops@{grid\_ops}}
\doxysubsubsection{\texorpdfstring{print\_output\_grid()}{print\_output\_grid()}}
{\footnotesize\ttfamily \label{namespacegrid__ops_a4827e794d37334c0cad9bb2016e64d46} 
integer function, public grid\+\_\+ops::\+print\+\_\+output\+\_\+grid (\begin{DoxyParamCaption}\item[{type(\doxymbox{\hyperlink{structgrid__vars_1_1grid__type}{grid\+\_\+type}}), intent(in)}]{grid}{, }\item[{character(len=\texorpdfstring{$\ast$}{*}), intent(in)}]{grid\+\_\+name}{, }\item[{character(len=\texorpdfstring{$\ast$}{*}), intent(in)}]{data\+\_\+name}{, }\item[{integer, intent(in), optional}]{rich\+\_\+lvl}{, }\item[{logical, intent(in), optional}]{par\+\_\+div}{, }\item[{logical, intent(in), optional}]{remove\+\_\+previous\+\_\+arrs}{}\end{DoxyParamCaption})}



Print grid variables to an output file. 

If {\ttfamily rich\+\_\+lvl} is provided, {\ttfamily {\itshape R}\+[rich\+\_\+lvl]\+} is appended to the data name if it is \texorpdfstring{$>$}{>} 0.

Optionally, it can be specified that this is a divided parallel grid, corresponding to the variable {\ttfamily eq\+\_\+jobs\+\_\+lims} with index {\ttfamily eq\+\_\+job\+\_\+nr}. In this case, the total grid size is adjusted to the one specified by {\ttfamily eq\+\_\+jobs\+\_\+lims} and the grid is written as a subset.

\begin{DoxyNote}{Note}
{\ttfamily grid\+\_\+} is added in front the data\+\_\+name.
\end{DoxyNote}
\begin{DoxyReturn}{Returns}
ierr 
\end{DoxyReturn}

\begin{DoxyParams}[1]{Parameters}
\doxymbox{\texttt{in}}  & {\em grid} & grid variables \\
\hline
\doxymbox{\texttt{in}}  & {\em grid\+\_\+name} & name to display \\
\hline
\doxymbox{\texttt{in}}  & {\em data\+\_\+name} & name under which to store \\
\hline
\doxymbox{\texttt{in}}  & {\em rich\+\_\+lvl} & Richardson level to reconstruct \\
\hline
\doxymbox{\texttt{in}}  & {\em par\+\_\+div} & is a parallely divided grid \\
\hline
\doxymbox{\texttt{in}}  & {\em remove\+\_\+previous\+\_\+arrs} & remove previous variables if present \\
\hline
\end{DoxyParams}


Definition at line \doxymbox{\hyperlink{grid__ops_8f90_source_l01487}{1487}} of file \doxymbox{\hyperlink{grid__ops_8f90_source}{grid\+\_\+ops.\+f90}}.

Here is the call graph for this function:\+\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacegrid__ops_a4827e794d37334c0cad9bb2016e64d46_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function:\+\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacegrid__ops_a4827e794d37334c0cad9bb2016e64d46_icgraph}
\end{center}
\end{figure}
\Hypertarget{namespacegrid__ops_ab10ef5b486ee3861df2da4e53bc22630}\index{grid\_ops@{grid\_ops}!redistribute\_output\_grid@{redistribute\_output\_grid}}
\index{redistribute\_output\_grid@{redistribute\_output\_grid}!grid\_ops@{grid\_ops}}
\doxysubsubsection{\texorpdfstring{redistribute\_output\_grid()}{redistribute\_output\_grid()}}
{\footnotesize\ttfamily \label{namespacegrid__ops_ab10ef5b486ee3861df2da4e53bc22630} 
integer function, public grid\+\_\+ops::\+redistribute\+\_\+output\+\_\+grid (\begin{DoxyParamCaption}\item[{type(\doxymbox{\hyperlink{structgrid__vars_1_1grid__type}{grid\+\_\+type}}), intent(in)}]{grid}{, }\item[{type(\doxymbox{\hyperlink{structgrid__vars_1_1grid__type}{grid\+\_\+type}}), intent(inout)}]{grid\+\_\+out}{, }\item[{logical, intent(in), optional}]{no\+\_\+outer\+\_\+trim}{}\end{DoxyParamCaption})}



Redistribute a grid to match the normal distribution of solution grid. 

The routine first calculates the smallest eq range that comprises the sol range. Then, it gets the lowest equilibrium limits able to setup an output grid that starts at index 1. After determining the output grid, it then sends the variables to their new processes using MPI.

\begin{DoxyNote}{Note}

\begin{DoxyEnumerate}
\item Only the Flux variables are saved.
\item the redistributed grid has trimmed outer limits, i.\+e. it starts at 1 and ends at the upper limit of the last process. This can be turned off optionally using {\ttfamily no\+\_\+outer\+\_\+trim}.
\end{DoxyEnumerate}
\end{DoxyNote}
\begin{DoxyReturn}{Returns}
ierr 
\end{DoxyReturn}

\begin{DoxyParams}[1]{Parameters}
\doxymbox{\texttt{in}}  & {\em grid} & equilibrium grid variables \\
\hline
\doxymbox{\texttt{in,out}}  & {\em grid\+\_\+out} & redistributed equilibrium grid variables \\
\hline
\doxymbox{\texttt{in}}  & {\em no\+\_\+outer\+\_\+trim} & do not trim the outer limits \\
\hline
\end{DoxyParams}


Definition at line \doxymbox{\hyperlink{grid__ops_8f90_source_l00993}{993}} of file \doxymbox{\hyperlink{grid__ops_8f90_source}{grid\+\_\+ops.\+f90}}.

Here is the call graph for this function:\+\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacegrid__ops_ab10ef5b486ee3861df2da4e53bc22630_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function:\+\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacegrid__ops_ab10ef5b486ee3861df2da4e53bc22630_icgraph}
\end{center}
\end{figure}
\Hypertarget{namespacegrid__ops_af63366847d1caa64a7d329672292fd34}\index{grid\_ops@{grid\_ops}!setup\_grid\_eq@{setup\_grid\_eq}}
\index{setup\_grid\_eq@{setup\_grid\_eq}!grid\_ops@{grid\_ops}}
\doxysubsubsection{\texorpdfstring{setup\_grid\_eq()}{setup\_grid\_eq()}}
{\footnotesize\ttfamily \label{namespacegrid__ops_af63366847d1caa64a7d329672292fd34} 
integer function, public grid\+\_\+ops::\+setup\+\_\+grid\+\_\+eq (\begin{DoxyParamCaption}\item[{type(\doxymbox{\hyperlink{structgrid__vars_1_1grid__type}{grid\+\_\+type}}), intent(inout)}]{grid\+\_\+eq}{, }\item[{integer, dimension(2), intent(in)}]{eq\+\_\+limits}{}\end{DoxyParamCaption})}



Sets up the equilibrium grid. 

The following variables are calculated:\+
\begin{DoxyItemize}
\item equilibrium variables (eq)
\item perturbation variables (X)
\end{DoxyItemize}

For the implementation of the equilibrium grid the normal part of the grid is always given by the output of the equilibrium code, but the angular part depends on the style:\+
\begin{DoxyItemize}
\item VMEC:\+ The output is analytic in the angular coordinates, so field-\/aligned coordinates are used. Later, in \doxylink{namespacegrid__ops_a06107dbdfd1dd62e372cc29ab0255bad}{calc\+\_\+ang\+\_\+grid\+\_\+eq\+\_\+b()}, the angular variables are calculated.
\item HELENA:\+ The output is given on a poloidal grid (no toroidal dependency due to axisymmetry), which is used.
\end{DoxyItemize}

\begin{DoxyReturn}{Returns}
ierr 
\end{DoxyReturn}

\begin{DoxyParams}[1]{Parameters}
\doxymbox{\texttt{in,out}}  & {\em grid\+\_\+eq} & equilibrium grid \\
\hline
\doxymbox{\texttt{in}}  & {\em eq\+\_\+limits} & min. and max. index of eq grid of this process \\
\hline
\end{DoxyParams}


Definition at line \doxymbox{\hyperlink{grid__ops_8f90_source_l00528}{528}} of file \doxymbox{\hyperlink{grid__ops_8f90_source}{grid\+\_\+ops.\+f90}}.

Here is the call graph for this function:\+\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacegrid__ops_af63366847d1caa64a7d329672292fd34_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function:\+\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacegrid__ops_af63366847d1caa64a7d329672292fd34_icgraph}
\end{center}
\end{figure}
\Hypertarget{namespacegrid__ops_addd35a4585f818ae0a7d94ee2156f1bd}\index{grid\_ops@{grid\_ops}!setup\_grid\_eq\_b@{setup\_grid\_eq\_b}}
\index{setup\_grid\_eq\_b@{setup\_grid\_eq\_b}!grid\_ops@{grid\_ops}}
\doxysubsubsection{\texorpdfstring{setup\_grid\_eq\_b()}{setup\_grid\_eq\_b()}}
{\footnotesize\ttfamily \label{namespacegrid__ops_addd35a4585f818ae0a7d94ee2156f1bd} 
integer function, public grid\+\_\+ops::\+setup\+\_\+grid\+\_\+eq\+\_\+b (\begin{DoxyParamCaption}\item[{type(\doxymbox{\hyperlink{structgrid__vars_1_1grid__type}{grid\+\_\+type}}), intent(inout)}]{grid\+\_\+eq}{, }\item[{type(\doxymbox{\hyperlink{structgrid__vars_1_1grid__type}{grid\+\_\+type}}), intent(inout)}]{grid\+\_\+eq\+\_\+b}{, }\item[{type(\doxymbox{\hyperlink{structeq__vars_1_1eq__1__type}{eq\+\_\+1\+\_\+type}}), intent(in)}]{eq}{, }\item[{logical, intent(in), optional}]{only\+\_\+half\+\_\+grid}{}\end{DoxyParamCaption})}



Sets up the field-\/aligned equilibrium grid. 

This serves as a bridge to the solution grid, as it contains the same normal coordinate as the general grid, but the angular coordinates are defined by the solution grid.

Optionally, only half the grid can be calculated (i.\+e. only the even points), which is used for Richardson levels greater than 1.

\begin{DoxyNote}{Note}
In contrast to {\ttfamily setup\+\_\+grid\+\_\+eq}, the angular coordinates are also calculated here.
\end{DoxyNote}
\begin{DoxyReturn}{Returns}
ierr 
\end{DoxyReturn}

\begin{DoxyParams}[1]{Parameters}
\doxymbox{\texttt{in,out}}  & {\em grid\+\_\+eq} & general equilibrium grid \\
\hline
\doxymbox{\texttt{in,out}}  & {\em grid\+\_\+eq\+\_\+b} & field-\/aligned equilibrium grid \\
\hline
\doxymbox{\texttt{in}}  & {\em eq} & flux equilibrium variables \\
\hline
\doxymbox{\texttt{in}}  & {\em only\+\_\+half\+\_\+grid} & calculate only half grid with even points \\
\hline
\end{DoxyParams}


Definition at line \doxymbox{\hyperlink{grid__ops_8f90_source_l00599}{599}} of file \doxymbox{\hyperlink{grid__ops_8f90_source}{grid\+\_\+ops.\+f90}}.

Here is the call graph for this function:\+\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacegrid__ops_addd35a4585f818ae0a7d94ee2156f1bd_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function:\+\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacegrid__ops_addd35a4585f818ae0a7d94ee2156f1bd_icgraph}
\end{center}
\end{figure}
\Hypertarget{namespacegrid__ops_acb93d3ad89ab0efeff8c1b31ff77cec1}\index{grid\_ops@{grid\_ops}!setup\_grid\_sol@{setup\_grid\_sol}}
\index{setup\_grid\_sol@{setup\_grid\_sol}!grid\_ops@{grid\_ops}}
\doxysubsubsection{\texorpdfstring{setup\_grid\_sol()}{setup\_grid\_sol()}}
{\footnotesize\ttfamily \label{namespacegrid__ops_acb93d3ad89ab0efeff8c1b31ff77cec1} 
integer function, public grid\+\_\+ops::\+setup\+\_\+grid\+\_\+sol (\begin{DoxyParamCaption}\item[{type(\doxymbox{\hyperlink{structgrid__vars_1_1grid__type}{grid\+\_\+type}}), intent(in)}]{grid\+\_\+eq}{, }\item[{type(\doxymbox{\hyperlink{structgrid__vars_1_1grid__type}{grid\+\_\+type}}), intent(in)}]{grid\+\_\+x}{, }\item[{type(\doxymbox{\hyperlink{structgrid__vars_1_1grid__type}{grid\+\_\+type}}), intent(inout)}]{grid\+\_\+sol}{, }\item[{real(dp), dimension(:\+), intent(in)}]{r\+\_\+f\+\_\+sol}{, }\item[{integer, dimension(2), intent(in)}]{sol\+\_\+limits}{}\end{DoxyParamCaption})}



Sets up the general solution grid, in which the solution variables are calculated. 

For the solution grid, only one parallel point is used, but possibly multiple geodesic points, equal to the number of field lines, {\ttfamily n\+\_\+alpha}.

\begin{DoxyReturn}{Returns}
ierr 
\end{DoxyReturn}

\begin{DoxyParams}[1]{Parameters}
\doxymbox{\texttt{in}}  & {\em grid\+\_\+eq} & equilibrium grid \\
\hline
\doxymbox{\texttt{in}}  & {\em grid\+\_\+x} & perturbation grid \\
\hline
\doxymbox{\texttt{in,out}}  & {\em grid\+\_\+sol} & solution grid \\
\hline
\doxymbox{\texttt{in}}  & {\em r\+\_\+f\+\_\+sol} & points of solution grid \\
\hline
\doxymbox{\texttt{in}}  & {\em sol\+\_\+limits} & min. and max. index of sol grid of this process \\
\hline
\end{DoxyParams}


Definition at line \doxymbox{\hyperlink{grid__ops_8f90_source_l00726}{726}} of file \doxymbox{\hyperlink{grid__ops_8f90_source}{grid\+\_\+ops.\+f90}}.

Here is the call graph for this function:\+\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacegrid__ops_acb93d3ad89ab0efeff8c1b31ff77cec1_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function:\+\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacegrid__ops_acb93d3ad89ab0efeff8c1b31ff77cec1_icgraph}
\end{center}
\end{figure}
\Hypertarget{namespacegrid__ops_affff458bc90352a94138e63b4a0feebe}\index{grid\_ops@{grid\_ops}!setup\_grid\_x@{setup\_grid\_x}}
\index{setup\_grid\_x@{setup\_grid\_x}!grid\_ops@{grid\_ops}}
\doxysubsubsection{\texorpdfstring{setup\_grid\_x()}{setup\_grid\_x()}}
{\footnotesize\ttfamily \label{namespacegrid__ops_affff458bc90352a94138e63b4a0feebe} 
integer function, public grid\+\_\+ops::\+setup\+\_\+grid\+\_\+x (\begin{DoxyParamCaption}\item[{type(\doxymbox{\hyperlink{structgrid__vars_1_1grid__type}{grid\+\_\+type}}), intent(in)}]{grid\+\_\+eq}{, }\item[{type(\doxymbox{\hyperlink{structgrid__vars_1_1grid__type}{grid\+\_\+type}}), intent(inout)}]{grid\+\_\+x}{, }\item[{real(dp), dimension(:\+), intent(in), allocatable}]{r\+\_\+f\+\_\+x}{, }\item[{integer, dimension(2), intent(in)}]{x\+\_\+limits}{}\end{DoxyParamCaption})}



Sets up the general perturbation grid, in which the perturbation variables are calculated. 

For {\ttfamily X\+\_\+grid\+\_\+style} 1, this grid is identical to the equilibrium grid, and for {\ttfamily X\+\_\+grid\+\_\+style} 2,it has the same angular extent but with different normal points, indicated by the variable {\ttfamily r\+\_\+\+F\+\_\+X}.

\begin{DoxyReturn}{Returns}
ierr 
\end{DoxyReturn}

\begin{DoxyParams}[1]{Parameters}
\doxymbox{\texttt{in}}  & {\em grid\+\_\+eq} & equilibrium grid \\
\hline
\doxymbox{\texttt{in,out}}  & {\em grid\+\_\+x} & perturbation grid \\
\hline
\doxymbox{\texttt{in}}  & {\em r\+\_\+f\+\_\+x} & points of perturbation grid \\
\hline
\doxymbox{\texttt{in}}  & {\em x\+\_\+limits} & min. and max. index of perturbation grid of this process \\
\hline
\end{DoxyParams}


Definition at line \doxymbox{\hyperlink{grid__ops_8f90_source_l00654}{654}} of file \doxymbox{\hyperlink{grid__ops_8f90_source}{grid\+\_\+ops.\+f90}}.

Here is the caller graph for this function:\+\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacegrid__ops_affff458bc90352a94138e63b4a0feebe_icgraph}
\end{center}
\end{figure}


\label{doc-var-members}
\Hypertarget{namespacegrid__ops_doc-var-members}
\doxysubsection{Variable Documentation}
\Hypertarget{namespacegrid__ops_ad043ab1b07b2d251bb7596b8c8d2f960}\index{grid\_ops@{grid\_ops}!debug\_calc\_ang\_grid\_eq\_b@{debug\_calc\_ang\_grid\_eq\_b}}
\index{debug\_calc\_ang\_grid\_eq\_b@{debug\_calc\_ang\_grid\_eq\_b}!grid\_ops@{grid\_ops}}
\doxysubsubsection{\texorpdfstring{debug\_calc\_ang\_grid\_eq\_b}{debug\_calc\_ang\_grid\_eq\_b}}
{\footnotesize\ttfamily \label{namespacegrid__ops_ad043ab1b07b2d251bb7596b8c8d2f960} 
logical, public grid\+\_\+ops::\+debug\+\_\+calc\+\_\+ang\+\_\+grid\+\_\+eq\+\_\+b = .false.}



plot debug information for \doxylink{namespacegrid__ops_a06107dbdfd1dd62e372cc29ab0255bad}{calc\+\_\+ang\+\_\+grid\+\_\+eq\+\_\+b()} 

\begin{DoxyNote}{Note}
Debug version only 
\end{DoxyNote}


Definition at line \doxymbox{\hyperlink{grid__ops_8f90_source_l00025}{25}} of file \doxymbox{\hyperlink{grid__ops_8f90_source}{grid\+\_\+ops.\+f90}}.

