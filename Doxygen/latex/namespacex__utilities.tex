\doxysection{x\+\_\+utilities Module Reference}
\hypertarget{namespacex__utilities}{}\label{namespacex__utilities}\index{x\_utilities@{x\_utilities}}


Numerical utilities related to perturbation operations.  


\doxysubsubsection*{Interfaces and Types}
\begin{DoxyCompactItemize}
\item 
interface \doxymbox{\hyperlink{interfacex__utilities_1_1sec__ind__loc2tot}{sec\+\_\+ind\+\_\+loc2tot}}
\begin{DoxyCompactList}\small\item\em Returns the {\ttfamily sec\+\_\+ind\+\_\+tot} used to refer to a perturbation quantity. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Functions/\+\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine, public \doxymbox{\hyperlink{namespacex__utilities_a5d3e0cc44d78b9c18e93ee5457a49bb5}{get\+\_\+sec\+\_\+x\+\_\+range}} (sec\+\_\+x\+\_\+range\+\_\+loc, sec\+\_\+x\+\_\+range\+\_\+tot, m, sym, lim\+\_\+sec\+\_\+x)
\begin{DoxyCompactList}\small\item\em Gets one of the the local ranges of contiguous tensorial perturbation variables to be printed or read during one call of the corresponding HDF5 variables. \end{DoxyCompactList}\item 
logical function, public \doxymbox{\hyperlink{namespacex__utilities_adef8eab82f0fd670a7795c754cf9a8f9}{do\+\_\+x}} ()
\begin{DoxyCompactList}\small\item\em Tests whether this perturbatino job should be done. \end{DoxyCompactList}\item 
logical function, public \doxymbox{\hyperlink{namespacex__utilities_a6bb9570c66954d37a27f04f12fa65cc9}{is\+\_\+necessary\+\_\+x}} (sym, sec\+\_\+x\+\_\+id, lim\+\_\+sec\+\_\+x)
\begin{DoxyCompactList}\small\item\em Determines whether a variable needs to be considered:\+ \end{DoxyCompactList}\item 
integer function, public \doxymbox{\hyperlink{namespacex__utilities_a4d18921da77463d069346f1c7322b451}{calc\+\_\+memory\+\_\+x}} (ord, arr\+\_\+size, n\+\_\+mod, mem\+\_\+size)
\begin{DoxyCompactList}\small\item\em Calculate memory in MB necessary for X variables. \end{DoxyCompactList}\item 
integer function, public \doxymbox{\hyperlink{namespacex__utilities_afde797341c5056abecc7a9221dbd345e}{trim\+\_\+modes}} (mds\+\_\+i, mds\+\_\+o, id\+\_\+lim\+\_\+i, id\+\_\+lim\+\_\+o)
\begin{DoxyCompactList}\small\item\em Limit input mode range to output mode range. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Numerical utilities related to perturbation operations. 

\label{doc-func-members}
\Hypertarget{namespacex__utilities_doc-func-members}
\doxysubsection{Function/\+\+Subroutine Documentation}
\Hypertarget{namespacex__utilities_a4d18921da77463d069346f1c7322b451}\index{x\_utilities@{x\_utilities}!calc\_memory\_x@{calc\_memory\_x}}
\index{calc\_memory\_x@{calc\_memory\_x}!x\_utilities@{x\_utilities}}
\doxysubsubsection{\texorpdfstring{calc\_memory\_x()}{calc\_memory\_x()}}
{\footnotesize\ttfamily \label{namespacex__utilities_a4d18921da77463d069346f1c7322b451} 
integer function, public x\+\_\+utilities::\+calc\+\_\+memory\+\_\+x (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{ord}{, }\item[{integer, intent(in)}]{arr\+\_\+size}{, }\item[{integer, intent(in)}]{n\+\_\+mod}{, }\item[{real(dp), intent(inout)}]{mem\+\_\+size}{}\end{DoxyParamCaption})}



Calculate memory in MB necessary for X variables. 

This depends on the order:\+
\begin{DoxyItemize}
\item order 1:\+
\begin{DoxyItemize}
\item {\ttfamily 4x n\+\_\+par\+\_\+X x n\+\_\+geo x loc\+\_\+n\+\_\+r x n\+\_\+mod}
\end{DoxyItemize}
\item order 2:\+
\begin{DoxyItemize}
\item {\ttfamily 2x n\+\_\+par\+\_\+X x n\+\_\+geo x loc\+\_\+n\+\_\+r x n\+\_\+mod\texorpdfstring{$^\wedge$}{\string^}2}
\item {\ttfamily 4x n\+\_\+par\+\_\+X x n\+\_\+geo x loc\+\_\+n\+\_\+r x n\+\_\+mod(n\+\_\+mod+1)/\+2}
\end{DoxyItemize}
\item higher order:\+ not used
\end{DoxyItemize}

where {\ttfamily n\+\_\+par\+\_\+X x n\+\_\+geo x loc\+\_\+n\+\_\+r} should be passed as {\ttfamily arr\+\_\+size} and {\ttfamily n\+\_\+mod} as well.

\begin{DoxyReturn}{Returns}
ierr 
\end{DoxyReturn}

\begin{DoxyParams}[1]{Parameters}
\doxymbox{\texttt{in}}  & {\em ord} & order of data \\
\hline
\doxymbox{\texttt{in}}  & {\em arr\+\_\+size} & size of part of X array \\
\hline
\doxymbox{\texttt{in}}  & {\em n\+\_\+mod} & number of modes \\
\hline
\doxymbox{\texttt{in,out}}  & {\em mem\+\_\+size} & total size \\
\hline
\end{DoxyParams}


Definition at line \doxymbox{\hyperlink{X__utilities_8f90_source_l00235}{235}} of file \doxymbox{\hyperlink{X__utilities_8f90_source}{X\+\_\+utilities.\+f90}}.

Here is the call graph for this function:\+\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacex__utilities_a4d18921da77463d069346f1c7322b451_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function:\+\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacex__utilities_a4d18921da77463d069346f1c7322b451_icgraph}
\end{center}
\end{figure}
\Hypertarget{namespacex__utilities_adef8eab82f0fd670a7795c754cf9a8f9}\index{x\_utilities@{x\_utilities}!do\_x@{do\_x}}
\index{do\_x@{do\_x}!x\_utilities@{x\_utilities}}
\doxysubsubsection{\texorpdfstring{do\_x()}{do\_x()}}
{\footnotesize\ttfamily \label{namespacex__utilities_adef8eab82f0fd670a7795c754cf9a8f9} 
logical function, public x\+\_\+utilities::\+do\+\_\+x}



Tests whether this perturbatino job should be done. 

Also increments {\ttfamily X\+\_\+job\+\_\+nr} 

Definition at line \doxymbox{\hyperlink{X__utilities_8f90_source_l00178}{178}} of file \doxymbox{\hyperlink{X__utilities_8f90_source}{X\+\_\+utilities.\+f90}}.

Here is the call graph for this function:\+\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=198pt]{namespacex__utilities_adef8eab82f0fd670a7795c754cf9a8f9_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function:\+\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacex__utilities_adef8eab82f0fd670a7795c754cf9a8f9_icgraph}
\end{center}
\end{figure}
\Hypertarget{namespacex__utilities_a5d3e0cc44d78b9c18e93ee5457a49bb5}\index{x\_utilities@{x\_utilities}!get\_sec\_x\_range@{get\_sec\_x\_range}}
\index{get\_sec\_x\_range@{get\_sec\_x\_range}!x\_utilities@{x\_utilities}}
\doxysubsubsection{\texorpdfstring{get\_sec\_x\_range()}{get\_sec\_x\_range()}}
{\footnotesize\ttfamily \label{namespacex__utilities_a5d3e0cc44d78b9c18e93ee5457a49bb5} 
subroutine, public x\+\_\+utilities::\+get\+\_\+sec\+\_\+x\+\_\+range (\begin{DoxyParamCaption}\item[{integer, dimension(2), intent(inout)}]{sec\+\_\+x\+\_\+range\+\_\+loc}{, }\item[{integer, dimension(2), intent(inout)}]{sec\+\_\+x\+\_\+range\+\_\+tot}{, }\item[{integer, intent(in)}]{m}{, }\item[{logical, intent(in)}]{sym}{, }\item[{integer, dimension(2,2), intent(in), optional}]{lim\+\_\+sec\+\_\+x}{}\end{DoxyParamCaption})}



Gets one of the the local ranges of contiguous tensorial perturbation variables to be printed or read during one call of the corresponding HDF5 variables. 

More specifically, a range of indices {\ttfamily k} in the first dimension is given for every value of the indices {\ttfamily m} in the second dimension.

An example is now given for the subrange {\ttfamily \+[2:\+3,2:\+5]\+} of a the total range {\ttfamily \+[1:\+5, 1:\+5]\+}. For asymmetric variables the situation is simple:\+ The {\ttfamily k} range is {\ttfamily \+[2:\+3]\+} for all 5 values of {\ttfamily m}. However, for symmetric variables, the upper diagonal values are not stored, which gives {\ttfamily k} ranges {\ttfamily \+[2:\+3]\+}, {\ttfamily \+[3:\+3]\+} and no range for {\ttfamily m} = 4 and 5.

This routine then translates these ranges to the corresponding 1-\/D ranges that are used in the actual variables. For above example, the total indices are           \[             \left(\begin{array}{ccccc}
                 1 &  6 & 11 & 16 & 21 \\
                 2 &  7 & 12 & 17 & 22 \\
                 3 &  8 & 13 & 18 & 23 \\
                 4 &  9 & 14 & 19 & 24 \\
                 5 & 10 & 15 & 20 & 25
             \end{array}\right)
             \rightarrow \left[7:8\right], \left[12:13\right],
             \left[17:18\right] \ \text{and} \ \left[22:23\right],
\] for asymmetric variables and           \[             \left(\begin{array}{ccccc}
                 1 & 2 &  3 &  4 &  5 \\
                 2 & 6 &  7 &  8 &  9 \\
                 3 & 7 & 10 & 11 & 12 \\
                 4 & 8 & 11 & 13 & 14 \\
                 5 & 9 & 12 & 14 & 15
             \end{array}\right)
             \rightarrow \left[6:7\right], \left[10:10\right],
             \left[:\right] \ \text{and} \ \left[:\right],
\] for symmetric variables.

These can then related to the local indices for the variables in this perturbation job.

For above example, the results are:\+

{\ttfamily \+[1:\+2]\+, \+[3:\+4]\+, \+[5:\+6]\+ and \+[7:\+8]\+},

for asymmetric variables and

{\ttfamily \+[1:\+2]\+, \+[3:\+3]\+, \+[:\+]\+ and \+[:\+]\+},

for symmetric variables.

As can be seen, the local ranges of the variables in the submatrix of this perturbation job are (designed to be) contiguous, but the total ranges of the variables in the submatrix are clearly not in general.

The procedure outputs both the local and total ranges. 
\begin{DoxyParams}[1]{Parameters}
\doxymbox{\texttt{in,out}}  & {\em sec\+\_\+x\+\_\+range\+\_\+loc} & start and end of local range in dimension 1 (vertical) \\
\hline
\doxymbox{\texttt{in,out}}  & {\em sec\+\_\+x\+\_\+range\+\_\+tot} & start and end of total range in dimension 1 (vertical) \\
\hline
\doxymbox{\texttt{in}}  & {\em m} & dimension 2 (horizontal) \\
\hline
\doxymbox{\texttt{in}}  & {\em sym} & whether the variable is symmetric \\
\hline
\doxymbox{\texttt{in}}  & {\em lim\+\_\+sec\+\_\+x} & limits of {\ttfamily m\+\_\+X} (pol. flux) or {\ttfamily n\+\_\+X} (tor. flux) \\
\hline
\end{DoxyParams}


Definition at line \doxymbox{\hyperlink{X__utilities_8f90_source_l00127}{127}} of file \doxymbox{\hyperlink{X__utilities_8f90_source}{X\+\_\+utilities.\+f90}}.

Here is the call graph for this function:\+\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacex__utilities_a5d3e0cc44d78b9c18e93ee5457a49bb5_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function:\+\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacex__utilities_a5d3e0cc44d78b9c18e93ee5457a49bb5_icgraph}
\end{center}
\end{figure}
\Hypertarget{namespacex__utilities_a6bb9570c66954d37a27f04f12fa65cc9}\index{x\_utilities@{x\_utilities}!is\_necessary\_x@{is\_necessary\_x}}
\index{is\_necessary\_x@{is\_necessary\_x}!x\_utilities@{x\_utilities}}
\doxysubsubsection{\texorpdfstring{is\_necessary\_x()}{is\_necessary\_x()}}
{\footnotesize\ttfamily \label{namespacex__utilities_a6bb9570c66954d37a27f04f12fa65cc9} 
logical function, public x\+\_\+utilities::\+is\+\_\+necessary\+\_\+x (\begin{DoxyParamCaption}\item[{logical, intent(in)}]{sym}{, }\item[{integer, dimension(2), intent(in)}]{sec\+\_\+x\+\_\+id}{, }\item[{integer, dimension(2,2), intent(in), optional}]{lim\+\_\+sec\+\_\+x}{}\end{DoxyParamCaption})}



Determines whether a variable needs to be considered:\+ 

This depends on whether the quantity is symmetric or not:\+
\begin{DoxyItemize}
\item Only if it is on or below the diagonal for symmetric quantities.
\item Always for asymmetric quantities 
\begin{DoxyParams}[1]{Parameters}
\doxymbox{\texttt{in}}  & {\em sym} & whether the variable is symmetric \\
\hline
\doxymbox{\texttt{in}}  & {\em sec\+\_\+x\+\_\+id} & mode indices \\
\hline
\doxymbox{\texttt{in}}  & {\em lim\+\_\+sec\+\_\+x} & limits of {\ttfamily m\+\_\+X} (pol flux) or {\ttfamily n\+\_\+X} (tor flux) for both dimensions \\
\hline
\end{DoxyParams}

\end{DoxyItemize}

Definition at line \doxymbox{\hyperlink{X__utilities_8f90_source_l00196}{196}} of file \doxymbox{\hyperlink{X__utilities_8f90_source}{X\+\_\+utilities.\+f90}}.

Here is the caller graph for this function:\+\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacex__utilities_a6bb9570c66954d37a27f04f12fa65cc9_icgraph}
\end{center}
\end{figure}
\Hypertarget{namespacex__utilities_afde797341c5056abecc7a9221dbd345e}\index{x\_utilities@{x\_utilities}!trim\_modes@{trim\_modes}}
\index{trim\_modes@{trim\_modes}!x\_utilities@{x\_utilities}}
\doxysubsubsection{\texorpdfstring{trim\_modes()}{trim\_modes()}}
{\footnotesize\ttfamily \label{namespacex__utilities_afde797341c5056abecc7a9221dbd345e} 
integer function, public x\+\_\+utilities::\+trim\+\_\+modes (\begin{DoxyParamCaption}\item[{type(\doxymbox{\hyperlink{structx__vars_1_1modes__type}{modes\+\_\+type}}), intent(in)}]{mds\+\_\+i}{, }\item[{type(\doxymbox{\hyperlink{structx__vars_1_1modes__type}{modes\+\_\+type}}), intent(in)}]{mds\+\_\+o}{, }\item[{integer, dimension(2), intent(inout)}]{id\+\_\+lim\+\_\+i}{, }\item[{integer, dimension(2), intent(inout)}]{id\+\_\+lim\+\_\+o}{}\end{DoxyParamCaption})}



Limit input mode range to output mode range. 


\begin{DoxyParams}[1]{Parameters}
\doxymbox{\texttt{in}}  & {\em mds\+\_\+i} & general modes variables for input \\
\hline
\doxymbox{\texttt{in}}  & {\em mds\+\_\+o} & general modes variables for output \\
\hline
\doxymbox{\texttt{in,out}}  & {\em id\+\_\+lim\+\_\+i} & limits on input modes \\
\hline
\doxymbox{\texttt{in,out}}  & {\em id\+\_\+lim\+\_\+o} & limits on output modes \\
\hline
\end{DoxyParams}


Definition at line \doxymbox{\hyperlink{X__utilities_8f90_source_l00292}{292}} of file \doxymbox{\hyperlink{X__utilities_8f90_source}{X\+\_\+utilities.\+f90}}.

Here is the caller graph for this function:\+\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacex__utilities_afde797341c5056abecc7a9221dbd345e_icgraph}
\end{center}
\end{figure}
