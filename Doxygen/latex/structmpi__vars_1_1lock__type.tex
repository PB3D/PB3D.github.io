\doxysection{mpi\+\_\+vars::\+lock\+\_\+type Type Reference}
\hypertarget{structmpi__vars_1_1lock__type}{}\label{structmpi__vars_1_1lock__type}\index{mpi\_vars::lock\_type@{mpi\_vars::lock\_type}}


lock type  


\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
procedure \doxymbox{\hyperlink{structmpi__vars_1_1lock__type_a6227b4a9250ac98f66bb365d0f86cf5b}{init}} (lock\+\_\+loc, \doxymbox{\hyperlink{structmpi__vars_1_1lock__type_ae13a02ff3985d06c3455b2ae29210cc4}{wu\+\_\+tag}})
\begin{DoxyCompactList}\small\item\em initialize \end{DoxyCompactList}\item 
procedure \doxymbox{\hyperlink{structmpi__vars_1_1lock__type_a2c029c67853e6ab25916cb422de22b85}{dealloc}} (lock\+\_\+loc)
\begin{DoxyCompactList}\small\item\em deallocate \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
integer, dimension(:\+), allocatable \doxymbox{\hyperlink{structmpi__vars_1_1lock__type_a1bc45d5db890c080c843318662050565}{wl}}
\begin{DoxyCompactList}\small\item\em waiting list \end{DoxyCompactList}\item 
integer \doxymbox{\hyperlink{structmpi__vars_1_1lock__type_a19ac8404814735597e92c647e31745ad}{wl\+\_\+win}}
\begin{DoxyCompactList}\small\item\em window to waiting list \end{DoxyCompactList}\item 
integer \doxymbox{\hyperlink{structmpi__vars_1_1lock__type_ae13a02ff3985d06c3455b2ae29210cc4}{wu\+\_\+tag}}
\begin{DoxyCompactList}\small\item\em wakeup tag \end{DoxyCompactList}\item 
logical \doxymbox{\hyperlink{structmpi__vars_1_1lock__type_a53ce091d52f98ca430a9e97f8bf0c0f4}{blocking}}
\begin{DoxyCompactList}\small\item\em is a normal blocking process \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
lock type 

There is a blocking (BL) and a nonblocking (NB) version where the former requires an exclusive lock and the latter a shared one. This is saved in the variable {\ttfamily blocking}.

NB processes that get the lock directly on request (meaning that there were no other processes in the queue) notify directly all the next NB processes after gaining access. It also sets their status to active. When a NB process gains the lock when notified after waiting, it does not have to check for other NB processes, as this has been done by the notifying process.

A BL process retains exclusive access upon receipt of the lock. Similarly to NB processes, if the receipt was direct on request, the status is set to active, but only of this NB process.

When returning the lock, all BL processes and NB that find themselves to be the last active NB process, scan the waiting list and pass the lock preferably to another BL process to notify. If not available, it searches for all the NB processes to notify together.

The advantage of prefering BL processes after finishing a process is that this way NB processes are accumulated, and then quickly finished afterwards.

\begin{DoxyNote}{Note}
Every process in the waiting queue will eventually receive a notification.
\end{DoxyNote}
Scheme:\+ 
\begin{DoxyTable}{4}{}{}{1}
\SetCell{bg=\tableheadbgcolor,font=\bfseries}&\SetCell{bg=\tableheadbgcolor,font=\bfseries}request access &\SetCell{bg=\tableheadbgcolor,font=\bfseries}gain acces &\SetCell{bg=\tableheadbgcolor,font=\bfseries}return access \\
\SetCell{bg=\tableheadbgcolor,font=\bfseries}BL &
\begin{DoxyItemize}
\item add to queue 
\item wait 
\end{DoxyItemize}&if direct:\+ 
\begin{DoxyItemize}
\item activate 
\end{DoxyItemize}&
\begin{DoxyItemize}
\item remove from queue 
\item find next BL/\+\+NB 
\item notify 
\item activate all 
\end{DoxyItemize}\\
\SetCell{bg=\tableheadbgcolor,font=\bfseries}NB &
\begin{DoxyItemize}
\item add to queue 
\item wait 
\end{DoxyItemize}&if direct:\+ 
\begin{DoxyItemize}
\item find next NB 
\end{DoxyItemize}for all next NB:\+ 
\begin{DoxyItemize}
\item notify 
\item activate 
\end{DoxyItemize}&always:\+ 
\begin{DoxyItemize}
\item remove from queue 
\end{DoxyItemize}if last NB:\+ 
\begin{DoxyItemize}
\item find next BL/\+\+NB 
\item notify 
\item activate all 
\end{DoxyItemize}\\
\end{DoxyTable}
with preference BL \texorpdfstring{$>$}{>} NB(s).

\begin{DoxySeeAlso}{See also}
This is based on an extension of the ideas in {\ttfamily Ross\+Atomic\+IO}. 
\end{DoxySeeAlso}


Definition at line \doxymbox{\hyperlink{MPI__vars_8f90_source_l00063}{63}} of file \doxymbox{\hyperlink{MPI__vars_8f90_source}{MPI\+\_\+vars.\+f90}}.



\label{doc-func-members}
\Hypertarget{structmpi__vars_1_1lock__type_doc-func-members}
\doxysubsection{Member Function/\+\+Subroutine Documentation}
\Hypertarget{structmpi__vars_1_1lock__type_a2c029c67853e6ab25916cb422de22b85}\index{mpi\_vars::lock\_type@{mpi\_vars::lock\_type}!dealloc@{dealloc}}
\index{dealloc@{dealloc}!mpi\_vars::lock\_type@{mpi\_vars::lock\_type}}
\doxysubsubsection{\texorpdfstring{dealloc()}{dealloc()}}
{\footnotesize\ttfamily \label{structmpi__vars_1_1lock__type_a2c029c67853e6ab25916cb422de22b85} 
procedure mpi\+\_\+vars::\+lock\+\_\+type::\+dealloc (\begin{DoxyParamCaption}\item[{class(\doxymbox{\hyperlink{structmpi__vars_1_1lock__type}{lock\+\_\+type}}), intent(inout)}]{lock\+\_\+loc}{}\end{DoxyParamCaption})}



deallocate 

deallocate 

Definition at line \doxymbox{\hyperlink{MPI__vars_8f90_source_l00072}{72}} of file \doxymbox{\hyperlink{MPI__vars_8f90_source}{MPI\+\_\+vars.\+f90}}.

\Hypertarget{structmpi__vars_1_1lock__type_a6227b4a9250ac98f66bb365d0f86cf5b}\index{mpi\_vars::lock\_type@{mpi\_vars::lock\_type}!init@{init}}
\index{init@{init}!mpi\_vars::lock\_type@{mpi\_vars::lock\_type}}
\doxysubsubsection{\texorpdfstring{init()}{init()}}
{\footnotesize\ttfamily \label{structmpi__vars_1_1lock__type_a6227b4a9250ac98f66bb365d0f86cf5b} 
procedure mpi\+\_\+vars::\+lock\+\_\+type::\+init (\begin{DoxyParamCaption}\item[{class(\doxymbox{\hyperlink{structmpi__vars_1_1lock__type}{lock\+\_\+type}}), intent(inout)}]{lock\+\_\+loc}{, }\item[{integer, intent(in)}]{wu\+\_\+tag}{}\end{DoxyParamCaption})}



initialize 

initialize 

Definition at line \doxymbox{\hyperlink{MPI__vars_8f90_source_l00070}{70}} of file \doxymbox{\hyperlink{MPI__vars_8f90_source}{MPI\+\_\+vars.\+f90}}.



\label{doc-variable-members}
\Hypertarget{structmpi__vars_1_1lock__type_doc-variable-members}
\doxysubsection{Member Data Documentation}
\Hypertarget{structmpi__vars_1_1lock__type_a53ce091d52f98ca430a9e97f8bf0c0f4}\index{mpi\_vars::lock\_type@{mpi\_vars::lock\_type}!blocking@{blocking}}
\index{blocking@{blocking}!mpi\_vars::lock\_type@{mpi\_vars::lock\_type}}
\doxysubsubsection{\texorpdfstring{blocking}{blocking}}
{\footnotesize\ttfamily \label{structmpi__vars_1_1lock__type_a53ce091d52f98ca430a9e97f8bf0c0f4} 
logical mpi\+\_\+vars::\+lock\+\_\+type::\+blocking}



is a normal blocking process 



Definition at line \doxymbox{\hyperlink{MPI__vars_8f90_source_l00067}{67}} of file \doxymbox{\hyperlink{MPI__vars_8f90_source}{MPI\+\_\+vars.\+f90}}.

\Hypertarget{structmpi__vars_1_1lock__type_a1bc45d5db890c080c843318662050565}\index{mpi\_vars::lock\_type@{mpi\_vars::lock\_type}!wl@{wl}}
\index{wl@{wl}!mpi\_vars::lock\_type@{mpi\_vars::lock\_type}}
\doxysubsubsection{\texorpdfstring{wl}{wl}}
{\footnotesize\ttfamily \label{structmpi__vars_1_1lock__type_a1bc45d5db890c080c843318662050565} 
integer, dimension(:\+), allocatable mpi\+\_\+vars::\+lock\+\_\+type::\+wl}



waiting list 



Definition at line \doxymbox{\hyperlink{MPI__vars_8f90_source_l00064}{64}} of file \doxymbox{\hyperlink{MPI__vars_8f90_source}{MPI\+\_\+vars.\+f90}}.

\Hypertarget{structmpi__vars_1_1lock__type_a19ac8404814735597e92c647e31745ad}\index{mpi\_vars::lock\_type@{mpi\_vars::lock\_type}!wl\_win@{wl\_win}}
\index{wl\_win@{wl\_win}!mpi\_vars::lock\_type@{mpi\_vars::lock\_type}}
\doxysubsubsection{\texorpdfstring{wl\_win}{wl\_win}}
{\footnotesize\ttfamily \label{structmpi__vars_1_1lock__type_a19ac8404814735597e92c647e31745ad} 
integer mpi\+\_\+vars::\+lock\+\_\+type::\+wl\+\_\+win}



window to waiting list 



Definition at line \doxymbox{\hyperlink{MPI__vars_8f90_source_l00065}{65}} of file \doxymbox{\hyperlink{MPI__vars_8f90_source}{MPI\+\_\+vars.\+f90}}.

\Hypertarget{structmpi__vars_1_1lock__type_ae13a02ff3985d06c3455b2ae29210cc4}\index{mpi\_vars::lock\_type@{mpi\_vars::lock\_type}!wu\_tag@{wu\_tag}}
\index{wu\_tag@{wu\_tag}!mpi\_vars::lock\_type@{mpi\_vars::lock\_type}}
\doxysubsubsection{\texorpdfstring{wu\_tag}{wu\_tag}}
{\footnotesize\ttfamily \label{structmpi__vars_1_1lock__type_ae13a02ff3985d06c3455b2ae29210cc4} 
integer mpi\+\_\+vars::\+lock\+\_\+type::\+wu\+\_\+tag}



wakeup tag 



Definition at line \doxymbox{\hyperlink{MPI__vars_8f90_source_l00066}{66}} of file \doxymbox{\hyperlink{MPI__vars_8f90_source}{MPI\+\_\+vars.\+f90}}.



