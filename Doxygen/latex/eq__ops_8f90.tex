\hypertarget{eq__ops_8f90}{}\section{/opt/\+P\+B3\+D/\+Modules/eq\+\_\+ops.f90 File Reference}
\label{eq__ops_8f90}\index{/opt/\+P\+B3\+D/\+Modules/eq\+\_\+ops.\+f90@{/opt/\+P\+B3\+D/\+Modules/eq\+\_\+ops.\+f90}}
\subsection*{Interfaces and Types}
\begin{DoxyCompactItemize}
\item 
interface \hyperlink{interfaceeq__ops_1_1calc__eq}{eq\+\_\+ops\+::calc\+\_\+eq}
\begin{DoxyCompactList}\small\item\em Calculate the equilibrium quantities on a grid determined by straight field lines. \end{DoxyCompactList}\item 
interface \hyperlink{interfaceeq__ops_1_1print__output__eq}{eq\+\_\+ops\+::print\+\_\+output\+\_\+eq}
\begin{DoxyCompactList}\small\item\em Print equilibrium quantities to an output file\+: \end{DoxyCompactList}\item 
interface \hyperlink{interfaceeq__ops_1_1redistribute__output__eq}{eq\+\_\+ops\+::redistribute\+\_\+output\+\_\+eq}
\begin{DoxyCompactList}\small\item\em Redistribute the equilibrium variables, but only the Flux variables are saved. \end{DoxyCompactList}\item 
interface \hyperlink{interfaceeq__ops_1_1calc__rzl}{eq\+\_\+ops\+::calc\+\_\+rzl}
\begin{DoxyCompactList}\small\item\em Calculate $R$, $Z$ \& $\lambda$ and derivatives in V\+M\+EC coordinates. \end{DoxyCompactList}\item 
interface \hyperlink{interfaceeq__ops_1_1calc__g__c}{eq\+\_\+ops\+::calc\+\_\+g\+\_\+c}
\begin{DoxyCompactList}\small\item\em Calculate the lower metric elements in the C(ylindrical) coordinate system. \end{DoxyCompactList}\item 
interface \hyperlink{interfaceeq__ops_1_1calc__g__v}{eq\+\_\+ops\+::calc\+\_\+g\+\_\+v}
\begin{DoxyCompactList}\small\item\em Calculate the lower metric coefficients in the equilibrium V(\+M\+E\+C) coordinate system. \end{DoxyCompactList}\item 
interface \hyperlink{interfaceeq__ops_1_1calc__g__h}{eq\+\_\+ops\+::calc\+\_\+g\+\_\+h}
\begin{DoxyCompactList}\small\item\em Calculate the lower metric coefficients in the equilibrium H(\+E\+L\+E\+N\+A) coordinate system. \end{DoxyCompactList}\item 
interface \hyperlink{interfaceeq__ops_1_1calc__g__f}{eq\+\_\+ops\+::calc\+\_\+g\+\_\+f}
\begin{DoxyCompactList}\small\item\em Calculate the metric coefficients in the F(lux) coordinate system. \end{DoxyCompactList}\item 
interface \hyperlink{interfaceeq__ops_1_1calc__jac__v}{eq\+\_\+ops\+::calc\+\_\+jac\+\_\+v}
\begin{DoxyCompactList}\small\item\em Calculate $\mathcal{J}_\text{V}$, the jacobian in V(\+M\+E\+C) coordinates. \end{DoxyCompactList}\item 
interface \hyperlink{interfaceeq__ops_1_1calc__jac__h}{eq\+\_\+ops\+::calc\+\_\+jac\+\_\+h}
\begin{DoxyCompactList}\small\item\em Calculate $\mathcal{J}_\text{H}$, the jacobian in H\+E\+L\+E\+NA coordinates. \end{DoxyCompactList}\item 
interface \hyperlink{interfaceeq__ops_1_1calc__jac__f}{eq\+\_\+ops\+::calc\+\_\+jac\+\_\+f}
\begin{DoxyCompactList}\small\item\em Calculate $\mathcal{J}_\text{F}$, the jacobian in Flux coordinates. \end{DoxyCompactList}\item 
interface \hyperlink{interfaceeq__ops_1_1calc__t__vc}{eq\+\_\+ops\+::calc\+\_\+t\+\_\+vc}
\begin{DoxyCompactList}\small\item\em Calculate $\overline{\text{T}}_\text{C}^\text{V}$, the transformation matrix between C(ylindrical) and V(mec) coordinate system. \end{DoxyCompactList}\item 
interface \hyperlink{interfaceeq__ops_1_1calc__t__vf}{eq\+\_\+ops\+::calc\+\_\+t\+\_\+vf}
\begin{DoxyCompactList}\small\item\em Calculate $\overline{\text{T}}_\text{V}^\text{F}$, the transformation matrix between V(\+M\+E\+C) and F(lux) coordinate systems. \end{DoxyCompactList}\item 
interface \hyperlink{interfaceeq__ops_1_1calc__t__hf}{eq\+\_\+ops\+::calc\+\_\+t\+\_\+hf}
\begin{DoxyCompactList}\small\item\em Calculate $\overline{\text{T}}_\text{H}^\text{F}$, the transformation matrix between H(\+E\+L\+E\+N\+A) and F(lux) coordinate systems. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Modules}
\begin{DoxyCompactItemize}
\item 
module \hyperlink{namespaceeq__ops}{eq\+\_\+ops}
\begin{DoxyCompactList}\small\item\em Operations on the equilibrium variables. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
integer function \hyperlink{namespaceeq__ops_a9addef683b3d4a8c587510e4c994ec61}{eq\+\_\+ops\+::create\+\_\+vmec\+\_\+input} (grid\+\_\+eq, eq\+\_\+1)
\begin{DoxyCompactList}\small\item\em Creates a V\+M\+EC input file. \end{DoxyCompactList}\item 
integer function, public \hyperlink{namespaceeq__ops_af0effe20188d46a44680c2648e4572e9}{eq\+\_\+ops\+::flux\+\_\+q\+\_\+plot} (grid\+\_\+eq, eq)
\begin{DoxyCompactList}\small\item\em Plots the flux quantities in the solution grid. \end{DoxyCompactList}\item 
integer function, public \hyperlink{namespaceeq__ops_a087e08ce6d8ad381b5bac8fc51148d50}{eq\+\_\+ops\+::calc\+\_\+derived\+\_\+q} (grid\+\_\+eq, eq\+\_\+1, eq\+\_\+2)
\begin{DoxyCompactList}\small\item\em Calculates derived equilibrium quantities system. \end{DoxyCompactList}\item 
subroutine \hyperlink{eq__ops_8f90_a369b73b541213d572d7197e0d549c014}{calc\+\_\+derived\+\_\+de\+\_\+epar\+\_\+hel} (grid\+\_\+eq, eq\+\_\+1, Rchi, Zchi, de, D\+\_\+de, b\+\_\+n, b\+\_\+g)
\item 
integer function, public \hyperlink{namespaceeq__ops_a7cd38586e386e1bc684a327ebcc4c1de}{eq\+\_\+ops\+::calc\+\_\+normalization\+\_\+const} ()
\begin{DoxyCompactList}\small\item\em Sets up normalization constants. \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespaceeq__ops_a1b4c764da73624722d7e76498a2b80a9}{eq\+\_\+ops\+::normalize\+\_\+input} ()
\begin{DoxyCompactList}\small\item\em Normalize input quantities. \end{DoxyCompactList}\item 
integer function, public \hyperlink{namespaceeq__ops_a73a8c3cea1e8a636b4978bc626e0fab0}{eq\+\_\+ops\+::b\+\_\+plot} (grid\+\_\+eq, eq\+\_\+1, eq\+\_\+2, rich\+\_\+lvl, plot\+\_\+fluxes, X\+YZ)
\begin{DoxyCompactList}\small\item\em Plots the magnetic fields. \end{DoxyCompactList}\item 
integer function, public \hyperlink{namespaceeq__ops_afabdf28e5c26ceb87e6eb8cf3809919d}{eq\+\_\+ops\+::j\+\_\+plot} (grid\+\_\+eq, eq\+\_\+1, eq\+\_\+2, rich\+\_\+lvl, plot\+\_\+fluxes, X\+YZ)
\begin{DoxyCompactList}\small\item\em Plots the current. \end{DoxyCompactList}\item 
integer function, public \hyperlink{namespaceeq__ops_ad173efd111cb85c11bc2bc78a7555096}{eq\+\_\+ops\+::kappa\+\_\+plot} (grid\+\_\+eq, eq\+\_\+1, eq\+\_\+2, rich\+\_\+lvl, X\+YZ)
\begin{DoxyCompactList}\small\item\em Plots the curvature. \end{DoxyCompactList}\item 
integer function, public \hyperlink{namespaceeq__ops_ac0a79893900631d25b170be0abd2c131}{eq\+\_\+ops\+::delta\+\_\+r\+\_\+plot} (grid\+\_\+eq, eq\+\_\+1, eq\+\_\+2, X\+YZ, rich\+\_\+lvl)
\begin{DoxyCompactList}\small\item\em Plots {\bfseries H\+A\+LF} of the change in the position vectors for 2 different toroidal positions, which can correspond to a ripple. \end{DoxyCompactList}\item 
integer function, public \hyperlink{namespaceeq__ops_a8fae749abe55865d8135fef536a8e8f1}{eq\+\_\+ops\+::divide\+\_\+eq\+\_\+jobs} (n\+\_\+par\+\_\+X, arr\+\_\+size, n\+\_\+div, n\+\_\+div\+\_\+max, n\+\_\+par\+\_\+\+X\+\_\+base, range\+\_\+name)
\begin{DoxyCompactList}\small\item\em Divides the equilibrium jobs. \end{DoxyCompactList}\item 
integer function, public \hyperlink{namespaceeq__ops_a4e20b8725fce149449f83754244dc84e}{eq\+\_\+ops\+::calc\+\_\+eq\+\_\+jobs\+\_\+lims} (n\+\_\+par\+\_\+X, n\+\_\+div)
\begin{DoxyCompactList}\small\item\em Calculate {\ttfamily eq\+\_\+jobs\+\_\+lims}. \end{DoxyCompactList}\item 
integer function \hyperlink{namespaceeq__ops_a1f5049c3e309fa23ee46fd116c9344f1}{eq\+\_\+ops\+::test\+\_\+t\+\_\+ef} (grid\+\_\+eq, eq\+\_\+1, eq\+\_\+2)
\begin{DoxyCompactList}\small\item\em See if {\ttfamily T\+\_\+\+EF} it complies with the theory of \cite{Weyens3D}. \end{DoxyCompactList}\item 
integer function \hyperlink{namespaceeq__ops_a003df1e1ab90dc6f586c3eed3dd067e8}{eq\+\_\+ops\+::test\+\_\+d12h\+\_\+h} (grid\+\_\+eq, eq)
\begin{DoxyCompactList}\small\item\em Tests whether $ \frac{\partial^2}{\partial u_i \partial u_j} h_\text{H} $ is calculated correctly. \end{DoxyCompactList}\item 
integer function \hyperlink{namespaceeq__ops_a05dcd4803b9c7845d3353614c9630c23}{eq\+\_\+ops\+::test\+\_\+jac\+\_\+f} (grid\+\_\+eq, eq\+\_\+1, eq\+\_\+2)
\begin{DoxyCompactList}\small\item\em Performs tests on $ \mathcal{J}_\text{F}$. \end{DoxyCompactList}\item 
integer function \hyperlink{namespaceeq__ops_a9811c83477d9d85f7401fd7957a590fc}{eq\+\_\+ops\+::test\+\_\+g\+\_\+v} (grid\+\_\+eq, eq)
\begin{DoxyCompactList}\small\item\em Tests whether $g_\text{V}$ is calculated correctly. \end{DoxyCompactList}\item 
integer function \hyperlink{namespaceeq__ops_aef40d04e93f6a96576f8fe893fb086f8}{eq\+\_\+ops\+::test\+\_\+jac\+\_\+v} (grid\+\_\+eq, eq)
\begin{DoxyCompactList}\small\item\em Tests whether $\mathcal{J}_\text{V}$ is calculated correctly. \end{DoxyCompactList}\item 
integer function \hyperlink{namespaceeq__ops_a8082c12510696bd8ffdd0deef41860c2}{eq\+\_\+ops\+::test\+\_\+b\+\_\+f} (grid\+\_\+eq, eq\+\_\+1, eq\+\_\+2)
\begin{DoxyCompactList}\small\item\em Tests whether $\vec{B}_\text{F}$ is calculated correctly. \end{DoxyCompactList}\item 
integer function \hyperlink{namespaceeq__ops_a38b723f6ed5d2e2772c9c3ad14d5ffd4}{eq\+\_\+ops\+::test\+\_\+p} (grid\+\_\+eq, eq\+\_\+1, eq\+\_\+2)
\begin{DoxyCompactList}\small\item\em Performs tests on pressure balance. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
logical, public \hyperlink{namespaceeq__ops_a1b6609a8d8b427d9133bf323e732f209}{eq\+\_\+ops\+::debug\+\_\+calc\+\_\+derived\+\_\+q} = .false.
\begin{DoxyCompactList}\small\item\em plot debug information for \hyperlink{namespaceeq__ops_a087e08ce6d8ad381b5bac8fc51148d50}{calc\+\_\+derived\+\_\+q()} \end{DoxyCompactList}\item 
logical, public \hyperlink{namespaceeq__ops_a45ba7f46fd439bbd73edfd1fd548b58e}{eq\+\_\+ops\+::debug\+\_\+j\+\_\+plot} = .false.
\begin{DoxyCompactList}\small\item\em plot debug information for \hyperlink{namespaceeq__ops_afabdf28e5c26ceb87e6eb8cf3809919d}{j\+\_\+plot()} \end{DoxyCompactList}\item 
logical, public \hyperlink{namespaceeq__ops_a07ca60790a262e20bc8632be1530970a}{eq\+\_\+ops\+::debug\+\_\+create\+\_\+vmec\+\_\+input} = .false.
\begin{DoxyCompactList}\small\item\em plot debug information for \hyperlink{namespaceeq__ops_a9addef683b3d4a8c587510e4c994ec61}{create\+\_\+vmec\+\_\+input()} \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{eq__ops_8f90_a369b73b541213d572d7197e0d549c014}\label{eq__ops_8f90_a369b73b541213d572d7197e0d549c014}} 
\index{eq\+\_\+ops.\+f90@{eq\+\_\+ops.\+f90}!calc\+\_\+derived\+\_\+de\+\_\+epar\+\_\+hel@{calc\+\_\+derived\+\_\+de\+\_\+epar\+\_\+hel}}
\index{calc\+\_\+derived\+\_\+de\+\_\+epar\+\_\+hel@{calc\+\_\+derived\+\_\+de\+\_\+epar\+\_\+hel}!eq\+\_\+ops.\+f90@{eq\+\_\+ops.\+f90}}
\subsubsection{\texorpdfstring{calc\+\_\+derived\+\_\+de\+\_\+epar\+\_\+hel()}{calc\_derived\_de\_epar\_hel()}}
{\footnotesize\ttfamily subroutine calc\+\_\+derived\+\_\+q\+::calc\+\_\+derived\+\_\+de\+\_\+epar\+\_\+hel (\begin{DoxyParamCaption}\item[{type(grid\+\_\+type), intent(in)}]{grid\+\_\+eq,  }\item[{type(\hyperlink{structeq__vars_1_1eq__1__type}{eq\+\_\+1\+\_\+type}), intent(in)}]{eq\+\_\+1,  }\item[{real(dp), dimension(\+:,\+:,0\+:), intent(in)}]{Rchi,  }\item[{real(dp), dimension(\+:,\+:,0\+:), intent(in)}]{Zchi,  }\item[{real(dp), dimension(\+:,\+:,\+:,\+:,\+:,\+:), intent(out)}]{de,  }\item[{real(dp), dimension(\+:,\+:,\+:,\+:,\+:), intent(out)}]{D\+\_\+de,  }\item[{real(dp), dimension(\+:,\+:,\+:,\+:), intent(out)}]{b\+\_\+n,  }\item[{real(dp), dimension(\+:,\+:,\+:,\+:), intent(out)}]{b\+\_\+g }\end{DoxyParamCaption})}


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em grid\+\_\+eq} & equilibrium grid\\
\hline
\mbox{\tt in}  & {\em eq\+\_\+1} & flux equilibrium variables\\
\hline
\mbox{\tt in}  & {\em rchi} & chi and chi$^\wedge$2 derivatives of R\\
\hline
\mbox{\tt in}  & {\em zchi} & chi and chi$^\wedge$2 derivatives of Z\\
\hline
\mbox{\tt out}  & {\em de} & derivs of cov. unit vector in E (space,deriv.,unitvec,output)\\
\hline
\mbox{\tt out}  & {\em d\+\_\+de} & derivs of transf. matrix in E (space,deriv.,output)\\
\hline
\mbox{\tt out}  & {\em b\+\_\+n} & covariant Cylindrical components of normal basis vector\\
\hline
\mbox{\tt out}  & {\em b\+\_\+g} & covariant Cylindrical components of geodesic basis vector \\
\hline
\end{DoxyParams}


Definition at line 4693 of file eq\+\_\+ops.\+f90.

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{eq__ops_8f90_a369b73b541213d572d7197e0d549c014_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{eq__ops_8f90_a369b73b541213d572d7197e0d549c014_icgraph}
\end{center}
\end{figure}
