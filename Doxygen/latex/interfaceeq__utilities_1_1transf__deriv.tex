\hypertarget{interfaceeq__utilities_1_1transf__deriv}{}\doxysection{eq\+\_\+utilities\+::transf\+\_\+deriv Interface Reference}
\label{interfaceeq__utilities_1_1transf__deriv}\index{eq\_utilities::transf\_deriv@{eq\_utilities::transf\_deriv}}


Calculates derivatives in a coordinate system B from derivatives in a coordinates system A, making use of the transformation matrix $\overline{\text{T}}_\text{B}^\text{A}$.  


\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
integer recursive function \mbox{\hyperlink{interfaceeq__utilities_1_1transf__deriv_aeb378175eaa132caf243cbd197e2d2ac}{transf\+\_\+deriv\+\_\+3\+\_\+ind}} (X\+\_\+A, T\+\_\+\+BA, X\+\_\+B, max\+\_\+deriv, deriv\+\_\+B, deriv\+\_\+\+A\+\_\+input)
\begin{DoxyCompactList}\small\item\em 3-\/D scalar version with one derivative \end{DoxyCompactList}\item 
integer function \mbox{\hyperlink{interfaceeq__utilities_1_1transf__deriv_abaad10d9fd6035720c2ef74be49e7493}{transf\+\_\+deriv\+\_\+3\+\_\+arr}} (X\+\_\+A, T\+\_\+\+BA, X\+\_\+B, max\+\_\+deriv, derivs)
\begin{DoxyCompactList}\small\item\em 3-\/D scalar version with multiple derivatives \end{DoxyCompactList}\item 
integer function \mbox{\hyperlink{interfaceeq__utilities_1_1transf__deriv_a91c9dd37a0de40fa72441e9c88f94eb0}{transf\+\_\+deriv\+\_\+3\+\_\+arr\+\_\+2d}} (X\+\_\+A, T\+\_\+\+BA, X\+\_\+B, max\+\_\+deriv, derivs)
\begin{DoxyCompactList}\small\item\em 3-\/D matrix version with multiple derivatives \end{DoxyCompactList}\item 
integer recursive function \mbox{\hyperlink{interfaceeq__utilities_1_1transf__deriv_ae0caaaa6fbd6d68f926921b7565ca727}{transf\+\_\+deriv\+\_\+1\+\_\+ind}} (X\+\_\+A, T\+\_\+\+BA, X\+\_\+B, max\+\_\+deriv, deriv\+\_\+B, deriv\+\_\+\+A\+\_\+input)
\begin{DoxyCompactList}\small\item\em 1-\/D scalar version with one derivative \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Calculates derivatives in a coordinate system B from derivatives in a coordinates system A, making use of the transformation matrix $\overline{\text{T}}_\text{B}^\text{A}$. 

The routine works by exchanging the derivatives in the coordinates B for derivatives in coordinates A using the formula \[\mathbf{D}_\text{B}^m X = \overline{\text{T}}_\text{B}^\text{A} \mathbf{D}^1_\text{A} \left(\mathbf{D}^{m-1}_\text{B} X\right) , \] where $\mathbf{D}^m$ is a tensor of rank $m$ that contains all the derivatives of total rank $m$. For example, \[\mathbf{D}^1 = \vec{D} = \left(\begin{array}{c}\frac{\partial}{\partial u^1} \\ \frac{\partial}{\partial u^2} \\ \frac{\partial}{\partial u^3} \end{array}\right) \]

This is done for the derivatives in each of the coordinates B until degree 0 is reached.

Furthermore, each of these degrees of derivatives in coordinates B can be be derived optionally in the original coordinate system A, which yields the formula\+: \[ \mathbf{D}^p_\text{A} \left(\mathbf{D}^m_\text{B} X \right) = \sum_q \left(\begin{array}{c}p\\q\end{array}\right) \mathbf{D}^q_\text{A} \left(\overline{\text{T}}_\text{B}^\text{A}\right) \left(\mathbf{D}^{p-q}_\text{A} \mathbf{D}^1_\text{A}\right) \left( \mathbf{D}^{m-1}_\text{B} X \right)\]

This way, ultimately the desired derivatives in the coordinates B can be obtained recursively from the lower orders in the coordinates B and higher orders in the coordinates A.

For example\+:
\begin{DoxyItemize}
\item For order $M$, the formula can be used with $p=0$.
\item For this, it is necessary that $\mathbf{D}^1_\text{A} \mathbf{D}^{m-1}_\text{B} X$ be precalculated, which can be done using the formula with $p=1$ and $m=M-1$.
\item For this, it is necessary that $\mathbf{D}^1_\text{A} \mathbf{D}^{M-1}_\text{B} X$ and $\mathbf{D}^2_\text{A} \mathbf{D}^{M-1}_\text{B} X$ are precalculated, which can be done with $p=1$ and $m=M-1$ as well as $p=2$ and $m=M-1$.
\item etc.
\end{DoxyItemize}

\begin{DoxySeeAlso}{See also}
\cite{Weyens3D} for more detailed information.
\end{DoxySeeAlso}
\begin{DoxyReturn}{Returns}
ierr 
\end{DoxyReturn}


Definition at line 118 of file eq\+\_\+utilities.\+f90.



\doxysubsection{Member Function/\+Subroutine Documentation}
\mbox{\Hypertarget{interfaceeq__utilities_1_1transf__deriv_ae0caaaa6fbd6d68f926921b7565ca727}\label{interfaceeq__utilities_1_1transf__deriv_ae0caaaa6fbd6d68f926921b7565ca727}} 
\index{eq\_utilities::transf\_deriv@{eq\_utilities::transf\_deriv}!transf\_deriv\_1\_ind@{transf\_deriv\_1\_ind}}
\index{transf\_deriv\_1\_ind@{transf\_deriv\_1\_ind}!eq\_utilities::transf\_deriv@{eq\_utilities::transf\_deriv}}
\doxysubsubsection{\texorpdfstring{transf\_deriv\_1\_ind()}{transf\_deriv\_1\_ind()}}
{\footnotesize\ttfamily integer recursive function eq\+\_\+utilities\+::transf\+\_\+deriv\+::transf\+\_\+deriv\+\_\+1\+\_\+ind (\begin{DoxyParamCaption}\item[{real(dp), dimension(1\+:,0\+:), intent(in)}]{X\+\_\+A,  }\item[{real(dp), dimension(1\+:,0\+:), intent(in)}]{T\+\_\+\+BA,  }\item[{real(dp), dimension(1\+:), intent(inout)}]{X\+\_\+B,  }\item[{integer, intent(in)}]{max\+\_\+deriv,  }\item[{integer, intent(in)}]{deriv\+\_\+B,  }\item[{integer, intent(in), optional}]{deriv\+\_\+\+A\+\_\+input }\end{DoxyParamCaption})}



1-\/D scalar version with one derivative 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em x\+\_\+a} & variable and derivs. in coord. system A \\
\hline
\mbox{\texttt{ in,out}}  & {\em x\+\_\+b} & requested derivs. of variable in coord. system B \\
\hline
\mbox{\texttt{ in}}  & {\em t\+\_\+ba} & transf. mat. and derivs. between coord. systems A and B \\
\hline
\mbox{\texttt{ in}}  & {\em deriv\+\_\+a\+\_\+input} & derivs. in coord. system A (optional) \\
\hline
\mbox{\texttt{ in}}  & {\em deriv\+\_\+b} & derivs. in coord. system B \\
\hline
\mbox{\texttt{ in}}  & {\em max\+\_\+deriv} & maximum degrees of derivs. \\
\hline
\end{DoxyParams}


Definition at line 692 of file eq\+\_\+utilities.\+f90.

\mbox{\Hypertarget{interfaceeq__utilities_1_1transf__deriv_abaad10d9fd6035720c2ef74be49e7493}\label{interfaceeq__utilities_1_1transf__deriv_abaad10d9fd6035720c2ef74be49e7493}} 
\index{eq\_utilities::transf\_deriv@{eq\_utilities::transf\_deriv}!transf\_deriv\_3\_arr@{transf\_deriv\_3\_arr}}
\index{transf\_deriv\_3\_arr@{transf\_deriv\_3\_arr}!eq\_utilities::transf\_deriv@{eq\_utilities::transf\_deriv}}
\doxysubsubsection{\texorpdfstring{transf\_deriv\_3\_arr()}{transf\_deriv\_3\_arr()}}
{\footnotesize\ttfamily integer function eq\+\_\+utilities\+::transf\+\_\+deriv\+::transf\+\_\+deriv\+\_\+3\+\_\+arr (\begin{DoxyParamCaption}\item[{real(dp), dimension(1\+:,1\+:,1\+:,0\+:,0\+:,0\+:), intent(in)}]{X\+\_\+A,  }\item[{real(dp), dimension(1\+:,1\+:,1\+:,1\+:,0\+:,0\+:,0\+:), intent(in)}]{T\+\_\+\+BA,  }\item[{real(dp), dimension(1\+:,1\+:,1\+:,0\+:,0\+:,0\+:), intent(inout)}]{X\+\_\+B,  }\item[{integer, intent(in)}]{max\+\_\+deriv,  }\item[{integer, dimension(\+:,\+:), intent(in)}]{derivs }\end{DoxyParamCaption})}



3-\/D scalar version with multiple derivatives 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em x\+\_\+a} & variable and derivs. in coord. system A \\
\hline
\mbox{\texttt{ in}}  & {\em t\+\_\+ba} & transf. mat. and derivs. between coord. systems A and B \\
\hline
\mbox{\texttt{ in,out}}  & {\em x\+\_\+b} & requested derivs. of variable in coord. system B \\
\hline
\mbox{\texttt{ in}}  & {\em max\+\_\+deriv} & maximum degrees of derivs. \\
\hline
\mbox{\texttt{ in}}  & {\em derivs} & series of derivs. (in coordinate system B) \\
\hline
\end{DoxyParams}


Definition at line 626 of file eq\+\_\+utilities.\+f90.

\mbox{\Hypertarget{interfaceeq__utilities_1_1transf__deriv_a91c9dd37a0de40fa72441e9c88f94eb0}\label{interfaceeq__utilities_1_1transf__deriv_a91c9dd37a0de40fa72441e9c88f94eb0}} 
\index{eq\_utilities::transf\_deriv@{eq\_utilities::transf\_deriv}!transf\_deriv\_3\_arr\_2d@{transf\_deriv\_3\_arr\_2d}}
\index{transf\_deriv\_3\_arr\_2d@{transf\_deriv\_3\_arr\_2d}!eq\_utilities::transf\_deriv@{eq\_utilities::transf\_deriv}}
\doxysubsubsection{\texorpdfstring{transf\_deriv\_3\_arr\_2d()}{transf\_deriv\_3\_arr\_2d()}}
{\footnotesize\ttfamily integer function eq\+\_\+utilities\+::transf\+\_\+deriv\+::transf\+\_\+deriv\+\_\+3\+\_\+arr\+\_\+2d (\begin{DoxyParamCaption}\item[{real(dp), dimension(1\+:,1\+:,1\+:,1\+:,0\+:,0\+:,0\+:), intent(in)}]{X\+\_\+A,  }\item[{real(dp), dimension(1\+:,1\+:,1\+:,1\+:,0\+:,0\+:,0\+:), intent(in)}]{T\+\_\+\+BA,  }\item[{real(dp), dimension(1\+:,1\+:,1\+:,1\+:,0\+:,0\+:,0\+:), intent(inout)}]{X\+\_\+B,  }\item[{integer, intent(in)}]{max\+\_\+deriv,  }\item[{integer, dimension(\+:,\+:), intent(in)}]{derivs }\end{DoxyParamCaption})}



3-\/D matrix version with multiple derivatives 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em x\+\_\+a} & variable and derivs. in coord. system A \\
\hline
\mbox{\texttt{ in}}  & {\em t\+\_\+ba} & transf. mat. and derivs. between coord. systems A and B \\
\hline
\mbox{\texttt{ in,out}}  & {\em x\+\_\+b} & requested derivs. of variable in coord. system B \\
\hline
\mbox{\texttt{ in}}  & {\em max\+\_\+deriv} & maximum degrees of derivs. \\
\hline
\mbox{\texttt{ in}}  & {\em derivs} & series of derivs. (in coordinate system B) \\
\hline
\end{DoxyParams}


Definition at line 651 of file eq\+\_\+utilities.\+f90.

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{interfaceeq__utilities_1_1transf__deriv_a91c9dd37a0de40fa72441e9c88f94eb0_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{interfaceeq__utilities_1_1transf__deriv_aeb378175eaa132caf243cbd197e2d2ac}\label{interfaceeq__utilities_1_1transf__deriv_aeb378175eaa132caf243cbd197e2d2ac}} 
\index{eq\_utilities::transf\_deriv@{eq\_utilities::transf\_deriv}!transf\_deriv\_3\_ind@{transf\_deriv\_3\_ind}}
\index{transf\_deriv\_3\_ind@{transf\_deriv\_3\_ind}!eq\_utilities::transf\_deriv@{eq\_utilities::transf\_deriv}}
\doxysubsubsection{\texorpdfstring{transf\_deriv\_3\_ind()}{transf\_deriv\_3\_ind()}}
{\footnotesize\ttfamily integer recursive function eq\+\_\+utilities\+::transf\+\_\+deriv\+::transf\+\_\+deriv\+\_\+3\+\_\+ind (\begin{DoxyParamCaption}\item[{real(dp), dimension(1\+:,1\+:,1\+:,0\+:,0\+:,0\+:), intent(in)}]{X\+\_\+A,  }\item[{real(dp), dimension(1\+:,1\+:,1\+:,1\+:,0\+:,0\+:,0\+:), intent(in)}]{T\+\_\+\+BA,  }\item[{real(dp), dimension(1\+:,1\+:,1\+:), intent(inout)}]{X\+\_\+B,  }\item[{integer, intent(in)}]{max\+\_\+deriv,  }\item[{integer, dimension(\+:), intent(in)}]{deriv\+\_\+B,  }\item[{integer, dimension(\+:), intent(in), optional}]{deriv\+\_\+\+A\+\_\+input }\end{DoxyParamCaption})}



3-\/D scalar version with one derivative 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em x\+\_\+a} & variable and derivs. in coord. system A \\
\hline
\mbox{\texttt{ in}}  & {\em t\+\_\+ba} & transf. mat. and derivs. between coord. systems A and B \\
\hline
\mbox{\texttt{ in,out}}  & {\em x\+\_\+b} & requested derivs. of variable in coord. system B \\
\hline
\mbox{\texttt{ in}}  & {\em max\+\_\+deriv} & maximum degrees of derivs. \\
\hline
\mbox{\texttt{ in}}  & {\em deriv\+\_\+b} & derivs. in coord. system B \\
\hline
\mbox{\texttt{ in}}  & {\em deriv\+\_\+a\+\_\+input} & derivs. in coord. system A (optional) \\
\hline
\end{DoxyParams}


Definition at line 519 of file eq\+\_\+utilities.\+f90.

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{interfaceeq__utilities_1_1transf__deriv_aeb378175eaa132caf243cbd197e2d2ac_cgraph}
\end{center}
\end{figure}


